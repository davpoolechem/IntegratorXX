
/* THIS FILE IS AUTOGENERATED BY generate_quadrature_tests.py.
   DO NOT EDIT THIS FILE, EDIT THE AUTOGENERATOR INSTEAD.
*/

// clang-format off
#include "catch2/catch_all.hpp"
#include <integratorxx/quadratures/gausslobatto.hpp>
#include <numeric>
#include <vector>
// clang-format on

const double x_tolerance = 10 * std::numeric_limits<double>::epsilon();
const double w_tolerance = 10 * std::numeric_limits<double>::epsilon();

TEST_CASE("2 point GaussLobatto", "[1d-quad]") {
  std::array<double, 2> ref_pts = {-1, 1};
  std::array<double, 2> ref_wgt = {1.0000000000000000000,
                                   1.0000000000000000000};
  IntegratorXX::GaussLobatto<double, double> quad(2);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 2; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("3 point GaussLobatto", "[1d-quad]") {
  std::array<double, 3> ref_pts = {-1, 0, 1};
  std::array<double, 3> ref_wgt = {
      0.33333333333333333333, 1.3333333333333333333, 0.33333333333333333333};
  IntegratorXX::GaussLobatto<double, double> quad(3);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 3; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("4 point GaussLobatto", "[1d-quad]") {
  std::array<double, 4> ref_pts = {-1, -0.44721359549995793928,
                                   0.44721359549995793928, 1};
  std::array<double, 4> ref_wgt = {
      0.16666666666666666667, 0.83333333333333333333, 0.83333333333333333333,
      0.16666666666666666667};
  IntegratorXX::GaussLobatto<double, double> quad(4);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 4; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("5 point GaussLobatto", "[1d-quad]") {
  std::array<double, 5> ref_pts = {-1, -0.65465367070797714380, 0,
                                   0.65465367070797714380, 1};
  std::array<double, 5> ref_wgt = {
      0.10000000000000000000, 0.54444444444444444444, 0.71111111111111111111,
      0.54444444444444444444, 0.10000000000000000000};
  IntegratorXX::GaussLobatto<double, double> quad(5);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 5; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("6 point GaussLobatto", "[1d-quad]") {
  std::array<double, 6> ref_pts = {-1,
                                   -0.76505532392946469285,
                                   -0.28523151648064509631,
                                   0.28523151648064509631,
                                   0.76505532392946469285,
                                   1};
  std::array<double, 6> ref_wgt = {
      0.066666666666666666667, 0.37847495629784698032, 0.55485837703548635302,
      0.55485837703548635302,  0.37847495629784698032, 0.066666666666666666667};
  IntegratorXX::GaussLobatto<double, double> quad(6);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 6; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("7 point GaussLobatto", "[1d-quad]") {
  std::array<double, 7> ref_pts = {
      -1, -0.83022389627856692987, -0.46884879347071421380,
      0,  0.46884879347071421380,  0.83022389627856692987,
      1};
  std::array<double, 7> ref_wgt = {
      0.047619047619047619048, 0.27682604736156594801, 0.43174538120986262342,
      0.48761904761904761905,  0.43174538120986262342, 0.27682604736156594801,
      0.047619047619047619048};
  IntegratorXX::GaussLobatto<double, double> quad(7);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 7; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("8 point GaussLobatto", "[1d-quad]") {
  std::array<double, 8> ref_pts = {-1,
                                   -0.87174014850960661534,
                                   -0.59170018143314230214,
                                   -0.20929921790247886877,
                                   0.20929921790247886877,
                                   0.59170018143314230214,
                                   0.87174014850960661534,
                                   1};
  std::array<double, 8> ref_wgt = {
      0.035714285714285714286, 0.21070422714350603938, 0.34112269248350436476,
      0.41245879465870388157,  0.41245879465870388157, 0.34112269248350436476,
      0.21070422714350603938,  0.035714285714285714286};
  IntegratorXX::GaussLobatto<double, double> quad(8);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 8; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("9 point GaussLobatto", "[1d-quad]") {
  std::array<double, 9> ref_pts = {-1,
                                   -0.89975799541146015731,
                                   -0.67718627951073775345,
                                   -0.36311746382617815871,
                                   0,
                                   0.36311746382617815871,
                                   0.67718627951073775345,
                                   0.89975799541146015731,
                                   1};
  std::array<double, 9> ref_wgt = {
      0.027777777777777777778, 0.16549536156080552505, 0.27453871250016173528,
      0.34642851097304634512,  0.37151927437641723356, 0.34642851097304634512,
      0.27453871250016173528,  0.16549536156080552505, 0.027777777777777777778};
  IntegratorXX::GaussLobatto<double, double> quad(9);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 9; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("10 point GaussLobatto", "[1d-quad]") {
  std::array<double, 10> ref_pts = {-1,
                                    -0.91953390816645881383,
                                    -0.73877386510550507500,
                                    -0.47792494981044449566,
                                    -0.16527895766638702463,
                                    0.16527895766638702463,
                                    0.47792494981044449566,
                                    0.73877386510550507500,
                                    0.91953390816645881383,
                                    1};
  std::array<double, 10> ref_wgt = {
      0.022222222222222222222, 0.13330599085107011113, 0.22488934206312645212,
      0.29204268367968375788,  0.32753976118389745666, 0.32753976118389745666,
      0.29204268367968375788,  0.22488934206312645212, 0.13330599085107011113,
      0.022222222222222222222};
  IntegratorXX::GaussLobatto<double, double> quad(10);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 10; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("11 point GaussLobatto", "[1d-quad]") {
  std::array<double, 11> ref_pts = {-1,
                                    -0.93400143040805913433,
                                    -0.78448347366314441862,
                                    -0.56523532699620500647,
                                    -0.29575813558693939143,
                                    0,
                                    0.29575813558693939143,
                                    0.56523532699620500647,
                                    0.78448347366314441862,
                                    0.93400143040805913433,
                                    1};
  std::array<double, 11> ref_wgt = {
      0.018181818181818181818, 0.10961227326699486446, 0.18716988178030520411,
      0.24804810426402831404,  0.28687912477900808868, 0.30021759545569069379,
      0.28687912477900808868,  0.24804810426402831404, 0.18716988178030520411,
      0.10961227326699486446,  0.018181818181818181818};
  IntegratorXX::GaussLobatto<double, double> quad(11);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 11; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("12 point GaussLobatto", "[1d-quad]") {
  std::array<double, 12> ref_pts = {-1,
                                    -0.94489927222288222341,
                                    -0.81927932164400667835,
                                    -0.63287615303186067766,
                                    -0.39953094096534893226,
                                    -0.13655293285492755486,
                                    0.13655293285492755486,
                                    0.39953094096534893226,
                                    0.63287615303186067766,
                                    0.81927932164400667835,
                                    0.94489927222288222341,
                                    1};
  std::array<double, 12> ref_wgt = {
      0.015151515151515151515, 0.091684517413196130668,
      0.15797470556437011516,  0.21250841776102114536,
      0.25127560319920128029,  0.27140524091069617700,
      0.27140524091069617700,  0.25127560319920128029,
      0.21250841776102114536,  0.15797470556437011516,
      0.091684517413196130668, 0.015151515151515151515};
  IntegratorXX::GaussLobatto<double, double> quad(12);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 12; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("13 point GaussLobatto", "[1d-quad]") {
  std::array<double, 13> ref_pts = {-1,
                                    -0.95330984664216391190,
                                    -0.84634756465187231687,
                                    -0.68618846908175742607,
                                    -0.48290982109133620175,
                                    -0.24928693010623999257,
                                    0,
                                    0.24928693010623999257,
                                    0.48290982109133620175,
                                    0.68618846908175742607,
                                    0.84634756465187231687,
                                    0.95330984664216391190,
                                    1};
  std::array<double, 13> ref_wgt = {
      0.012820512820512820513, 0.077801686746818927794, 0.13498192668960834912,
      0.18364686520355009201,  0.22076779356611008609,  0.24401579030667635646,
      0.25193084933344673604,  0.24401579030667635646,  0.22076779356611008609,
      0.18364686520355009201,  0.13498192668960834912,  0.077801686746818927794,
      0.012820512820512820513};
  IntegratorXX::GaussLobatto<double, double> quad(13);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 13; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("14 point GaussLobatto", "[1d-quad]") {
  std::array<double, 14> ref_pts = {-1,
                                    -0.95993504526726090136,
                                    -0.86780105383034725100,
                                    -0.72886859909132614058,
                                    -0.55063940292864705532,
                                    -0.34272401334271284504,
                                    -0.11633186888370386766,
                                    0.11633186888370386766,
                                    0.34272401334271284504,
                                    0.55063940292864705532,
                                    0.72886859909132614058,
                                    0.86780105383034725100,
                                    0.95993504526726090136,
                                    1};
  std::array<double, 14> ref_wgt = {
      0.010989010989010989011, 0.066837284497681284634, 0.11658665589871165154,
      0.16002185176295214241,  0.19482614937341611864,  0.21912625300977075487,
      0.23161279446845705889,  0.23161279446845705889,  0.21912625300977075487,
      0.19482614937341611864,  0.16002185176295214241,  0.11658665589871165154,
      0.066837284497681284634, 0.010989010989010989011};
  IntegratorXX::GaussLobatto<double, double> quad(14);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 14; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("15 point GaussLobatto", "[1d-quad]") {
  std::array<double, 15> ref_pts = {-1,
                                    -0.96524592650383857280,
                                    -0.88508204422297629883,
                                    -0.76351968995181520070,
                                    -0.60625320546984571112,
                                    -0.42063805471367248092,
                                    -0.21535395536379423823,
                                    0,
                                    0.21535395536379423823,
                                    0.42063805471367248092,
                                    0.60625320546984571112,
                                    0.76351968995181520070,
                                    0.88508204422297629883,
                                    0.96524592650383857280,
                                    1};
  std::array<double, 15> ref_wgt = {
      0.0095238095238095238095, 0.058029893028601249097,
      0.10166007032571806760,   0.14051169980242810946,
      0.17278964725360094905,   0.19698723596461335609,
      0.21197358592682092013,   0.21704811634881564951,
      0.21197358592682092013,   0.19698723596461335609,
      0.17278964725360094905,   0.14051169980242810946,
      0.10166007032571806760,   0.058029893028601249097,
      0.0095238095238095238095};
  IntegratorXX::GaussLobatto<double, double> quad(15);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 15; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("16 point GaussLobatto", "[1d-quad]") {
  std::array<double, 16> ref_pts = {-1,
                                    -0.96956804627021793295,
                                    -0.89920053309347209299,
                                    -0.79200829186181506393,
                                    -0.65238870288249308947,
                                    -0.48605942188713761178,
                                    -0.29983046890076320810,
                                    -0.10132627352194944784,
                                    0.10132627352194944784,
                                    0.29983046890076320810,
                                    0.48605942188713761178,
                                    0.65238870288249308947,
                                    0.79200829186181506393,
                                    0.89920053309347209299,
                                    0.96956804627021793295,
                                    1};
  std::array<double, 16> ref_wgt = {
      0.0083333333333333333333, 0.050850361005919905403,
      0.089393697325930800991,  0.12425538213251409835,
      0.15402698080716428082,   0.17749191339170412530,
      0.19369002382520358432,   0.20195830817822987149,
      0.20195830817822987149,   0.19369002382520358432,
      0.17749191339170412530,   0.15402698080716428082,
      0.12425538213251409835,   0.089393697325930800991,
      0.050850361005919905403,  0.0083333333333333333333};
  IntegratorXX::GaussLobatto<double, double> quad(16);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 16; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("17 point GaussLobatto", "[1d-quad]") {
  std::array<double, 17> ref_pts = {-1,
                                    -0.97313217663141831416,
                                    -0.91087999591557359562,
                                    -0.81569625122177030711,
                                    -0.69102898062768470539,
                                    -0.54138539933010153912,
                                    -0.37217443356547704191,
                                    -0.18951197351831738830,
                                    0,
                                    0.18951197351831738830,
                                    0.37217443356547704191,
                                    0.54138539933010153912,
                                    0.69102898062768470539,
                                    0.81569625122177030711,
                                    0.91087999591557359562,
                                    0.97313217663141831416,
                                    1};
  std::array<double, 17> ref_wgt = {
      0.0073529411764705882353, 0.044921940543254209647,
      0.079198270503687119190,  0.11059290900702816138,
      0.13798774620192655906,   0.16039466199762153952,
      0.17700425351565787044,   0.18721633967761923589,
      0.19066187475346943330,   0.18721633967761923589,
      0.17700425351565787044,   0.16039466199762153952,
      0.13798774620192655906,   0.11059290900702816138,
      0.079198270503687119190,  0.044921940543254209647,
      0.0073529411764705882353};
  IntegratorXX::GaussLobatto<double, double> quad(17);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 17; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("18 point GaussLobatto", "[1d-quad]") {
  std::array<double, 18> ref_pts = {-1,
                                    -0.97610555741219854286,
                                    -0.92064918534753387384,
                                    -0.83559353521809021371,
                                    -0.72367932928324268131,
                                    -0.58850483431866176117,
                                    -0.43441503691212397534,
                                    -0.26636265287828098417,
                                    -0.089749093484652111023,
                                    0.089749093484652111023,
                                    0.26636265287828098417,
                                    0.43441503691212397534,
                                    0.58850483431866176117,
                                    0.72367932928324268131,
                                    0.83559353521809021371,
                                    0.92064918534753387384,
                                    0.97610555741219854286,
                                    1};
  std::array<double, 18> ref_wgt = {
      0.0065359477124183006536, 0.039970628810914066138,
      0.070637166885633664999,  0.099016271717502802394,
      0.12421053313296710026,   0.14541196157380226798,
      0.16193951723760248926,   0.17326210948945622601,
      0.17901586343970308229,   0.17901586343970308229,
      0.17326210948945622601,   0.16193951723760248926,
      0.14541196157380226798,   0.12421053313296710026,
      0.099016271717502802394,  0.070637166885633664999,
      0.039970628810914066138,  0.0065359477124183006536};
  IntegratorXX::GaussLobatto<double, double> quad(18);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 18; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("19 point GaussLobatto", "[1d-quad]") {
  std::array<double, 19> ref_pts = {-1,
                                    -0.97861176622208009515,
                                    -0.92890152815258624372,
                                    -0.85246057779664609309,
                                    -0.75149420255261301416,
                                    -0.62890813726522049777,
                                    -0.48822928568071350278,
                                    -0.33350484782449861030,
                                    -0.16918602340928157138,
                                    0,
                                    0.16918602340928157138,
                                    0.33350484782449861030,
                                    0.48822928568071350278,
                                    0.62890813726522049777,
                                    0.75149420255261301416,
                                    0.85246057779664609309,
                                    0.92890152815258624372,
                                    0.97861176622208009515,
                                    1};
  std::array<double, 19> ref_wgt = {
      0.0058479532163742690058, 0.035793365186176477115,
      0.063381891762629736852,  0.089131757099207084448,
      0.11231534147730504407,   0.13226728044875077693,
      0.14841394259593888501,   0.16029092404406124198,
      0.16755658452714286727,   0.17000191928482723464,
      0.16755658452714286727,   0.16029092404406124198,
      0.14841394259593888501,   0.13226728044875077693,
      0.11231534147730504407,   0.089131757099207084448,
      0.063381891762629736852,  0.035793365186176477115,
      0.0058479532163742690058};
  IntegratorXX::GaussLobatto<double, double> quad(19);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 19; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("20 point GaussLobatto", "[1d-quad]") {
  std::array<double, 20> ref_pts = {-1,
                                    -0.98074370489391417193,
                                    -0.93593449881266543572,
                                    -0.86687797808995014131,
                                    -0.77536826095205587041,
                                    -0.66377640229031128985,
                                    -0.53499286403188626165,
                                    -0.39235318371390929939,
                                    -0.23955170592298649518,
                                    -0.080545937238821837976,
                                    0.080545937238821837976,
                                    0.23955170592298649518,
                                    0.39235318371390929939,
                                    0.53499286403188626165,
                                    0.66377640229031128985,
                                    0.77536826095205587041,
                                    0.86687797808995014131,
                                    0.93593449881266543572,
                                    0.98074370489391417193,
                                    1};
  std::array<double, 20> ref_wgt = {
      0.0052631578947368421053, 0.032237123188488941492,
      0.057181802127566826005,  0.080631763996119603145,
      0.10199149969945081568,   0.12070922762867472510,
      0.13630048235872418449,   0.14836155407091682581,
      0.15658010264747548716,   0.16074328638784574901,
      0.16074328638784574901,   0.15658010264747548716,
      0.14836155407091682581,   0.13630048235872418449,
      0.12070922762867472510,   0.10199149969945081568,
      0.080631763996119603145,  0.057181802127566826005,
      0.032237123188488941492,  0.0052631578947368421053};
  IntegratorXX::GaussLobatto<double, double> quad(20);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 20; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("21 point GaussLobatto", "[1d-quad]") {
  std::array<double, 21> ref_pts = {-1,
                                    -0.98257229660454802823,
                                    -0.94197629695974553430,
                                    -0.87929475532359046445,
                                    -0.79600192607771240474,
                                    -0.69405102606222323263,
                                    -0.57583196026183068693,
                                    -0.44411578327900210119,
                                    -0.30198985650876488728,
                                    -0.15278551580218546601,
                                    0,
                                    0.15278551580218546601,
                                    0.30198985650876488728,
                                    0.44411578327900210119,
                                    0.57583196026183068693,
                                    0.69405102606222323263,
                                    0.79600192607771240474,
                                    0.87929475532359046445,
                                    0.94197629695974553430,
                                    0.98257229660454802823,
                                    1};
  std::array<double, 21> ref_wgt = {
      0.0047619047619047619048, 0.029184840098505458609,
      0.051843169000849625073,  0.073273918185074144253,
      0.092985467957886065301,  0.11051708321912333527,
      0.12545812119086894802,   0.13745846286004134358,
      0.14623686244797745927,   0.15158757511168138445,
      0.15338519033217494855,   0.15158757511168138445,
      0.14623686244797745927,   0.13745846286004134358,
      0.12545812119086894802,   0.11051708321912333527,
      0.092985467957886065301,  0.073273918185074144253,
      0.051843169000849625073,  0.029184840098505458609,
      0.0047619047619047619048};
  IntegratorXX::GaussLobatto<double, double> quad(21);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 21; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("22 point GaussLobatto", "[1d-quad]") {
  std::array<double, 22> ref_pts = {-1,
                                    -0.98415243845764617655,
                                    -0.94720428399922868052,
                                    -0.89006229019090447053,
                                    -0.81394892761192113605,
                                    -0.72048723996120215812,
                                    -0.61166943828425897123,
                                    -0.48981487518990234981,
                                    -0.35752071013891953806,
                                    -0.21760658515928504179,
                                    -0.073054540010898334761,
                                    0.073054540010898334761,
                                    0.21760658515928504179,
                                    0.35752071013891953806,
                                    0.48981487518990234981,
                                    0.61166943828425897123,
                                    0.72048723996120215812,
                                    0.81394892761192113605,
                                    0.89006229019090447053,
                                    0.94720428399922868052,
                                    0.98415243845764617655,
                                    1};
  std::array<double, 22> ref_wgt = {
      0.0043290043290043290043, 0.026545747682501757912,
      0.047214465293740752124,  0.066865605864553076012,
      0.085090060391838447816,  0.10150057480164767437,
      0.11574764465393906659,   0.12752769665343027553,
      0.13658968861374142669,   0.14274049227136140034,
      0.14584901944424179362,   0.14584901944424179362,
      0.14274049227136140034,   0.13658968861374142669,
      0.12752769665343027553,   0.11574764465393906659,
      0.10150057480164767437,   0.085090060391838447816,
      0.066865605864553076012,  0.047214465293740752124,
      0.026545747682501757912,  0.0043290043290043290043};
  IntegratorXX::GaussLobatto<double, double> quad(22);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 22; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("23 point GaussLobatto", "[1d-quad]") {
  std::array<double, 23> ref_pts = {-1,
                                    -0.98552715587873257808,
                                    -0.95175795571071020414,
                                    -0.89945855804034501095,
                                    -0.82965109665128588622,
                                    -0.74369504117206068394,
                                    -0.64326364446013620848,
                                    -0.53031177113684416813,
                                    -0.40703793791447482920,
                                    -0.27584154894579306711,
                                    -0.13927620404066839859,
                                    0,
                                    0.13927620404066839859,
                                    0.27584154894579306711,
                                    0.40703793791447482920,
                                    0.53031177113684416813,
                                    0.64326364446013620848,
                                    0.74369504117206068394,
                                    0.82965109665128588622,
                                    0.89945855804034501095,
                                    0.95175795571071020414,
                                    0.98552715587873257808,
                                    1};
  std::array<double, 23> ref_wgt = {
      0.0039525691699604743083, 0.024248600771531736517,
      0.043175871170241834749,  0.061252477129554206381,
      0.078135449475569989742,  0.093497246163512341833,
      0.10703910172433651154,   0.11849751066274913130,
      0.12764947470175887664,   0.13431687263860381990,
      0.13836993638580739452,   0.13972978001274736514,
      0.13836993638580739452,   0.13431687263860381990,
      0.12764947470175887664,   0.11849751066274913130,
      0.10703910172433651154,   0.093497246163512341833,
      0.078135449475569989742,  0.061252477129554206381,
      0.043175871170241834749,  0.024248600771531736517,
      0.0039525691699604743083};
  IntegratorXX::GaussLobatto<double, double> quad(23);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 23; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("24 point GaussLobatto", "[1d-quad]") {
  std::array<double, 24> ref_pts = {-1,
                                    -0.98673055350516088355,
                                    -0.95574822092988635803,
                                    -0.90770567511350652199,
                                    -0.84346407015487204062,
                                    -0.76417048242049330779,
                                    -0.67124010526412869984,
                                    -0.56633135797929531219,
                                    -0.45131637321432261825,
                                    -0.32824761337551091203,
                                    -0.19932125339083266724,
                                    -0.066837993737228578114,
                                    0.066837993737228578114,
                                    0.19932125339083266724,
                                    0.32824761337551091203,
                                    0.45131637321432261825,
                                    0.56633135797929531219,
                                    0.67124010526412869984,
                                    0.76417048242049330779,
                                    0.84346407015487204062,
                                    0.90770567511350652199,
                                    0.95574822092988635803,
                                    0.98673055350516088355,
                                    1};
  std::array<double, 24> ref_wgt = {
      0.0036231884057971014493, 0.022236853464711208993,
      0.039631681333467809469,  0.056309848724646199021,
      0.071981862055293982216,  0.086369029967929068217,
      0.099214827684083587414,  0.11029008689296860411,
      0.11939719370249131903,   0.12637364202802080013,
      0.13109494187360394235,   0.13347684386698637760,
      0.13347684386698637760,   0.13109494187360394235,
      0.12637364202802080013,   0.11939719370249131903,
      0.11029008689296860411,   0.099214827684083587414,
      0.086369029967929068217,  0.071981862055293982216,
      0.056309848724646199021,  0.039631681333467809469,
      0.022236853464711208993,  0.0036231884057971014493};
  IntegratorXX::GaussLobatto<double, double> quad(24);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 24; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("25 point GaussLobatto", "[1d-quad]") {
  std::array<double, 25> ref_pts = {-1,
                                    -0.98778994493149370927,
                                    -0.95926413825253447886,
                                    -0.91498277073462257832,
                                    -0.85567646583531657752,
                                    -0.78231965924071678040,
                                    -0.69611704881513436676,
                                    -0.59848414727999326810,
                                    -0.49102411481887838262,
                                    -0.37550145785922723323,
                                    -0.25381306416887658018,
                                    -0.12795705948310697271,
                                    0,
                                    0.12795705948310697271,
                                    0.25381306416887658018,
                                    0.37550145785922723323,
                                    0.49102411481887838262,
                                    0.59848414727999326810,
                                    0.69611704881513436676,
                                    0.78231965924071678040,
                                    0.85567646583531657752,
                                    0.91498277073462257832,
                                    0.95926413825253447886,
                                    0.98778994493149370927,
                                    1};
  std::array<double, 25> ref_wgt = {
      0.0033333333333333333333, 0.020465168932974385309,
      0.036504738794271372032,  0.051936228368491474643,
      0.066513728675312784694,  0.079998774836292981802,
      0.092170139910620421913,  0.10282803034795783083,
      0.11179746626832088816,   0.11893117940681182541,
      0.12411203893795029070,   0.12725497753833144702,
      0.12830838929866192834,   0.12725497753833144702,
      0.12411203893795029070,   0.11893117940681182541,
      0.11179746626832088816,   0.10282803034795783083,
      0.092170139910620421913,  0.079998774836292981802,
      0.066513728675312784694,  0.051936228368491474643,
      0.036504738794271372032,  0.020465168932974385309,
      0.0033333333333333333333};
  IntegratorXX::GaussLobatto<double, double> quad(25);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 25; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("26 point GaussLobatto", "[1d-quad]") {
  std::array<double, 26> ref_pts = {-1,
                                    -0.98872741231147565443,
                                    -0.96237787476771732975,
                                    -0.92143554681755734112,
                                    -0.86652432395912357097,
                                    -0.79847718310743743904,
                                    -0.71832581636266508053,
                                    -0.62728529949231688780,
                                    -0.52673574202987854530,
                                    -0.41820138706624678556,
                                    -0.30332751285925272077,
                                    -0.18385549527005490132,
                                    -0.061596411781919728206,
                                    0.061596411781919728206,
                                    0.18385549527005490132,
                                    0.30332751285925272077,
                                    0.41820138706624678556,
                                    0.52673574202987854530,
                                    0.62728529949231688780,
                                    0.71832581636266508053,
                                    0.79847718310743743904,
                                    0.86652432395912357097,
                                    0.92143554681755734112,
                                    0.96237787476771732975,
                                    0.98872741231147565443,
                                    1};
  std::array<double, 26> ref_wgt = {
      0.0030769230769230769231, 0.018896858024263465581,
      0.033732303685955999378,  0.048048399081180627316,
      0.061635025142547402782,  0.074287050122291137316,
      0.085812863980004362187,  0.096037802353901310804,
      0.10480688623073705299,   0.11198719411986033530,
      0.11746988409380900708,   0.12117184628844334604,
      0.12303696380008287630,   0.12303696380008287630,
      0.12117184628844334604,   0.11746988409380900708,
      0.11198719411986033530,   0.10480688623073705299,
      0.096037802353901310804,  0.085812863980004362187,
      0.074287050122291137316,  0.061635025142547402782,
      0.048048399081180627316,  0.033732303685955999378,
      0.018896858024263465581,  0.0030769230769230769231};
  IntegratorXX::GaussLobatto<double, double> quad(26);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 26; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("27 point GaussLobatto", "[1d-quad]") {
  std::array<double, 27> ref_pts = {-1,
                                    -0.98956096372855062115,
                                    -0.96514840245081891926,
                                    -0.92718345872511577886,
                                    -0.87620208621452247867,
                                    -0.81292048689581228826,
                                    -0.73822714984645991084,
                                    -0.65317066369680951518,
                                    -0.55894506094256118006,
                                    -0.45687307561408240368,
                                    -0.34838758198902867044,
                                    -0.23501148310291813334,
                                    -0.11833633389852104844,
                                    0,
                                    0.11833633389852104844,
                                    0.23501148310291813334,
                                    0.34838758198902867044,
                                    0.45687307561408240368,
                                    0.55894506094256118006,
                                    0.65317066369680951518,
                                    0.73822714984645991084,
                                    0.81292048689581228826,
                                    0.87620208621452247867,
                                    0.92718345872511577886,
                                    0.96514840245081891926,
                                    0.98956096372855062115,
                                    1};
  std::array<double, 27> ref_wgt = {
      0.0028490028490028490028, 0.017501974876065579019,
      0.031262951735202384325,  0.044577657933061698744,
      0.057265569680162731739,  0.069149342360043276281,
      0.080062321970538458168,  0.089851365259290559972,
      0.098379074585952763179,  0.10552574782125301122,
      0.11119106525743703293,   0.11529550025465198281,
      0.11778143658595615907,   0.11861397766276302709,
      0.11778143658595615907,   0.11529550025465198281,
      0.11119106525743703293,   0.10552574782125301122,
      0.098379074585952763179,  0.089851365259290559972,
      0.080062321970538458168,  0.069149342360043276281,
      0.057265569680162731739,  0.044577657933061698744,
      0.031262951735202384325,  0.017501974876065579019,
      0.0028490028490028490028};
  IntegratorXX::GaussLobatto<double, double> quad(27);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 27; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("28 point GaussLobatto", "[1d-quad]") {
  std::array<double, 28> ref_pts = {-1,
                                    -0.99030540261845412552,
                                    -0.96762428585713130434,
                                    -0.93232516712155852493,
                                    -0.88487101721130283841,
                                    -0.82588097005633819604,
                                    -0.75612419400556976515,
                                    -0.67651012892957331772,
                                    -0.58807668983717560648,
                                    -0.49197675393157938043,
                                    -0.38946313757636280794,
                                    -0.28187226662160237195,
                                    -0.17060675530800436088,
                                    -0.057117121693512897627,
                                    0.057117121693512897627,
                                    0.17060675530800436088,
                                    0.28187226662160237195,
                                    0.38946313757636280794,
                                    0.49197675393157938043,
                                    0.58807668983717560648,
                                    0.67651012892957331772,
                                    0.75612419400556976515,
                                    0.82588097005633819604,
                                    0.88487101721130283841,
                                    0.93232516712155852493,
                                    0.96762428585713130434,
                                    0.99030540261845412552,
                                    1};
  std::array<double, 28> ref_wgt = {
      0.0026455026455026455026, 0.016255883957504218199,
      0.029054220677979144707,  0.041466915243006721038,
      0.053338077047327488400,  0.064513658080354538390,
      0.074848123509707702781,  0.084206795121510325739,
      0.092467685997712175722,  0.099523110412495672876,
      0.10528109376105589448,   0.10966657379597662509,
      0.11262238007723901254,   0.11410997967262783453,
      0.11410997967262783453,   0.11262238007723901254,
      0.10966657379597662509,   0.10528109376105589448,
      0.099523110412495672876,  0.092467685997712175722,
      0.084206795121510325739,  0.074848123509707702781,
      0.064513658080354538390,  0.053338077047327488400,
      0.041466915243006721038,  0.029054220677979144707,
      0.016255883957504218199,  0.0026455026455026455026};
  IntegratorXX::GaussLobatto<double, double> quad(28);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 28; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("29 point GaussLobatto", "[1d-quad]") {
  std::array<double, 29> ref_pts = {-1,
                                    -0.99097298826856981628,
                                    -0.96984580728793629371,
                                    -0.93694271852098251154,
                                    -0.89266571997608827876,
                                    -0.83755273628178656524,
                                    -0.77227289720646874135,
                                    -0.69761866135636798839,
                                    -0.61449625220343294997,
                                    -0.52391467437196908358,
                                    -0.42697347171349438764,
                                    -0.32484938284191100626,
                                    -0.21878205828426101981,
                                    -0.11005901339559210971,
                                    0,
                                    0.11005901339559210971,
                                    0.21878205828426101981,
                                    0.32484938284191100626,
                                    0.42697347171349438764,
                                    0.52391467437196908358,
                                    0.61449625220343294997,
                                    0.69761866135636798839,
                                    0.77227289720646874135,
                                    0.83755273628178656524,
                                    0.89266571997608827876,
                                    0.93694271852098251154,
                                    0.96984580728793629371,
                                    0.99097298826856981628,
                                    1};
  std::array<double, 29> ref_wgt = {
      0.0024630541871921182266, 0.015138169859967596791,
      0.027070806296824827541,  0.038668439979712979748,
      0.049795809093237560923,  0.060318503828522735028,
      0.070108938000597999185,  0.079048313027885601784,
      0.087028133441135605638,  0.093951542114796312498,
      0.099734501637149860654,  0.10430681646367653742,
      0.10761298583356853937,   0.10961287784589042013,
      0.11028221677968261011,   0.10961287784589042013,
      0.10761298583356853937,   0.10430681646367653742,
      0.099734501637149860654,  0.093951542114796312498,
      0.087028133441135605638,  0.079048313027885601784,
      0.070108938000597999185,  0.060318503828522735028,
      0.049795809093237560923,  0.038668439979712979748,
      0.027070806296824827541,  0.015138169859967596791,
      0.0024630541871921182266};
  IntegratorXX::GaussLobatto<double, double> quad(29);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 29; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("30 point GaussLobatto", "[1d-quad]") {
  std::array<double, 30> ref_pts = {-1,
                                    -0.99157394284050029334,
                                    -0.97184660316626924168,
                                    -0.94110478095105708231,
                                    -0.89969921819927685955,
                                    -0.84809948718019810955,
                                    -0.78689035723754708045,
                                    -0.71676539863708513163,
                                    -0.63851917580755840737,
                                    -0.55303826009505285238,
                                    -0.46129119016824068523,
                                    -0.36431750042244899776,
                                    -0.26321594371957379127,
                                    -0.15913204262585046782,
                                    -0.053245110485486669363,
                                    0.053245110485486669363,
                                    0.15913204262585046782,
                                    0.26321594371957379127,
                                    0.36431750042244899776,
                                    0.46129119016824068523,
                                    0.55303826009505285238,
                                    0.63851917580755840737,
                                    0.71676539863708513163,
                                    0.78689035723754708045,
                                    0.84809948718019810955,
                                    0.89969921819927685955,
                                    0.94110478095105708231,
                                    0.97184660316626924168,
                                    0.99157394284050029334,
                                    1};
  std::array<double, 30> ref_wgt = {
      0.0022988505747126436782, 0.014131799327905387641,
      0.025283166740551402204,  0.036142094199408535315,
      0.046590694533142927402,  0.056511197923080383302,
      0.065791336397790054944,  0.074326003324718253834,
      0.082018512833406914800,  0.088781712319765210167,
      0.094538975193860891781,  0.099225071004299830658,
      0.10278690530723498947,   0.10518412159645464986,
      0.10638955872366792495,   0.10638955872366792495,
      0.10518412159645464986,   0.10278690530723498947,
      0.099225071004299830658,  0.094538975193860891781,
      0.088781712319765210167,  0.082018512833406914800,
      0.074326003324718253834,  0.065791336397790054944,
      0.056511197923080383302,  0.046590694533142927402,
      0.036142094199408535315,  0.025283166740551402204,
      0.014131799327905387641,  0.0022988505747126436782};
  IntegratorXX::GaussLobatto<double, double> quad(30);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 30; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("31 point GaussLobatto", "[1d-quad]") {
  std::array<double, 31> ref_pts = {-1,
                                    -0.99211684434648108859,
                                    -0.97365493581573647483,
                                    -0.94486917020803922981,
                                    -0.90606695144126981314,
                                    -0.85765999529745561037,
                                    -0.80016154319246298927,
                                    -0.73418113630907524213,
                                    -0.66041820261152552334,
                                    -0.57965465720800191300,
                                    -0.49274661909883240570,
                                    -0.40061533828056180630,
                                    -0.30423743127287262096,
                                    -0.20463452924752450114,
                                    -0.10286244876068227709,
                                    0,
                                    0.10286244876068227709,
                                    0.20463452924752450114,
                                    0.30423743127287262096,
                                    0.40061533828056180630,
                                    0.49274661909883240570,
                                    0.57965465720800191300,
                                    0.66041820261152552334,
                                    0.73418113630907524213,
                                    0.80016154319246298927,
                                    0.85765999529745561037,
                                    0.90606695144126981314,
                                    0.94486917020803922981,
                                    0.97365493581573647483,
                                    0.99211684434648108859,
                                    1};
  std::array<double, 31> ref_wgt = {
      0.0021505376344086021505, 0.013222471025464670303,
      0.023666433230270316730,  0.033853940405224057630,
      0.043681818160066912830,  0.053046465493448782774,
      0.061848741290454623391,  0.069995377594100570450,
      0.077400032341475618634,  0.083984220517529730665,
      0.089678151045260822248,  0.094421468377857957432,
      0.098163893013712757120,  0.10086575479865051340,
      0.10249841359547039768,   0.10304456295320733314,
      0.10249841359547039768,   0.10086575479865051340,
      0.098163893013712757120,  0.094421468377857957432,
      0.089678151045260822248,  0.083984220517529730665,
      0.077400032341475618634,  0.069995377594100570450,
      0.061848741290454623391,  0.053046465493448782774,
      0.043681818160066912830,  0.033853940405224057630,
      0.023666433230270316730,  0.013222471025464670303,
      0.0021505376344086021505};
  IntegratorXX::GaussLobatto<double, double> quad(31);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 31; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("32 point GaussLobatto", "[1d-quad]") {
  std::array<double, 32> ref_pts = {-1,
                                    -0.99260893397276135937,
                                    -0.97529469048270922806,
                                    -0.94828483841723237808,
                                    -0.91184993906373190407,
                                    -0.86635247601267551983,
                                    -0.81224473177744234455,
                                    -0.75006449393667479772,
                                    -0.68042975561555081594,
                                    -0.60403258714842112614,
                                    -0.52163226288156529061,
                                    -0.43404771720184693960,
                                    -0.34214940653888148625,
                                    -0.24685065885020530442,
                                    -0.14909859681364749491,
                                    -0.049864725046593252306,
                                    0.049864725046593252306,
                                    0.14909859681364749491,
                                    0.24685065885020530442,
                                    0.34214940653888148625,
                                    0.43404771720184693960,
                                    0.52163226288156529061,
                                    0.60403258714842112614,
                                    0.68042975561555081594,
                                    0.75006449393667479772,
                                    0.81224473177744234455,
                                    0.86635247601267551983,
                                    0.91184993906373190407,
                                    0.94828483841723237808,
                                    0.97529469048270922806,
                                    0.99260893397276135937,
                                    1};
  std::array<double, 32> ref_wgt = {
      0.0020161290322580645161, 0.012398106501373843789,
      0.022199552889291964624,  0.031775135410915465782,
      0.041034201586062723330,  0.049885271336221207012,
      0.058240497248055869551,  0.066016877257154543932,
      0.073137139602679032640,  0.079530525692106252292,
      0.085133497949668230528,  0.089890372957357833072,
      0.093753875546813813566,  0.096685608948002600560,
      0.098656436540761777171,  0.099646771501276777635,
      0.099646771501276777635,  0.098656436540761777171,
      0.096685608948002600560,  0.093753875546813813566,
      0.089890372957357833072,  0.085133497949668230528,
      0.079530525692106252292,  0.073137139602679032640,
      0.066016877257154543932,  0.058240497248055869551,
      0.049885271336221207012,  0.041034201586062723330,
      0.031775135410915465782,  0.022199552889291964624,
      0.012398106501373843789,  0.0020161290322580645161};
  IntegratorXX::GaussLobatto<double, double> quad(32);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 32; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("33 point GaussLobatto", "[1d-quad]") {
  std::array<double, 33> ref_pts = {-1,
                                    -0.99305635843365834367,
                                    -0.97678616331690630149,
                                    -0.95139345139699574338,
                                    -0.91711730345094124083,
                                    -0.87427810075056222065,
                                    -0.82327592300406746956,
                                    -0.76458700179352862801,
                                    -0.69875931661816259570,
                                    -0.62640749128126825726,
                                    -0.54820705991911162311,
                                    -0.46488816163210675597,
                                    -0.37722872425339363504,
                                    -0.28604720148767404161,
                                    -0.19219493146747722574,
                                    -0.096548188176107006317,
                                    0,
                                    0.096548188176107006317,
                                    0.19219493146747722574,
                                    0.28604720148767404161,
                                    0.37722872425339363504,
                                    0.46488816163210675597,
                                    0.54820705991911162311,
                                    0.62640749128126825726,
                                    0.69875931661816259570,
                                    0.76458700179352862801,
                                    0.82327592300406746956,
                                    0.87427810075056222065,
                                    0.91711730345094124083,
                                    0.95139345139699574338,
                                    0.97678616331690630149,
                                    0.99305635843365834367,
                                    1};
  std::array<double, 33> ref_wgt = {
      0.0018939393939393939394, 0.011648448392267734651,
      0.020864609017603360096,  0.029881045916746477520,
      0.038617814771813967564,  0.046993850461024170548,
      0.054931059442626967952,  0.062355367852465305441,
      0.069197469494016147560,  0.075393486923973828507,
      0.080885572193455092180,  0.085622448531813132550,
      0.089559889747077400661,  0.092661133442241463530,
      0.094897224394591815824,  0.096247284972985461997,
      0.096698710102716558960,  0.096247284972985461997,
      0.094897224394591815824,  0.092661133442241463530,
      0.089559889747077400661,  0.085622448531813132550,
      0.080885572193455092180,  0.075393486923973828507,
      0.069197469494016147560,  0.062355367852465305441,
      0.054931059442626967952,  0.046993850461024170548,
      0.038617814771813967564,  0.029881045916746477520,
      0.020864609017603360096,  0.011648448392267734651,
      0.0018939393939393939394};
  IntegratorXX::GaussLobatto<double, double> quad(33);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 33; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("34 point GaussLobatto", "[1d-quad]") {
  std::array<double, 34> ref_pts = {-1,
                                    -0.99346436258751620225,
                                    -0.97814668887993794895,
                                    -0.95423064891280752841,
                                    -0.92192829567744892274,
                                    -0.88152383651227326440,
                                    -0.83337244280314261491,
                                    -0.77789730643186741088,
                                    -0.71558596072021900600,
                                    -0.64698600793601462438,
                                    -0.57270031127492284479,
                                    -0.49338169867327095744,
                                    -0.40972722655959274486,
                                    -0.32247205451148899358,
                                    -0.23238298486911684306,
                                    -0.14025172417619385837,
                                    -0.046887925712970680087,
                                    0.046887925712970680087,
                                    0.14025172417619385837,
                                    0.23238298486911684306,
                                    0.32247205451148899358,
                                    0.40972722655959274486,
                                    0.49338169867327095744,
                                    0.57270031127492284479,
                                    0.64698600793601462438,
                                    0.71558596072021900600,
                                    0.77789730643186741088,
                                    0.83337244280314261491,
                                    0.88152383651227326440,
                                    0.92192829567744892274,
                                    0.95423064891280752841,
                                    0.97814668887993794895,
                                    0.99346436258751620225,
                                    1};
  std::array<double, 34> ref_wgt = {
      0.0017825311942959001783, 0.010964740818306551401,
      0.019646278160713431288,  0.028150536862243503401,
      0.036406770950782552351,  0.044342902060244342300,
      0.051889291830927120776,  0.058979654026745226695,
      0.065551690108265120430,  0.071547649877072822036,
      0.076914843063590982105,  0.081606103850422383162,
      0.085580205971977586590,  0.088802225283584032118,
      0.091243846806914487022,  0.092883613629610646144,
      0.093707115504303312002,  0.093707115504303312002,
      0.092883613629610646144,  0.091243846806914487022,
      0.088802225283584032118,  0.085580205971977586590,
      0.081606103850422383162,  0.076914843063590982105,
      0.071547649877072822036,  0.065551690108265120430,
      0.058979654026745226695,  0.051889291830927120776,
      0.044342902060244342300,  0.036406770950782552351,
      0.028150536862243503401,  0.019646278160713431288,
      0.010964740818306551401,  0.0017825311942959001783};
  IntegratorXX::GaussLobatto<double, double> quad(34);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 34; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("35 point GaussLobatto", "[1d-quad]") {
  std::array<double, 35> ref_pts = {-1,
                                    -0.99383744364438655029,
                                    -0.97939114342992062319,
                                    -0.95682705843698788244,
                                    -0.92633393201608193813,
                                    -0.88816475371795045509,
                                    -0.84263589538219978246,
                                    -0.79012465708479561954,
                                    -0.73106617837876523895,
                                    -0.66594984386577595734,
                                    -0.59531523208008327405,
                                    -0.51974764606220166355,
                                    -0.43987326413171700276,
                                    -0.35635395156545407572,
                                    -0.26988177638172079189,
                                    -0.18117327476560166645,
                                    -0.090963513696700411149,
                                    0,
                                    0.090963513696700411149,
                                    0.18117327476560166645,
                                    0.26988177638172079189,
                                    0.35635395156545407572,
                                    0.43987326413171700276,
                                    0.51974764606220166355,
                                    0.59531523208008327405,
                                    0.66594984386577595734,
                                    0.73106617837876523895,
                                    0.79012465708479561954,
                                    0.84263589538219978246,
                                    0.88816475371795045509,
                                    0.92633393201608193813,
                                    0.95682705843698788244,
                                    0.97939114342992062319,
                                    0.99383744364438655029,
                                    1};
  std::array<double, 35> ref_wgt = {
      0.0016806722689075630252, 0.010339473314540376211,
      0.018531393476282057482,  0.026565395330778215948,
      0.034378667890410702170,  0.041906918204587880736,
      0.049087863437218273244,  0.055862029889036716723,
      0.062173295815379782245,  0.067969368873298345403,
      0.073202223274018847533,  0.077828499133511153104,
      0.081809862335847833270,  0.085113322437326040267,
      0.087711506159071955511,  0.089582884273716908712,
      0.090711950036822492939,  0.091089347698489710951,
      0.090711950036822492939,  0.089582884273716908712,
      0.087711506159071955511,  0.085113322437326040267,
      0.081809862335847833270,  0.077828499133511153104,
      0.073202223274018847533,  0.067969368873298345403,
      0.062173295815379782245,  0.055862029889036716723,
      0.049087863437218273244,  0.041906918204587880736,
      0.034378667890410702170,  0.026565395330778215948,
      0.018531393476282057482,  0.010339473314540376211,
      0.0016806722689075630252};
  IntegratorXX::GaussLobatto<double, double> quad(35);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 35; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("36 point GaussLobatto", "[1d-quad]") {
  std::array<double, 36> ref_pts = {-1,
                                    -0.99417947547312392793,
                                    -0.98053235128252972803,
                                    -0.95920911586873528612,
                                    -0.93037832398293916080,
                                    -0.89426591198561635937,
                                    -0.85115459340254209236,
                                    -0.80138180446457147322,
                                    -0.74533709877172902380,
                                    -0.68345910915004599975,
                                    -0.61623211860391232049,
                                    -0.54418227174041531275,
                                    -0.46787345770807005502,
                                    -0.38790289736603624295,
                                    -0.30489646941705438884,
                                    -0.21950381216926856124,
                                    -0.13239323930266103126,
                                    -0.044246509451450338452,
                                    0.044246509451450338452,
                                    0.13239323930266103126,
                                    0.21950381216926856124,
                                    0.30489646941705438884,
                                    0.38790289736603624295,
                                    0.46787345770807005502,
                                    0.54418227174041531275,
                                    0.61623211860391232049,
                                    0.68345910915004599975,
                                    0.74533709877172902380,
                                    0.80138180446457147322,
                                    0.85115459340254209236,
                                    0.89426591198561635937,
                                    0.93037832398293916080,
                                    0.95920911586873528612,
                                    0.98053235128252972803,
                                    0.99417947547312392793,
                                    1};
  std::array<double, 36> ref_wgt = {
      0.0015873015873015873016, 0.0097661742710234637214,
      0.017508591322167709601,  0.025109861490694849104,
      0.032514046428104876119,  0.039663623505124960590,
      0.046502730682987540520,  0.052977870870747266275,
      0.059038377820917483041,  0.064636824372075271686,
      0.069729397256839424743,  0.074276241315475396764,
      0.078241771954180374388,  0.081594953883979392564,
      0.084309544130491856057,  0.086364297480506395719,
      0.087743132786509785840,  0.088435258840872365966,
      0.088435258840872365966,  0.087743132786509785840,
      0.086364297480506395719,  0.084309544130491856057,
      0.081594953883979392564,  0.078241771954180374388,
      0.074276241315475396764,  0.069729397256839424743,
      0.064636824372075271686,  0.059038377820917483041,
      0.052977870870747266275,  0.046502730682987540520,
      0.039663623505124960590,  0.032514046428104876119,
      0.025109861490694849104,  0.017508591322167709601,
      0.0097661742710234637214, 0.0015873015873015873016};
  IntegratorXX::GaussLobatto<double, double> quad(36);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 36; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("37 point GaussLobatto", "[1d-quad]") {
  std::array<double, 37> ref_pts = {-1,
                                    -0.99449380945326184798,
                                    -0.98158141498697708405,
                                    -0.96139973400684808611,
                                    -0.93409976546970499413,
                                    -0.89988390897660705063,
                                    -0.85900556704651452450,
                                    -0.81176741858365508366,
                                    -0.75851921157356837559,
                                    -0.69965518373232943215,
                                    -0.63561114734643404797,
                                    -0.56686126417869967694,
                                    -0.49391453563342083271,
                                    -0.41731103463383077135,
                                    -0.33761790729576471809,
                                    -0.25542517408079675214,
                                    -0.17134136155372539840,
                                    -0.085988997104455259539,
                                    0,
                                    0.085988997104455259539,
                                    0.17134136155372539840,
                                    0.25542517408079675214,
                                    0.33761790729576471809,
                                    0.41731103463383077135,
                                    0.49391453563342083271,
                                    0.56686126417869967694,
                                    0.63561114734643404797,
                                    0.69965518373232943215,
                                    0.75851921157356837559,
                                    0.81176741858365508366,
                                    0.85900556704651452450,
                                    0.89988390897660705063,
                                    0.93409976546970499413,
                                    0.96139973400684808611,
                                    0.98158141498697708405,
                                    0.99449380945326184798,
                                    1};
  std::array<double, 37> ref_wgt = {
      0.0015015015015015015015, 0.0092392432428419296555,
      0.016568023462080861143,  0.023770244581551458694,
      0.030795943408698084411,  0.037593506203916828020,
      0.044112694216875663982,  0.050305268315041556950,
      0.056125390773875629887,  0.061529975716485608634,
      0.066479011534697336399,  0.070935858364453643757,
      0.074867519862718237396,  0.078244887728851382164,
      0.081042957322503717113,  0.083241012845791743941,
      0.084822780746207937208,  0.085776550217099386400,
      0.086095259909614985486,  0.085776550217099386400,
      0.084822780746207937208,  0.083241012845791743941,
      0.081042957322503717113,  0.078244887728851382164,
      0.074867519862718237396,  0.070935858364453643757,
      0.066479011534697336399,  0.061529975716485608634,
      0.056125390773875629887,  0.050305268315041556950,
      0.044112694216875663982,  0.037593506203916828020,
      0.030795943408698084411,  0.023770244581551458694,
      0.016568023462080861143,  0.0092392432428419296555,
      0.0015015015015015015015};
  IntegratorXX::GaussLobatto<double, double> quad(37);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 37; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("38 point GaussLobatto", "[1d-quad]") {
  std::array<double, 38> ref_pts = {-1,
                                    -0.99478335679545231333,
                                    -0.98254798519853055990,
                                    -0.96341885014356087908,
                                    -0.93753162613981966767,
                                    -0.90506815879723055436,
                                    -0.86625623202567185762,
                                    -0.82136811196148726172,
                                    -0.77071866905969283272,
                                    -0.71466317903038071954,
                                    -0.65359483427890921692,
                                    -0.58794198737053419961,
                                    -0.51816514710053655774,
                                    -0.44475374868284343330,
                                    -0.36822272088804714266,
                                    -0.28910887428658497090,
                                    -0.20796713596695979982,
                                    -0.12536665715776862378,
                                    -0.041886821065351953400,
                                    0.041886821065351953400,
                                    0.12536665715776862378,
                                    0.20796713596695979982,
                                    0.28910887428658497090,
                                    0.36822272088804714266,
                                    0.44475374868284343330,
                                    0.51816514710053655774,
                                    0.58794198737053419961,
                                    0.65359483427890921692,
                                    0.71466317903038071954,
                                    0.77071866905969283272,
                                    0.82136811196148726172,
                                    0.86625623202567185762,
                                    0.90506815879723055436,
                                    0.93753162613981966767,
                                    0.96341885014356087908,
                                    0.98254798519853055990,
                                    0.99478335679545231333,
                                    1};
  std::array<double, 38> ref_wgt = {
      0.0014224751066856330014, 0.0087538139943602258516,
      0.015701121356300385369,  0.022534606874418874729,
      0.029209520950421723821,  0.035679424686142199384,
      0.041899019716493155527,  0.047824705288195613034,
      0.053414926372061171192,  0.058630475628248269850,
      0.063434771663867566047,  0.067794116802442773102,
      0.071677933929969965508,  0.075058981187236438837,
      0.077913543156257632011,  0.080221597260513986033,
      0.081966954237835647749,  0.083137371712546614227,
      0.083724640076002124726,  0.083724640076002124726,
      0.083137371712546614227,  0.081966954237835647749,
      0.080221597260513986033,  0.077913543156257632011,
      0.075058981187236438837,  0.071677933929969965508,
      0.067794116802442773102,  0.063434771663867566047,
      0.058630475628248269850,  0.053414926372061171192,
      0.047824705288195613034,  0.041899019716493155527,
      0.035679424686142199384,  0.029209520950421723821,
      0.022534606874418874729,  0.015701121356300385369,
      0.0087538139943602258516, 0.0014224751066856330014};
  IntegratorXX::GaussLobatto<double, double> quad(38);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 38; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("39 point GaussLobatto", "[1d-quad]") {
  std::array<double, 39> ref_pts = {-1,
                                    -0.99505065612147837692,
                                    -0.98344048250285422306,
                                    -0.96528387707647646366,
                                    -0.94070308939531743429,
                                    -0.90986195218028517282,
                                    -0.87296578017958785151,
                                    -0.83026013820709260714,
                                    -0.78202923714946893003,
                                    -0.72859405162312974297,
                                    -0.67031018720635343690,
                                    -0.60756551529529640518,
                                    -0.54077759250507819793,
                                    -0.47039088220905566990,
                                    -0.39687379687342754737,
                                    -0.32071558094263835559,
                                    -0.24242305505356218485,
                                    -0.16251724326222406303,
                                    -0.081529905737327456129,
                                    0,
                                    0.081529905737327456129,
                                    0.16251724326222406303,
                                    0.24242305505356218485,
                                    0.32071558094263835559,
                                    0.39687379687342754737,
                                    0.47039088220905566990,
                                    0.54077759250507819793,
                                    0.60756551529529640518,
                                    0.67031018720635343690,
                                    0.72859405162312974297,
                                    0.78202923714946893003,
                                    0.83026013820709260714,
                                    0.87296578017958785151,
                                    0.90986195218028517282,
                                    0.94070308939531743429,
                                    0.96528387707647646366,
                                    0.98344048250285422306,
                                    0.99505065612147837692,
                                    1};
  std::array<double, 39> ref_wgt = {
      0.0013495276653171390013, 0.0083056420077882968507,
      0.014900402058706222952,  0.021392502271216358625,
      0.027741757700206936732,  0.033906276321207934698,
      0.039845113337566719410,  0.045518770698763460405,
      0.050889500060123478751,  0.055921563937307437062,
      0.060581476611788699819,  0.064838228089039192114,
      0.068663490921010460283,  0.072031808925239211721,
      0.074920766690497159268,  0.077311138798527091999,
      0.079187017793501901285,  0.080535920058912584107,
      0.081348868902776145915,  0.081620454301007138007,
      0.081348868902776145915,  0.080535920058912584107,
      0.079187017793501901285,  0.077311138798527091999,
      0.074920766690497159268,  0.072031808925239211721,
      0.068663490921010460283,  0.064838228089039192114,
      0.060581476611788699819,  0.055921563937307437062,
      0.050889500060123478751,  0.045518770698763460405,
      0.039845113337566719410,  0.033906276321207934698,
      0.027741757700206936732,  0.021392502271216358625,
      0.014900402058706222952,  0.0083056420077882968507,
      0.0013495276653171390013};
  IntegratorXX::GaussLobatto<double, double> quad(39);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 39; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("40 point GaussLobatto", "[1d-quad]") {
  std::array<double, 40> ref_pts = {-1,
                                    -0.99529792924434889690,
                                    -0.98426628071750335473,
                                    -0.96701007648798852065,
                                    -0.94363976494360164257,
                                    -0.91430333969020945107,
                                    -0.87918634347933983789,
                                    -0.83851082277810644074,
                                    -0.79253395260155188681,
                                    -0.74154641914738441749,
                                    -0.68587058508431371383,
                                    -0.62585845275525751340,
                                    -0.56188943929472264877,
                                    -0.49436797812525360665,
                                    -0.42372096215555098475,
                                    -0.35039504491418087798,
                                    -0.27485381671432436652,
                                    -0.19757487371891077184,
                                    -0.11904679844497109352,
                                    -0.039766070802181900147,
                                    0.039766070802181900147,
                                    0.11904679844497109352,
                                    0.19757487371891077184,
                                    0.27485381671432436652,
                                    0.35039504491418087798,
                                    0.42372096215555098475,
                                    0.49436797812525360665,
                                    0.56188943929472264877,
                                    0.62585845275525751340,
                                    0.68587058508431371383,
                                    0.74154641914738441749,
                                    0.79253395260155188681,
                                    0.83851082277810644074,
                                    0.87918634347933983789,
                                    0.91430333969020945107,
                                    0.94363976494360164257,
                                    0.96701007648798852065,
                                    0.98426628071750335473,
                                    0.99529792924434889690,
                                    1};
  std::array<double, 40> ref_wgt = {
      0.0012820512820512820513, 0.0078910115886006137613,
      0.014159307549919773151,  0.020334759063387161851,
      0.026381190653141486263,  0.032260717927117395493,
      0.037936243700708446993,  0.043371908194757981009,
      0.048533353845914325139,  0.053387951971494182955,
      0.057905011981786083403,  0.062055976475709524970,
      0.065814602222895902663,  0.069157126276081134456,
      0.072062416302054295221,  0.074512104235389338579,
      0.076490702433396506255,  0.077985701608680580727,
      0.078987649925364344189,  0.079490212761549640871,
      0.079490212761549640871,  0.078987649925364344189,
      0.077985701608680580727,  0.076490702433396506255,
      0.074512104235389338579,  0.072062416302054295221,
      0.069157126276081134456,  0.065814602222895902663,
      0.062055976475709524970,  0.057905011981786083403,
      0.053387951971494182955,  0.048533353845914325139,
      0.043371908194757981009,  0.037936243700708446993,
      0.032260717927117395493,  0.026381190653141486263,
      0.020334759063387161851,  0.014159307549919773151,
      0.0078910115886006137613, 0.0012820512820512820513};
  IntegratorXX::GaussLobatto<double, double> quad(40);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 40; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("41 point GaussLobatto", "[1d-quad]") {
  std::array<double, 41> ref_pts = {-1,
                                    -0.99552712744528436149,
                                    -0.98503185912472477625,
                                    -0.96861086956768183007,
                                    -0.94636419964749212120,
                                    -0.91842587069790381320,
                                    -0.88496397216961512278,
                                    -0.84617977210399184222,
                                    -0.80230653395809178142,
                                    -0.75360812188695136491,
                                    -0.70037741678068295780,
                                    -0.64293455606458542288,
                                    -0.58162500891521268803,
                                    -0.51681749884712931698,
                                    -0.44890178631482849896,
                                    -0.37828632473108320466,
                                    -0.30539580402944574212,
                                    -0.23066859655953025885,
                                    -0.15455412068384000054,
                                    -0.077510137936254275594,
                                    0,
                                    0.077510137936254275594,
                                    0.15455412068384000054,
                                    0.23066859655953025885,
                                    0.30539580402944574212,
                                    0.37828632473108320466,
                                    0.44890178631482849896,
                                    0.51681749884712931698,
                                    0.58162500891521268803,
                                    0.64293455606458542288,
                                    0.70037741678068295780,
                                    0.75360812188695136491,
                                    0.80230653395809178142,
                                    0.84617977210399184222,
                                    0.88496397216961512278,
                                    0.91842587069790381320,
                                    0.94636419964749212120,
                                    0.96861086956768183007,
                                    0.98503185912472477625,
                                    0.99552712744528436149,
                                    1};
  std::array<double, 41> ref_wgt = {
      0.0012195121951219512195, 0.0075066587628515885291,
      0.013472071094470606618,  0.019353298566251679906,
      0.025117698393601086512,  0.030730929097922458568,
      0.036159303444689512510,  0.041370196155572640758,
      0.046332276348651614480,  0.051015704947986513458,
      0.055392316918914310539,  0.059435791663543655745,
      0.063121811727549795415,  0.066428209232842706044,
      0.069335099287094895125,  0.071824999619763970466,
      0.073882935747389606369,  0.075496531045917972791,
      0.076656081193317470598,  0.077354612537305548537,
      0.077587924038480831627,  0.077354612537305548537,
      0.076656081193317470598,  0.075496531045917972791,
      0.073882935747389606369,  0.071824999619763970466,
      0.069335099287094895125,  0.066428209232842706044,
      0.063121811727549795415,  0.059435791663543655745,
      0.055392316918914310539,  0.051015704947986513458,
      0.046332276348651614480,  0.041370196155572640758,
      0.036159303444689512510,  0.030730929097922458568,
      0.025117698393601086512,  0.019353298566251679906,
      0.013472071094470606618,  0.0075066587628515885291,
      0.0012195121951219512195};
  IntegratorXX::GaussLobatto<double, double> quad(41);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 41; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("42 point GaussLobatto", "[1d-quad]") {
  std::array<double, 42> ref_pts = {-1,
                                    -0.99573997005351627519,
                                    -0.98574292950669961089,
                                    -0.97009809662775761712,
                                    -0.94889630544543449160,
                                    -0.92225921425861617683,
                                    -0.89033945983799151601,
                                    -0.85331989872065034316,
                                    -0.81141258579342214122,
                                    -0.76485756742647515062,
                                    -0.71392150931480154248,
                                    -0.65889617020259552626,
                                    -0.60009673124863918596,
                                    -0.53785999096259329236,
                                    -0.47254243619484758280,
                                    -0.40451820029153576791,
                                    -0.33417692013945935282,
                                    -0.26192150439015026534,
                                    -0.18816582565415141255,
                                    -0.11333234988865409664,
                                    -0.037849716559603622514,
                                    0.037849716559603622514,
                                    0.11333234988865409664,
                                    0.18816582565415141255,
                                    0.26192150439015026534,
                                    0.33417692013945935282,
                                    0.40451820029153576791,
                                    0.47254243619484758280,
                                    0.53785999096259329236,
                                    0.60009673124863918596,
                                    0.65889617020259552626,
                                    0.71392150931480154248,
                                    0.76485756742647515062,
                                    0.81141258579342214122,
                                    0.85331989872065034316,
                                    0.89033945983799151601,
                                    0.92225921425861617683,
                                    0.94889630544543449160,
                                    0.97009809662775761712,
                                    0.98574292950669961089,
                                    0.99573997005351627519,
                                    1};
  std::array<double, 42> ref_wgt = {
      0.0011614401858304297329, 0.0071497069724666473556,
      0.012833605558313824672,  0.018440983044666174835,
      0.023942318410790523580,  0.029306411216165701870,
      0.034502604399116890851,  0.039501155201751501059,
      0.044273440030289172481,  0.048792126960380732316,
      0.053031334938156928622,  0.056966782983790267045,
      0.060575929662544087861,  0.063838102375796548532,
      0.066734615856802646382,  0.069248879241938953641,
      0.071366491125350074362,  0.073075322062271661036,
      0.074365584053192820801,  0.075229886613271169195,
      0.075663279107113243769,  0.075663279107113243769,
      0.075229886613271169195,  0.074365584053192820801,
      0.073075322062271661036,  0.071366491125350074362,
      0.069248879241938953641,  0.066734615856802646382,
      0.063838102375796548532,  0.060575929662544087861,
      0.056966782983790267045,  0.053031334938156928622,
      0.048792126960380732316,  0.044273440030289172481,
      0.039501155201751501059,  0.034502604399116890851,
      0.029306411216165701870,  0.023942318410790523580,
      0.018440983044666174835,  0.012833605558313824672,
      0.0071497069724666473556, 0.0011614401858304297329};
  IntegratorXX::GaussLobatto<double, double> quad(42);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 42; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("43 point GaussLobatto", "[1d-quad]") {
  std::array<double, 43> ref_pts = {-1,
                                    -0.99593797675777863962,
                                    -0.98640454263597516165,
                                    -0.97148223504768399484,
                                    -0.95125371932737343673,
                                    -0.92582968285309767826,
                                    -0.89534904191295572437,
                                    -0.85997829318375539692,
                                    -0.81991062913895517782,
                                    -0.77536489029935407814,
                                    -0.72658437267562142270,
                                    -0.67383550007645611580,
                                    -0.61740636950196462307,
                                    -0.55760517791055393058,
                                    -0.49475853908846551720,
                                    -0.42920969987409322251,
                                    -0.36131666550730554476,
                                    -0.29145024435634547892,
                                    -0.21999202270862706426,
                                    -0.14733228069044065342,
                                    -0.073867860700411845220,
                                    0,
                                    0.073867860700411845220,
                                    0.14733228069044065342,
                                    0.21999202270862706426,
                                    0.29145024435634547892,
                                    0.36131666550730554476,
                                    0.42920969987409322251,
                                    0.49475853908846551720,
                                    0.55760517791055393058,
                                    0.61740636950196462307,
                                    0.67383550007645611580,
                                    0.72658437267562142270,
                                    0.77536489029935407814,
                                    0.81991062913895517782,
                                    0.85997829318375539692,
                                    0.89534904191295572437,
                                    0.92582968285309767826,
                                    0.95125371932737343673,
                                    0.97148223504768399484,
                                    0.98640454263597516165,
                                    0.99593797675777863962,
                                    1};
  std::array<double, 43> ref_wgt = {
      0.0011074197120708748616, 0.0068176131980729018636,
      0.012239409664139598703,  0.017591487668267928581,
      0.022847092559028573947,  0.027977816257611357623,
      0.032955701327542518084,  0.037753579888412150008,
      0.042345254883842158530,  0.046705651312898933560,
      0.050810955703379603479,  0.054638747086953435804,
      0.058168119828086677424,  0.061379797970822127502,
      0.064256240598347203488,  0.066781737677068672516,
      0.068942495881944086617,  0.070726713943604273670,
      0.072124647110261263100,  0.073128660374636309801,
      0.073733270176421773657,  0.073935174353175154358,
      0.073733270176421773657,  0.073128660374636309801,
      0.072124647110261263100,  0.070726713943604273670,
      0.068942495881944086617,  0.066781737677068672516,
      0.064256240598347203488,  0.061379797970822127502,
      0.058168119828086677424,  0.054638747086953435804,
      0.050810955703379603479,  0.046705651312898933560,
      0.042345254883842158530,  0.037753579888412150008,
      0.032955701327542518084,  0.027977816257611357623,
      0.022847092559028573947,  0.017591487668267928581,
      0.012239409664139598703,  0.0068176131980729018636,
      0.0011074197120708748616};
  IntegratorXX::GaussLobatto<double, double> quad(43);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 43; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("44 point GaussLobatto", "[1d-quad]") {
  std::array<double, 44> ref_pts = {-1,
                                    -0.99612249478679132991,
                                    -0.98702117792983319815,
                                    -0.97277258300811034082,
                                    -0.95345210738307753973,
                                    -0.92916067588415349938,
                                    -0.90002498909782004622,
                                    -0.86619696797693570474,
                                    -0.82785298541962516064,
                                    -0.78519295380487928846,
                                    -0.73843928529285848668,
                                    -0.68783573332654418038,
                                    -0.63364612229852887152,
                                    -0.57615297233386485076,
                                    -0.51565602648911493658,
                                    -0.45247068810283817939,
                                    -0.38692637647101078530,
                                    -0.31936480943336470609,
                                    -0.25013822183139490045,
                                    -0.17960752912999624034,
                                    -0.10814044577895656491,
                                    -0.036109568125621549815,
                                    0.036109568125621549815,
                                    0.10814044577895656491,
                                    0.17960752912999624034,
                                    0.25013822183139490045,
                                    0.31936480943336470609,
                                    0.38692637647101078530,
                                    0.45247068810283817939,
                                    0.51565602648911493658,
                                    0.57615297233386485076,
                                    0.63364612229852887152,
                                    0.68783573332654418038,
                                    0.73843928529285848668,
                                    0.78519295380487928846,
                                    0.82785298541962516064,
                                    0.86619696797693570474,
                                    0.90002498909782004622,
                                    0.92916067588415349938,
                                    0.95345210738307753973,
                                    0.97277258300811034082,
                                    0.98702117792983319815,
                                    0.99612249478679132991,
                                    1};
  std::array<double, 44> ref_wgt = {
      0.0010570824524312896406, 0.0065081226214761116211,
      0.011685488970917214518,  0.016799192269921774574,
      0.021824935857153263993,  0.026736800540116416609,
      0.031509239967195059318,  0.036117391552679905857,
      0.040537237485392991291,  0.044745737726254162124,
      0.048720952535292529584,  0.052442157727594372667,
      0.055889953075826156227,  0.059046363613777589271,
      0.061894933426761269231,  0.064420811484882628505,
      0.066610829090974535805,  0.068453568548275647381,
      0.069939422694159254681,  0.071060644991731395819,
      0.071811389919312993244,  0.072187743447873438038,
      0.072187743447873438038,  0.071811389919312993244,
      0.071060644991731395819,  0.069939422694159254681,
      0.068453568548275647381,  0.066610829090974535805,
      0.064420811484882628505,  0.061894933426761269231,
      0.059046363613777589271,  0.055889953075826156227,
      0.052442157727594372667,  0.048720952535292529584,
      0.044745737726254162124,  0.040537237485392991291,
      0.036117391552679905857,  0.031509239967195059318,
      0.026736800540116416609,  0.021824935857153263993,
      0.016799192269921774574,  0.011685488970917214518,
      0.0065081226214761116211, 0.0010570824524312896406};
  IntegratorXX::GaussLobatto<double, double> quad(44);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 44; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("45 point GaussLobatto", "[1d-quad]") {
  std::array<double, 45> ref_pts = {-1,
                                    -0.99629472186908847162,
                                    -0.98759681924130657102,
                                    -0.97397741500697187245,
                                    -0.95550542260810309957,
                                    -0.93227305660553580615,
                                    -0.90439611326430657139,
                                    -0.87201349414244826035,
                                    -0.83528653665999117727,
                                    -0.79439821707030105214,
                                    -0.74955224131806391234,
                                    -0.70097203119470627025,
                                    -0.64889961172478485919,
                                    -0.59359440563963433524,
                                    -0.53533194106869200644,
                                    -0.47440247894089581755,
                                    -0.41110956695974319969,
                                    -0.34576852736866930848,
                                    -0.27870488604725411679,
                                    -0.21025275076806847574,
                                    -0.14075314669569340879,
                                    -0.070552317421623826527,
                                    0,
                                    0.070552317421623826527,
                                    0.14075314669569340879,
                                    0.21025275076806847574,
                                    0.27870488604725411679,
                                    0.34576852736866930848,
                                    0.41110956695974319969,
                                    0.47440247894089581755,
                                    0.53533194106869200644,
                                    0.59359440563963433524,
                                    0.64889961172478485919,
                                    0.70097203119470627025,
                                    0.74955224131806391234,
                                    0.79439821707030105214,
                                    0.83528653665999117727,
                                    0.87201349414244826035,
                                    0.90439611326430657139,
                                    0.93227305660553580615,
                                    0.95550542260810309957,
                                    0.97397741500697187245,
                                    0.98759681924130657102,
                                    0.99629472186908847162,
                                    1};
  std::array<double, 45> ref_wgt = {
      0.0010101010101010101010, 0.0062192303157486594985,
      0.011168288996584963868,  0.016059089495837321372,
      0.020869524716397265463,  0.025575899418151970997,
      0.030154825753535939195,  0.034583509607989822672,
      0.038839894146310447526,  0.042902777131137507706,
      0.046751918850698062381,  0.050368143785247741854,
      0.053733436478770827087,  0.056831031443630642040,
      0.059645496759154213583,  0.062162810990644116445,
      0.064370433064034661009,  0.066257364756539747284,
      0.067814205496082610677,  0.069033199198602262028,
      0.069908272911014880663,  0.070435067067928043537,
      0.070610957211714566022,  0.070435067067928043537,
      0.069908272911014880663,  0.069033199198602262028,
      0.067814205496082610677,  0.066257364756539747284,
      0.064370433064034661009,  0.062162810990644116445,
      0.059645496759154213583,  0.056831031443630642040,
      0.053733436478770827087,  0.050368143785247741854,
      0.046751918850698062381,  0.042902777131137507706,
      0.038839894146310447526,  0.034583509607989822672,
      0.030154825753535939195,  0.025575899418151970997,
      0.020869524716397265463,  0.016059089495837321372,
      0.011168288996584963868,  0.0062192303157486594985,
      0.0010101010101010101010};
  IntegratorXX::GaussLobatto<double, double> quad(45);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 45; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("46 point GaussLobatto", "[1d-quad]") {
  std::array<double, 46> ref_pts = {-1,
                                    -0.99645572570481590255,
                                    -0.98813501918221039422,
                                    -0.97510411399680679500,
                                    -0.95742612431139475714,
                                    -0.93518547360661386475,
                                    -0.90848820013987512081,
                                    -0.87746154772403537908,
                                    -0.84225338093664277935,
                                    -0.80303148692894623011,
                                    -0.75998277817332867809,
                                    -0.71331240270411199178,
                                    -0.66324276693586212395,
                                    -0.61001247601549343385,
                                    -0.55387519687696026657,
                                    -0.49509844946839523972,
                                    -0.43396233193629910776,
                                    -0.37075818585393542719,
                                    -0.30578720786106097521,
                                    -0.23935901433464160404,
                                    -0.17179016593254402079,
                                    -0.10340265904261187052,
                                    -0.034522391326796098361,
                                    0.034522391326796098361,
                                    0.10340265904261187052,
                                    0.17179016593254402079,
                                    0.23935901433464160404,
                                    0.30578720786106097521,
                                    0.37075818585393542719,
                                    0.43396233193629910776,
                                    0.49509844946839523972,
                                    0.55387519687696026657,
                                    0.61001247601549343385,
                                    0.66324276693586212395,
                                    0.71331240270411199178,
                                    0.75998277817332867809,
                                    0.80303148692894623011,
                                    0.84225338093664277935,
                                    0.87746154772403537908,
                                    0.90848820013987512081,
                                    0.93518547360661386475,
                                    0.95742612431139475714,
                                    0.97510411399680679500,
                                    0.98813501918221039422,
                                    0.99645572570481590255,
                                    1};
  std::array<double, 46> ref_wgt = {
      0.00096618357487922705314, 0.0059491487454403582158,
      0.010684638400132985609,   0.015366706580523116581,
      0.019975201401608782730,   0.024488419616659377444,
      0.028884910179304030133,   0.033143738893585783363,
      0.037244616854397545031,   0.041168004241210667040,
      0.044895205632908466507,   0.048408459896685135400,
      0.051691025153219682167,   0.054727258705199017822,
      0.057502691652412540477,   0.060004097878936433071,
      0.062219557101267637018,   0.064138511685042370350,
      0.065751816963516745857,   0.067051784820030349205,
      0.068032220327834335082,   0.068688451273269446847,
      0.069017350421935966999,   0.069017350421935966999,
      0.068688451273269446847,   0.068032220327834335082,
      0.067051784820030349205,   0.065751816963516745857,
      0.064138511685042370350,   0.062219557101267637018,
      0.060004097878936433071,   0.057502691652412540477,
      0.054727258705199017822,   0.051691025153219682167,
      0.048408459896685135400,   0.044895205632908466507,
      0.041168004241210667040,   0.037244616854397545031,
      0.033143738893585783363,   0.028884910179304030133,
      0.024488419616659377444,   0.019975201401608782730,
      0.015366706580523116581,   0.010684638400132985609,
      0.0059491487454403582158,  0.00096618357487922705314};
  IntegratorXX::GaussLobatto<double, double> quad(46);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 46; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("47 point GaussLobatto", "[1d-quad]") {
  std::array<double, 47> ref_pts = {-1,
                                    -0.99660646054212068910,
                                    -0.98863895391808267132,
                                    -0.97615928406971716999,
                                    -0.95922536550699657019,
                                    -0.93791463593864482324,
                                    -0.91232438055863788242,
                                    -0.88257138015534392433,
                                    -0.84879139892918385783,
                                    -0.81113857120658903877,
                                    -0.76978470039008201373,
                                    -0.72491847598114851013,
                                    -0.67674461305635712318,
                                    -0.62548291840984659175,
                                    -0.57136728773713047472,
                                    -0.51464463848540913574,
                                    -0.45557378326275429433,
                                    -0.39442424895809430122,
                                    -0.33147504696614510168,
                                    -0.26701340013179553515,
                                    -0.20133343222451010369,
                                    -0.13473482592350692655,
                                    -0.067521455437714549842,
                                    0,
                                    0.067521455437714549842,
                                    0.13473482592350692655,
                                    0.20133343222451010369,
                                    0.26701340013179553515,
                                    0.33147504696614510168,
                                    0.39442424895809430122,
                                    0.45557378326275429433,
                                    0.51464463848540913574,
                                    0.57136728773713047472,
                                    0.62548291840984659175,
                                    0.67674461305635712318,
                                    0.72491847598114851013,
                                    0.76978470039008201373,
                                    0.81113857120658903877,
                                    0.84879139892918385783,
                                    0.88257138015534392433,
                                    0.91232438055863788242,
                                    0.93791463593864482324,
                                    0.95922536550699657019,
                                    0.97615928406971716999,
                                    0.98863895391808267132,
                                    0.99660646054212068910,
                                    1};
  std::array<double, 47> ref_wgt = {
      0.00092506938020351526364, 0.0056962800915922655381,
      0.010231700532574725126,   0.014718038492394861881,
      0.019136892105083802168,   0.023468346462881329068,
      0.027692692211754887358,   0.031790670982680377620,
      0.035743590718663316620,   0.039533417766413467252,
      0.043142861264354087303,   0.046555452799402833495,
      0.049755621859878704643,   0.052728767019742942734,
      0.055461322629035284095,   0.057940820745543195140,
      0.060155948041983030272,   0.062096597436779087094,
      0.063753914216627272672,   0.065120336442322086001,
      0.066189629454511168971,   0.066956914322502746641,
      0.067418690106642322354,   0.067572849832865381385,
      0.067418690106642322354,   0.066956914322502746641,
      0.066189629454511168971,   0.065120336442322086001,
      0.063753914216627272672,   0.062096597436779087094,
      0.060155948041983030272,   0.057940820745543195140,
      0.055461322629035284095,   0.052728767019742942734,
      0.049755621859878704643,   0.046555452799402833495,
      0.043142861264354087303,   0.039533417766413467252,
      0.035743590718663316620,   0.031790670982680377620,
      0.027692692211754887358,   0.023468346462881329068,
      0.019136892105083802168,   0.014718038492394861881,
      0.010231700532574725126,   0.0056962800915922655381,
      0.00092506938020351526364};
  IntegratorXX::GaussLobatto<double, double> quad(47);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 47; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("48 point GaussLobatto", "[1d-quad]") {
  std::array<double, 48> ref_pts = {-1,
                                    -0.99674778133985746440,
                                    -0.98911147001363572789,
                                    -0.97714884689083677288,
                                    -0.96091315350638159011,
                                    -0.94047554933508129520,
                                    -0.91592544997624642008,
                                    -0.88737022431822009720,
                                    -0.85493474483877407027,
                                    -0.81876084748560586870,
                                    -0.77900671359984382197,
                                    -0.73584617911284836876,
                                    -0.68946797481109071037,
                                    -0.64007490126595713783,
                                    -0.58788294214548518103,
                                    -0.53312031983277696110,
                                    -0.47602649750285707802,
                                    -0.41685113203270266991,
                                    -0.35585298232890604382,
                                    -0.29329877784975926536,
                                    -0.22946205227124457033,
                                    -0.16462194739809062748,
                                    -0.099061992550750112347,
                                    -0.033068864766152911091,
                                    0.033068864766152911091,
                                    0.099061992550750112347,
                                    0.16462194739809062748,
                                    0.22946205227124457033,
                                    0.29329877784975926536,
                                    0.35585298232890604382,
                                    0.41685113203270266991,
                                    0.47602649750285707802,
                                    0.53312031983277696110,
                                    0.58788294214548518103,
                                    0.64007490126595713783,
                                    0.68946797481109071037,
                                    0.73584617911284836876,
                                    0.77900671359984382197,
                                    0.81876084748560586870,
                                    0.85493474483877407027,
                                    0.88737022431822009720,
                                    0.91592544997624642008,
                                    0.94047554933508129520,
                                    0.96091315350638159011,
                                    0.97714884689083677288,
                                    0.98911147001363572789,
                                    0.99674778133985746440,
                                    1};
  std::array<double, 48> ref_wgt = {
      0.00088652482269503546099, 0.0054591926002481192202,
      0.0098069319789003280531,  0.014109490605488713237,
      0.018350036475219081469,   0.022510263736936084499,
      0.026572032590911317122,   0.030517597621303642529,
      0.034329711700673836980,   0.037991707926728156526,
      0.041487574518847291125,   0.044802025564071610480,
      0.047920568156735500661,   0.050829565905944697254,
      0.053516298628674931225,   0.055969018005148835583,
      0.058176998969274631658,   0.060130586616844023051,
      0.061821238429979366807,   0.063241561635037985662,
      0.064385345531601176533,   0.065247588651725823576,
      0.065824520631008017095,   0.066113618696001794193,
      0.066113618696001794193,   0.065824520631008017095,
      0.065247588651725823576,   0.064385345531601176533,
      0.063241561635037985662,   0.061821238429979366807,
      0.060130586616844023051,   0.058176998969274631658,
      0.055969018005148835583,   0.053516298628674931225,
      0.050829565905944697254,   0.047920568156735500661,
      0.044802025564071610480,   0.041487574518847291125,
      0.037991707926728156526,   0.034329711700673836980,
      0.030517597621303642529,   0.026572032590911317122,
      0.022510263736936084499,   0.018350036475219081469,
      0.014109490605488713237,   0.0098069319789003280531,
      0.0054591926002481192202,  0.00088652482269503546099};
  IntegratorXX::GaussLobatto<double, double> quad(48);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 48; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("49 point GaussLobatto", "[1d-quad]") {
  std::array<double, 49> ref_pts = {-1,
                                    -0.99688045591002292772,
                                    -0.98955512461923073571,
                                    -0.97807812450137201588,
                                    -0.96249848799325272995,
                                    -0.94288171966319975796,
                                    -0.91931014427258449066,
                                    -0.89188264602644242709,
                                    -0.86071427280478948515,
                                    -0.82593575928507073757,
                                    -0.78769298064365400914,
                                    -0.74614634155177968265,
                                    -0.70147010377105295414,
                                    -0.65385165543221246864,
                                    -0.60349072516676650059,
                                    -0.55059854443322801224,
                                    -0.49539696157275240040,
                                    -0.43811751132074184063,
                                    -0.37900044368276887389,
                                    -0.31829371625110155961,
                                    -0.25625195419014618846,
                                    -0.19313538225402070996,
                                    -0.12920873331637993299,
                                    -0.064740137990899129064,
                                    0,
                                    0.064740137990899129064,
                                    0.12920873331637993299,
                                    0.19313538225402070996,
                                    0.25625195419014618846,
                                    0.31829371625110155961,
                                    0.37900044368276887389,
                                    0.43811751132074184063,
                                    0.49539696157275240040,
                                    0.55059854443322801224,
                                    0.60349072516676650059,
                                    0.65385165543221246864,
                                    0.70147010377105295414,
                                    0.74614634155177968265,
                                    0.78769298064365400914,
                                    0.82593575928507073757,
                                    0.86071427280478948515,
                                    0.89188264602644242709,
                                    0.91931014427258449066,
                                    0.94288171966319975796,
                                    0.96249848799325272995,
                                    0.97807812450137201588,
                                    0.98955512461923073571,
                                    0.99688045591002292772,
                                    1};
  std::array<double, 49> ref_wgt = {
      0.00085034013605442176871, 0.0052366002997777451913,
      0.0094080469628555944784,  0.013537829381581817198,
      0.017610526816783106317,   0.021609284240822007705,
      0.025517379167136704734,   0.029318434709843002710,
      0.032996513505725078217,   0.036536190813376634843,
      0.039922621143590443426,   0.043141601227016470213,
      0.046179629873557273466,   0.049023964729225407156,
      0.051662675783964653525,   0.054084695442135281725,
      0.056279864961135846889,   0.058238977070491023950,
      0.059953814596105188767,   0.061417184929446926960,
      0.062622950198032684894,   0.063566053011186641357,
      0.064242537673388332371,   0.064649566776405844556,
      0.064785433100723735171,   0.064649566776405844556,
      0.064242537673388332371,   0.063566053011186641357,
      0.062622950198032684894,   0.061417184929446926960,
      0.059953814596105188767,   0.058238977070491023950,
      0.056279864961135846889,   0.054084695442135281725,
      0.051662675783964653525,   0.049023964729225407156,
      0.046179629873557273466,   0.043141601227016470213,
      0.039922621143590443426,   0.036536190813376634843,
      0.032996513505725078217,   0.029318434709843002710,
      0.025517379167136704734,   0.021609284240822007705,
      0.017610526816783106317,   0.013537829381581817198,
      0.0094080469628555944784,  0.0052366002997777451913,
      0.00085034013605442176871};
  IntegratorXX::GaussLobatto<double, double> quad(49);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 49; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("50 point GaussLobatto", "[1d-quad]") {
  std::array<double, 50> ref_pts = {-1,
                                    -0.99700517536264358624,
                                    -0.98997222005802080202,
                                    -0.97895191064671980927,
                                    -0.96398948010996861213,
                                    -0.94514532868088141377,
                                    -0.92249537850275274666,
                                    -0.89613084907683263276,
                                    -0.86615790817735331097,
                                    -0.83269724979645795279,
                                    -0.79588361011772846939,
                                    -0.75586522579405303906,
                                    -0.71280323742364585985,
                                    -0.66687104087904481590,
                                    -0.61825358920152917083,
                                    -0.56714664791567042573,
                                    -0.51375600678304874407,
                                    -0.45829665117929975927,
                                    -0.40099189643639848090,
                                    -0.34207248863880384363,
                                    -0.28177567549590951202,
                                    -0.22034425103305647607,
                                    -0.15802557794840290299,
                                    -0.095070591572656647762,
                                    -0.031732789442623712912,
                                    0.031732789442623712912,
                                    0.095070591572656647762,
                                    0.15802557794840290299,
                                    0.22034425103305647607,
                                    0.28177567549590951202,
                                    0.34207248863880384363,
                                    0.40099189643639848090,
                                    0.45829665117929975927,
                                    0.51375600678304874407,
                                    0.56714664791567042573,
                                    0.61825358920152917083,
                                    0.66687104087904481590,
                                    0.71280323742364585985,
                                    0.75586522579405303906,
                                    0.79588361011772846939,
                                    0.83269724979645795279,
                                    0.86615790817735331097,
                                    0.89613084907683263276,
                                    0.92249537850275274666,
                                    0.94514532868088141377,
                                    0.96398948010996861213,
                                    0.97895191064671980927,
                                    0.98997222005802080202,
                                    0.99700517536264358624,
                                    1};
  std::array<double, 50> ref_wgt = {
      0.00081632653061224489796, 0.0050273455497416577264,
      0.0090329866868996020993,  0.013000139812211760657,
      0.016914655483863766023,   0.020760989497015993439,
      0.024523701718169494315,   0.028187655451060249166,
      0.031738102606570638751,   0.035160749089347249630,
      0.038441814210997734562,   0.041568086852368492733,
      0.044526978934472742230,   0.047306576229236722854,
      0.049895686393343376046,   0.052283884066433463416,
      0.054461552866930615293,   0.056419924123210141028,
      0.058151112187474100161,   0.059648146191833454147,
      0.060904998119632791003,   0.061916607079486179018,
      0.062678899684568010747,   0.063188806455266633214,
      0.063444274179252886844,   0.063444274179252886844,
      0.063188806455266633214,   0.062678899684568010747,
      0.061916607079486179018,   0.060904998119632791003,
      0.059648146191833454147,   0.058151112187474100161,
      0.056419924123210141028,   0.054461552866930615293,
      0.052283884066433463416,   0.049895686393343376046,
      0.047306576229236722854,   0.044526978934472742230,
      0.041568086852368492733,   0.038441814210997734562,
      0.035160749089347249630,   0.031738102606570638751,
      0.028187655451060249166,   0.024523701718169494315,
      0.020760989497015993439,   0.016914655483863766023,
      0.013000139812211760657,   0.0090329866868996020993,
      0.0050273455497416577264,  0.00081632653061224489796};
  IntegratorXX::GaussLobatto<double, double> quad(50);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 50; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("55 point GaussLobatto", "[1d-quad]") {
  std::array<double, 55> ref_pts = {-1,
                                    -0.99752930576127305531,
                                    -0.99172550029128002516,
                                    -0.98262638754302650936,
                                    -0.97026290146392841682,
                                    -0.95467623744892770162,
                                    -0.93591820858327983182,
                                    -0.91405114044717308455,
                                    -0.88914767909967216179,
                                    -0.86129055424330548391,
                                    -0.83057230602371411403,
                                    -0.79709497829006616218,
                                    -0.76096977992244819985,
                                    -0.72231671555961477149,
                                    -0.68126418703655326252,
                                    -0.63794856689182949695,
                                    -0.59251374537831393936,
                                    -0.54511065249044732149,
                                    -0.49589675660021092384,
                                    -0.44503554136968677084,
                                    -0.39269596267922149653,
                                    -0.33905188737603176079,
                                    -0.28428151570816329801,
                                    -0.22856678936272744201,
                                    -0.17209278707505037331,
                                    -0.11504710981659152742,
                                    -0.057619257604064327758,
                                    0,
                                    0.057619257604064327758,
                                    0.11504710981659152742,
                                    0.17209278707505037331,
                                    0.22856678936272744201,
                                    0.28428151570816329801,
                                    0.33905188737603176079,
                                    0.39269596267922149653,
                                    0.44503554136968677084,
                                    0.49589675660021092384,
                                    0.54511065249044732149,
                                    0.59251374537831393936,
                                    0.63794856689182949695,
                                    0.68126418703655326252,
                                    0.72231671555961477149,
                                    0.76096977992244819985,
                                    0.79709497829006616218,
                                    0.83057230602371411403,
                                    0.86129055424330548391,
                                    0.88914767909967216179,
                                    0.91405114044717308455,
                                    0.93591820858327983182,
                                    0.95467623744892770162,
                                    0.97026290146392841682,
                                    0.98262638754302650936,
                                    0.99172550029128002516,
                                    0.99752930576127305531,
                                    1};
  std::array<double, 55> ref_wgt = {
      0.00067340067340067340067, 0.0041478623286710431232,
      0.0074558278035213583119,  0.010737281181964296771,
      0.013982826904940361823,   0.017181863492228658797,
      0.020323803383333689429,   0.023398221250648127813,
      0.026394908601620216103,   0.029303912637618080633,
      0.032115570845726109235,   0.034820543650590016718,
      0.037409845665582207589,   0.039874875642630917942,
      0.042207445093640032995,   0.044399805516991253777,
      0.046444674150926229744,   0.048335258173876831562,
      0.050065277274085500629,   0.051628984514939112375,
      0.053021185427449940669,   0.054237255266874140992,
      0.055273154376380133691,   0.056125441606870230862,
      0.056791285748460807975,   0.057268474935698951566,
      0.057555423995304932891,   0.057651179712052285170,
      0.057555423995304932891,   0.057268474935698951566,
      0.056791285748460807975,   0.056125441606870230862,
      0.055273154376380133691,   0.054237255266874140992,
      0.053021185427449940669,   0.051628984514939112375,
      0.050065277274085500629,   0.048335258173876831562,
      0.046444674150926229744,   0.044399805516991253777,
      0.042207445093640032995,   0.039874875642630917942,
      0.037409845665582207589,   0.034820543650590016718,
      0.032115570845726109235,   0.029303912637618080633,
      0.026394908601620216103,   0.023398221250648127813,
      0.020323803383333689429,   0.017181863492228658797,
      0.013982826904940361823,   0.010737281181964296771,
      0.0074558278035213583119,  0.0041478623286710431232,
      0.00067340067340067340067};
  IntegratorXX::GaussLobatto<double, double> quad(55);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 55; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("60 point GaussLobatto", "[1d-quad]") {
  std::array<double, 60> ref_pts = {-1,
                                    -0.99792699191581099573,
                                    -0.99305629093909093917,
                                    -0.98541701344774733337,
                                    -0.97503104499970188171,
                                    -0.96192743808292472023,
                                    -0.94614274477019813179,
                                    -0.92772097097142251468,
                                    -0.90671346637925973034,
                                    -0.88317878511055611129,
                                    -0.85718252386284242454,
                                    -0.82879713964553596603,
                                    -0.79810174808624472360,
                                    -0.76518190304898654714,
                                    -0.73012935824794149738,
                                    -0.69304181155131329948,
                                    -0.65402263270207389436,
                                    -0.61318057522149572220,
                                    -0.57062947330212209564,
                                    -0.52648792453700162343,
                                    -0.48087895937062309035,
                                    -0.43392969819352550281,
                                    -0.38577099703673222261,
                                    -0.33653708285377833890,
                                    -0.28636517940702951845,
                                    -0.23539512480112159961,
                                    -0.18376898172959576890,
                                    -0.13163064152109120648,
                                    -0.079125423088724234157,
                                    -0.026399667900479246653,
                                    0.026399667900479246653,
                                    0.079125423088724234157,
                                    0.13163064152109120648,
                                    0.18376898172959576890,
                                    0.23539512480112159961,
                                    0.28636517940702951845,
                                    0.33653708285377833890,
                                    0.38577099703673222261,
                                    0.43392969819352550281,
                                    0.48087895937062309035,
                                    0.52648792453700162343,
                                    0.57062947330212209564,
                                    0.61318057522149572220,
                                    0.65402263270207389436,
                                    0.69304181155131329948,
                                    0.73012935824794149738,
                                    0.76518190304898654714,
                                    0.79810174808624472360,
                                    0.82879713964553596603,
                                    0.85718252386284242454,
                                    0.88317878511055611129,
                                    0.90671346637925973034,
                                    0.92772097097142251468,
                                    0.94614274477019813179,
                                    0.96192743808292472023,
                                    0.97503104499970188171,
                                    0.98541701344774733337,
                                    0.99305629093909093917,
                                    0.99792699191581099573,
                                    1};
  std::array<double, 60> ref_wgt = {
      0.00056497175141242937853, 0.0034804479681531449950,
      0.0062580981584771698425,  0.0090168424893638244582,
      0.011750254422266674931,   0.014450866330632214107,
      0.017111184093521227868,   0.019723802887793956221,
      0.022281444575675224010,   0.024776982138835830547,
      0.027203460825102394953,   0.029554117996938696384,
      0.031822402169556473307,   0.034001991355932717972,
      0.036086810728312709880,   0.038071049570919672451,
      0.039949177486879666876,   0.041715959818897681200,
      0.043366472242994262502,   0.044896114495797823191,
      0.046300623197757076197,   0.047576083736879506333,
      0.048718941180072447212,   0.049726010181792254039,
      0.050594483862455558382,   0.051321941631911051493,
      0.051906355936194341265,   0.052346097908779451106,
      0.052639941910587587192,   0.052787068946106931708,
      0.052787068946106931708,   0.052639941910587587192,
      0.052346097908779451106,   0.051906355936194341265,
      0.051321941631911051493,   0.050594483862455558382,
      0.049726010181792254039,   0.048718941180072447212,
      0.047576083736879506333,   0.046300623197757076197,
      0.044896114495797823191,   0.043366472242994262502,
      0.041715959818897681200,   0.039949177486879666876,
      0.038071049570919672451,   0.036086810728312709880,
      0.034001991355932717972,   0.031822402169556473307,
      0.029554117996938696384,   0.027203460825102394953,
      0.024776982138835830547,   0.022281444575675224010,
      0.019723802887793956221,   0.017111184093521227868,
      0.014450866330632214107,   0.011750254422266674931,
      0.0090168424893638244582,  0.0062580981584771698425,
      0.0034804479681531449950,  0.00056497175141242937853};
  IntegratorXX::GaussLobatto<double, double> quad(60);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 60; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("65 point GaussLobatto", "[1d-quad]") {
  std::array<double, 65> ref_pts = {-1,
                                    -0.99823585898516815870,
                                    -0.99409015011842312124,
                                    -0.98758593076950913551,
                                    -0.97873913319199888949,
                                    -0.96757083026691361434,
                                    -0.95410753746002221278,
                                    -0.93838119768266555698,
                                    -0.92042911624299077848,
                                    -0.90029387556160701088,
                                    -0.87802323532494571004,
                                    -0.85367001968144930870,
                                    -0.82729199216694042060,
                                    -0.79895171880436738062,
                                    -0.76871641976162753936,
                                    -0.73665780994495239569,
                                    -0.70285192891793701945,
                                    -0.66737896055558734134,
                                    -0.63032304286426742291,
                                    -0.59177206842034207923,
                                    -0.55181747590182537997,
                                    -0.51055403320807203040,
                                    -0.46807961268227566264,
                                    -0.42449495897013840821,
                                    -0.37990345006546399621,
                                    -0.33441085210953843246,
                                    -0.28812506852594747573,
                                    -0.24115588408589652051,
                                    -0.19361470451111018185,
                                    -0.14561429223196490496,
                                    -0.097268498927621703334,
                                    -0.048691995482555117357,
                                    0,
                                    0.048691995482555117357,
                                    0.097268498927621703334,
                                    0.14561429223196490496,
                                    0.19361470451111018185,
                                    0.24115588408589652051,
                                    0.28812506852594747573,
                                    0.33441085210953843246,
                                    0.37990345006546399621,
                                    0.42449495897013840821,
                                    0.46807961268227566264,
                                    0.51055403320807203040,
                                    0.55181747590182537997,
                                    0.59177206842034207923,
                                    0.63032304286426742291,
                                    0.66737896055558734134,
                                    0.70285192891793701945,
                                    0.73665780994495239569,
                                    0.76871641976162753936,
                                    0.79895171880436738062,
                                    0.82729199216694042060,
                                    0.85367001968144930870,
                                    0.87802323532494571004,
                                    0.90029387556160701088,
                                    0.92042911624299077848,
                                    0.93838119768266555698,
                                    0.95410753746002221278,
                                    0.96757083026691361434,
                                    0.97873913319199888949,
                                    0.98758593076950913551,
                                    0.99409015011842312124,
                                    0.99823585898516815870,
                                    1};
  std::array<double, 65> ref_wgt = {
      0.00048076923076923076923, 0.0029620325412562160293,
      0.0053272417215879640742,  0.0076785701335481211169,
      0.010011514973888304412,   0.012320671119444298137,
      0.014600589550422213461,   0.016845871022064948301,
      0.019051193120028274070,   0.021211326413491117959,
      0.023321147949507752520,   0.025375653798947578333,
      0.027369971086316568133,   0.029299369619809824458,
      0.031159273145641122234,   0.032945270220318297736,
      0.034653124683798986293,   0.036278785712687434895,
      0.037818397431573346284,   0.039268308060710440688,
      0.040625078578868414032,   0.041885490881105350503,
      0.043046555412280044712,   0.044105518258298097939,
      0.045059867678332635707,   0.045907340062563537896,
      0.046645925301327952534,   0.047273871552962506782,
      0.047789689399038578190,   0.048192155377141635081,
      0.048480314882819829806,   0.048653484433821797399,
      0.048711253291255159029,   0.048653484433821797399,
      0.048480314882819829806,   0.048192155377141635081,
      0.047789689399038578190,   0.047273871552962506782,
      0.046645925301327952534,   0.045907340062563537896,
      0.045059867678332635707,   0.044105518258298097939,
      0.043046555412280044712,   0.041885490881105350503,
      0.040625078578868414032,   0.039268308060710440688,
      0.037818397431573346284,   0.036278785712687434895,
      0.034653124683798986293,   0.032945270220318297736,
      0.031159273145641122234,   0.029299369619809824458,
      0.027369971086316568133,   0.025375653798947578333,
      0.023321147949507752520,   0.021211326413491117959,
      0.019051193120028274070,   0.016845871022064948301,
      0.014600589550422213461,   0.012320671119444298137,
      0.010011514973888304412,   0.0076785701335481211169,
      0.0053272417215879640742,  0.0029620325412562160293,
      0.00048076923076923076923};
  IntegratorXX::GaussLobatto<double, double> quad(65);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 65; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("70 point GaussLobatto", "[1d-quad]") {
  std::array<double, 70> ref_pts = {-1,
                                    -0.99848051220996410891,
                                    -0.99490924669458407620,
                                    -0.98930488881777240921,
                                    -0.98167932281044748583,
                                    -0.97204820411476724788,
                                    -0.96043123049182966299,
                                    -0.94685214290097599149,
                                    -0.93133868622532099081,
                                    -0.91392255534519999749,
                                    -0.89463933138080506190,
                                    -0.87352840941241098627,
                                    -0.85063291818641470291,
                                    -0.82599963209908898126,
                                    -0.79967887568863762844,
                                    -0.77172442085273004922,
                                    -0.74219337701180934241,
                                    -0.71114607444769213427,
                                    -0.67864594105847787180,
                                    -0.64475937278302035454,
                                    -0.60955559796051358608,
                                    -0.57310653590279022216,
                                    -0.53548664996856029332,
                                    -0.49677279543993750296,
                                    -0.45704406251215168163,
                                    -0.41638161471728813096,
                                    -0.37486852311219665942,
                                    -0.33258959656935002908,
                                    -0.28963120851738211083,
                                    -0.24608112048528192116,
                                    -0.20202830281074478853,
                                    -0.15756275287897203510,
                                    -0.11277531126325341853,
                                    -0.067757476142951529698,
                                    -0.022601216378025417174,
                                    0.022601216378025417174,
                                    0.067757476142951529698,
                                    0.11277531126325341853,
                                    0.15756275287897203510,
                                    0.20202830281074478853,
                                    0.24608112048528192116,
                                    0.28963120851738211083,
                                    0.33258959656935002908,
                                    0.37486852311219665942,
                                    0.41638161471728813096,
                                    0.45704406251215168163,
                                    0.49677279543993750296,
                                    0.53548664996856029332,
                                    0.57310653590279022216,
                                    0.60955559796051358608,
                                    0.64475937278302035454,
                                    0.67864594105847787180,
                                    0.71114607444769213427,
                                    0.74219337701180934241,
                                    0.77172442085273004922,
                                    0.79967887568863762844,
                                    0.82599963209908898126,
                                    0.85063291818641470291,
                                    0.87352840941241098627,
                                    0.89463933138080506190,
                                    0.91392255534519999749,
                                    0.93133868622532099081,
                                    0.94685214290097599149,
                                    0.96043123049182966299,
                                    0.97204820411476724788,
                                    0.98167932281044748583,
                                    0.98930488881777240921,
                                    0.99490924669458407620,
                                    0.99848051220996410891,
                                    1};
  std::array<double, 70> ref_wgt = {
      0.00041407867494824016563, 0.0025513583788869967267,
      0.0045895221896944052260,  0.0066172375688958391463,
      0.0086312871975098545050,  0.010627667024309675439,
      0.012602322705070883023,   0.014551227422679706318,
      0.016470402383506221085,   0.018355927984326261017,
      0.020203952758869945713,   0.022010701586047405059,
      0.023772483540922281010,   0.025485699497131642149,
      0.027146849509668926613,   0.028752539980475433283,
      0.030299490599708718199,   0.031784541051951272079,
      0.033204657475333598915,   0.034556938661231900612,
      0.035838621982331499727,   0.037047089037198517561,
      0.038179870999973436209,   0.039234653664343176642,
      0.040209282171539175421,   0.041101765412734770483,
      0.041910280096868594916,   0.042633174475596959828,
      0.043268971717774141022,   0.043816372926572581575,
      0.044274259793083201493,   0.044641696880977403922,
      0.044917933537565240734,   0.045102405427346867258,
      0.045194735684925226924,   0.045194735684925226924,
      0.045102405427346867258,   0.044917933537565240734,
      0.044641696880977403922,   0.044274259793083201493,
      0.043816372926572581575,   0.043268971717774141022,
      0.042633174475596959828,   0.041910280096868594916,
      0.041101765412734770483,   0.040209282171539175421,
      0.039234653664343176642,   0.038179870999973436209,
      0.037047089037198517561,   0.035838621982331499727,
      0.034556938661231900612,   0.033204657475333598915,
      0.031784541051951272079,   0.030299490599708718199,
      0.028752539980475433283,   0.027146849509668926613,
      0.025485699497131642149,   0.023772483540922281010,
      0.022010701586047405059,   0.020203952758869945713,
      0.018355927984326261017,   0.016470402383506221085,
      0.014551227422679706318,   0.012602322705070883023,
      0.010627667024309675439,   0.0086312871975098545050,
      0.0066172375688958391463,  0.0045895221896944052260,
      0.0025513583788869967267,  0.00041407867494824016563};
  IntegratorXX::GaussLobatto<double, double> quad(70);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 70; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("75 point GaussLobatto", "[1d-quad]") {
  std::array<double, 75> ref_pts = {-1,
                                    -0.99867759149517536657,
                                    -0.99556918061602585290,
                                    -0.99069020569950240868,
                                    -0.98404971977321231294,
                                    -0.97565959623906061543,
                                    -0.96553477151330809624,
                                    -0.95369325425081281012,
                                    -0.94015610135426482800,
                                    -0.92494738293222138781,
                                    -0.90809414036749346639,
                                    -0.88962633859550219265,
                                    -0.86957681299113863497,
                                    -0.84798121106979270053,
                                    -0.82487792915037059539,
                                    -0.80030804411209879667,
                                    -0.77431524037541926261,
                                    -0.74694573224126028072,
                                    -0.71824818172909543040,
                                    -0.68827361206114955473,
                                    -0.65707531694730088565,
                                    -0.62470876583239559524,
                                    -0.59123150527470135551,
                                    -0.55670305663100731510,
                                    -0.52118481023038601789,
                                    -0.48473991622483990391,
                                    -0.44743317231094085660,
                                    -0.40933090852212005670,
                                    -0.37050086929646422496,
                                    -0.33101209302971209711,
                                    -0.29093478932761194749,
                                    -0.25034021417588851725,
                                    -0.20930054324976809624,
                                    -0.16788874358831688796,
                                    -0.12617844386175408717,
                                    -0.084243803462402028529,
                                    -0.042159380652026791664,
                                    0,
                                    0.042159380652026791664,
                                    0.084243803462402028529,
                                    0.12617844386175408717,
                                    0.16788874358831688796,
                                    0.20930054324976809624,
                                    0.25034021417588851725,
                                    0.29093478932761194749,
                                    0.33101209302971209711,
                                    0.37050086929646422496,
                                    0.40933090852212005670,
                                    0.44743317231094085660,
                                    0.48473991622483990391,
                                    0.52118481023038601789,
                                    0.55670305663100731510,
                                    0.59123150527470135551,
                                    0.62470876583239559524,
                                    0.65707531694730088565,
                                    0.68827361206114955473,
                                    0.71824818172909543040,
                                    0.74694573224126028072,
                                    0.77431524037541926261,
                                    0.80030804411209879667,
                                    0.82487792915037059539,
                                    0.84798121106979270053,
                                    0.86957681299113863497,
                                    0.88962633859550219265,
                                    0.90809414036749346639,
                                    0.92494738293222138781,
                                    0.94015610135426482800,
                                    0.95369325425081281012,
                                    0.96553477151330809624,
                                    0.97565959623906061543,
                                    0.98404971977321231294,
                                    0.99069020569950240868,
                                    0.99556918061602585290,
                                    0.99867759149517536657,
                                    1};
  std::array<double, 75> ref_wgt = {
      0.00036036036036036036036, 0.0022205172992955095064,
      0.0039950053212118844478,  0.0057614572604248631915,
      0.0075175375373011144066,  0.0092602200871377482112,
      0.010986427491339444109,   0.012693096958960389773,
      0.014377196448480599621,   0.016035732702302637934,
      0.017665757385581500073,   0.019264372623930965804,
      0.020828736276305757808,   0.022356067042206738725,
      0.023843649432795655489,   0.025288838612328093117,
      0.026689065107826466263,   0.028041839381614675389,
      0.029344756260040815257,   0.030595499211257983669,
      0.031791844464854567832,   0.032931664966229576983,
      0.034012934158808466063,   0.035033729587449335524,
      0.035992236316677997905,   0.036886750157702517763,
      0.037715680698487565851,   0.038477554131512797733,
      0.039171015874195242550,   0.039794832977321810414,
      0.040347896317213302775,   0.040829222567724746394,
      0.041237955948577587527,   0.041573369746916460117,
      0.041834867609386095280,   0.042021984602431702411,
      0.042134388038938066269,   0.042171878069737914913,
      0.042134388038938066269,   0.042021984602431702411,
      0.041834867609386095280,   0.041573369746916460117,
      0.041237955948577587527,   0.040829222567724746394,
      0.040347896317213302775,   0.039794832977321810414,
      0.039171015874195242550,   0.038477554131512797733,
      0.037715680698487565851,   0.036886750157702517763,
      0.035992236316677997905,   0.035033729587449335524,
      0.034012934158808466063,   0.032931664966229576983,
      0.031791844464854567832,   0.030595499211257983669,
      0.029344756260040815257,   0.028041839381614675389,
      0.026689065107826466263,   0.025288838612328093117,
      0.023843649432795655489,   0.022356067042206738725,
      0.020828736276305757808,   0.019264372623930965804,
      0.017665757385581500073,   0.016035732702302637934,
      0.014377196448480599621,   0.012693096958960389773,
      0.010986427491339444109,   0.0092602200871377482112,
      0.0075175375373011144066,  0.0057614572604248631915,
      0.0039950053212118844478,  0.0022205172992955095064,
      0.00036036036036036036036};
  IntegratorXX::GaussLobatto<double, double> quad(75);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 75; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("80 point GaussLobatto", "[1d-quad]") {
  std::array<double, 80> ref_pts = {-1,
                                    -0.99883867653092507835,
                                    -0.99610866107990519938,
                                    -0.99182292018121586819,
                                    -0.98598847776335317952,
                                    -0.97861450231691623735,
                                    -0.96971252418079561736,
                                    -0.95929644895627958346,
                                    -0.94738254284356652296,
                                    -0.93398940934788020310,
                                    -0.91913796099088049972,
                                    -0.90285138697154153396,
                                    -0.88515511710238834635,
                                    -0.86607678217504981912,
                                    -0.84564617085578157538,
                                    -0.82389518319510250605,
                                    -0.80085778083200733070,
                                    -0.77656993397441852493,
                                    -0.75106956524070981102,
                                    -0.72439649045110723775,
                                    -0.69659235646205299908,
                                    -0.66770057614097178467,
                                    -0.63776626058319665727,
                                    -0.60683614867703163943,
                                    -0.57495853412701742034,
                                    -0.54218319004940380757,
                                    -0.50856129125760347898,
                                    -0.47414533435899572548,
                                    -0.43898905578785790006,
                                    -0.40314734790241926342,
                                    -0.36667617327705082998,
                                    -0.32963247732342034030,
                                    -0.29207409937704882920,
                                    -0.25405968238810009988,
                                    -0.21564858135741284831,
                                    -0.17690077066074369751,
                                    -0.13787675040592486577,
                                    -0.098637451969149846919,
                                    -0.059244142857881932493,
                                    -0.019758331048931629780,
                                    0.019758331048931629780,
                                    0.059244142857881932493,
                                    0.098637451969149846919,
                                    0.13787675040592486577,
                                    0.17690077066074369751,
                                    0.21564858135741284831,
                                    0.25405968238810009988,
                                    0.29207409937704882920,
                                    0.32963247732342034030,
                                    0.36667617327705082998,
                                    0.40314734790241926342,
                                    0.43898905578785790006,
                                    0.47414533435899572548,
                                    0.50856129125760347898,
                                    0.54218319004940380757,
                                    0.57495853412701742034,
                                    0.60683614867703163943,
                                    0.63776626058319665727,
                                    0.66770057614097178467,
                                    0.69659235646205299908,
                                    0.72439649045110723775,
                                    0.75106956524070981102,
                                    0.77656993397441852493,
                                    0.80085778083200733070,
                                    0.82389518319510250605,
                                    0.84564617085578157538,
                                    0.86607678217504981912,
                                    0.88515511710238834635,
                                    0.90285138697154153396,
                                    0.91913796099088049972,
                                    0.93398940934788020310,
                                    0.94738254284356652296,
                                    0.95929644895627958346,
                                    0.96971252418079561736,
                                    0.97861450231691623735,
                                    0.98598847776335317952,
                                    0.99182292018121586819,
                                    0.99610866107990519938,
                                    0.99883867653092507835,
                                    1};
  std::array<double, 80> ref_wgt = {
      0.00031645569620253164557, 0.0019500843509775593405,
      0.0035089042010290183998,  0.0050614259495890576830,
      0.0066059324951682337931,  0.0081400967270119716600,
      0.0096615416736972775997,  0.011167897347743279416,
      0.012656813820266284299,   0.014125967211192374291,
      0.015573064034917646948,   0.016995845040870654249,
      0.018392088846893499824,   0.019759615455044966283,
      0.021096289678281489680,   0.022400024486050025555,
      0.023668784269300632189,   0.024900588022449768234,
      0.026093512438604030629,   0.027245694913864537361,
      0.028355336456369543554,   0.029420704495726294270,
      0.030440135588556215115,   0.031412038015994427315,
      0.032334894269127558833,   0.033207263418513783367,
      0.034027783364101021579,   0.034795172962040472782,
      0.035508234025081408613,   0.036165853193428345383,
      0.036767003673142537573,   0.037310746839375602431,
      0.037796233701933498811,   0.038222706230883605435,
      0.038589498540135870664,   0.038896037927150553000,
      0.039141845767149563761,   0.039326538260435491200,
      0.039449827031651661131,   0.039511519580047706101,
      0.039511519580047706101,   0.039449827031651661131,
      0.039326538260435491200,   0.039141845767149563761,
      0.038896037927150553000,   0.038589498540135870664,
      0.038222706230883605435,   0.037796233701933498811,
      0.037310746839375602431,   0.036767003673142537573,
      0.036165853193428345383,   0.035508234025081408613,
      0.034795172962040472782,   0.034027783364101021579,
      0.033207263418513783367,   0.032334894269127558833,
      0.031412038015994427315,   0.030440135588556215115,
      0.029420704495726294270,   0.028355336456369543554,
      0.027245694913864537361,   0.026093512438604030629,
      0.024900588022449768234,   0.023668784269300632189,
      0.022400024486050025555,   0.021096289678281489680,
      0.019759615455044966283,   0.018392088846893499824,
      0.016995845040870654249,   0.015573064034917646948,
      0.014125967211192374291,   0.012656813820266284299,
      0.011167897347743279416,   0.0096615416736972775997,
      0.0081400967270119716600,  0.0066059324951682337931,
      0.0050614259495890576830,  0.0035089042010290183998,
      0.0019500843509775593405,  0.00031645569620253164557};
  IntegratorXX::GaussLobatto<double, double> quad(80);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 80; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("85 point GaussLobatto", "[1d-quad]") {
  std::array<double, 85> ref_pts = {-1,
                                    -0.99897202696015759444,
                                    -0.99655530880197031109,
                                    -0.99276088985661449612,
                                    -0.98759430842208597880,
                                    -0.98106275712878945466,
                                    -0.97317527799110960851,
                                    -0.96394277771685812576,
                                    -0.95337801887115581548,
                                    -0.94149560409920780459,
                                    -0.92831195661537133849,
                                    -0.91384529778199588618,
                                    -0.89811562205274098256,
                                    -0.88114466940141283137,
                                    -0.86295589530873069104,
                                    -0.84357443836340493311,
                                    -0.82302708552927062190,
                                    -0.80134223512994229849,
                                    -0.77854985760396051360,
                                    -0.75468145408566173538,
                                    -0.72977001286958079187,
                                    -0.70384996381888803818,
                                    -0.67695713078107431533,
                                    -0.64912868207677500405,
                                    -0.62040307913024217087,
                                    -0.59082002331251436006,
                                    -0.56042040107078630940,
                                    -0.52924622741983827859,
                                    -0.49734058787364112998,
                                    -0.46474757889740424118,
                                    -0.43151224696237491292,
                                    -0.39768052628762679573,
                                    -0.36329917535488798380,
                                    -0.32841571228415408492,
                                    -0.29307834915940528227,
                                    -0.25733592539519688545,
                                    -0.22123784023621805331,
                                    -0.18483398448311138401,
                                    -0.14817467153891522149,
                                    -0.11131056787142932288,
                                    -0.074292622987611655958,
                                    -0.037171999016788423211,
                                    0,
                                    0.037171999016788423211,
                                    0.074292622987611655958,
                                    0.11131056787142932288,
                                    0.14817467153891522149,
                                    0.18483398448311138401,
                                    0.22123784023621805331,
                                    0.25733592539519688545,
                                    0.29307834915940528227,
                                    0.32841571228415408492,
                                    0.36329917535488798380,
                                    0.39768052628762679573,
                                    0.43151224696237491292,
                                    0.46474757889740424118,
                                    0.49734058787364112998,
                                    0.52924622741983827859,
                                    0.56042040107078630940,
                                    0.59082002331251436006,
                                    0.62040307913024217087,
                                    0.64912868207677500405,
                                    0.67695713078107431533,
                                    0.70384996381888803818,
                                    0.72977001286958079187,
                                    0.75468145408566173538,
                                    0.77854985760396051360,
                                    0.80134223512994229849,
                                    0.82302708552927062190,
                                    0.84357443836340493311,
                                    0.86295589530873069104,
                                    0.88114466940141283137,
                                    0.89811562205274098256,
                                    0.91384529778199588618,
                                    0.92831195661537133849,
                                    0.94149560409920780459,
                                    0.95337801887115581548,
                                    0.96394277771685812576,
                                    0.97317527799110960851,
                                    0.98106275712878945466,
                                    0.98759430842208597880,
                                    0.99276088985661449612,
                                    0.99655530880197031109,
                                    0.99897202696015759444,
                                    1};
  std::array<double, 85> ref_wgt = {
      0.00028011204481792717087, 0.0017262018466269388352,
      0.0031063840226994867711,  0.0044815476765854418255,
      0.0058504179627099589691,  0.0072111777252003760269,
      0.0085619625944439447575,  0.0099009105916387052333,
      0.011226172998875325503,   0.012535918968397497170,
      0.013828338687682475061,   0.015101646110443698163,
      0.016354081518747354759,   0.017583913997018648772,
      0.018789443844557541606,   0.019969004935073187349,
      0.021120967025047393966,   0.022243738010062724635,
      0.023335766127107425710,   0.024395542100391090456,
      0.025421601228013577872,   0.026412525406774042575,
      0.027366945092419508096,   0.028283541192681556531,
      0.029161046890519855941,   0.029998249395074432121,
      0.030793991617920555073,   0.031547173772318476936,
      0.032256754893253635998,   0.032921754276170469067,
      0.033541252832414081845,   0.034114394359508308102,
      0.034640386724515831235,   0.035118502958845788315,
      0.035548082262996400826,   0.035928530919844470033,
      0.036259323115219841100,   0.036540001664630987227,
      0.036770178645137504934,   0.036949535931496357327,
      0.037077825635840967201,   0.037154870450285559732,
      0.037180563891981298345,   0.037154870450285559732,
      0.037077825635840967201,   0.036949535931496357327,
      0.036770178645137504934,   0.036540001664630987227,
      0.036259323115219841100,   0.035928530919844470033,
      0.035548082262996400826,   0.035118502958845788315,
      0.034640386724515831235,   0.034114394359508308102,
      0.033541252832414081845,   0.032921754276170469067,
      0.032256754893253635998,   0.031547173772318476936,
      0.030793991617920555073,   0.029998249395074432121,
      0.029161046890519855941,   0.028283541192681556531,
      0.027366945092419508096,   0.026412525406774042575,
      0.025421601228013577872,   0.024395542100391090456,
      0.023335766127107425710,   0.022243738010062724635,
      0.021120967025047393966,   0.019969004935073187349,
      0.018789443844557541606,   0.017583913997018648772,
      0.016354081518747354759,   0.015101646110443698163,
      0.013828338687682475061,   0.012535918968397497170,
      0.011226172998875325503,   0.0099009105916387052333,
      0.0085619625944439447575,  0.0072111777252003760269,
      0.0058504179627099589691,  0.0044815476765854418255,
      0.0031063840226994867711,  0.0017262018466269388352,
      0.00028011204481792717087};
  IntegratorXX::GaussLobatto<double, double> quad(85);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 85; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("90 point GaussLobatto", "[1d-quad]") {
  std::array<double, 90> ref_pts = {-1,
                                    -0.99908366240830210344,
                                    -0.99692925969451796505,
                                    -0.99354631340752370081,
                                    -0.98893925343240808845,
                                    -0.98311380194644508243,
                                    -0.97607714908871293012,
                                    -0.96783796888588742076,
                                    -0.95840641412551108266,
                                    -0.94779410550704211194,
                                    -0.93601411792337302086,
                                    -0.92308096459962630711,
                                    -0.90901057932597563424,
                                    -0.89382029688338912838,
                                    -0.87752883171698072226,
                                    -0.86015625489652178749,
                                    -0.84172396939870412803,
                                    -0.82225468374469074214,
                                    -0.80177238402704707327,
                                    -0.78030230436139887538,
                                    -0.75787089579972266856,
                                    -0.73450579374386323705,
                                    -0.71023578389960395124,
                                    -0.68509076681334609732,
                                    -0.65910172103515918089,
                                    -0.63230066495363166970,
                                    -0.60472061734957240278,
                                    -0.57639555671718127730,
                                    -0.54736037940281976975,
                                    -0.51765085661296421727,
                                    -0.48730359034431501075,
                                    -0.45635596829036073560,
                                    -0.42484611777995589690,
                                    -0.39281285880466243255,
                                    -0.36029565619272715205,
                                    -0.32733457098861807149,
                                    -0.29397021109802099316,
                                    -0.26024368125910235578,
                                    -0.22619653240167421715,
                                    -0.19187071045665118256,
                                    -0.15730850467886621731,
                                    -0.12255249554691173696,
                                    -0.087645502304193408115,
                                    -0.052630530205826069271,
                                    -0.017550717536363547392,
                                    0.017550717536363547392,
                                    0.052630530205826069271,
                                    0.087645502304193408115,
                                    0.12255249554691173696,
                                    0.15730850467886621731,
                                    0.19187071045665118256,
                                    0.22619653240167421715,
                                    0.26024368125910235578,
                                    0.29397021109802099316,
                                    0.32733457098861807149,
                                    0.36029565619272715205,
                                    0.39281285880466243255,
                                    0.42484611777995589690,
                                    0.45635596829036073560,
                                    0.48730359034431501075,
                                    0.51765085661296421727,
                                    0.54736037940281976975,
                                    0.57639555671718127730,
                                    0.60472061734957240278,
                                    0.63230066495363166970,
                                    0.65910172103515918089,
                                    0.68509076681334609732,
                                    0.71023578389960395124,
                                    0.73450579374386323705,
                                    0.75787089579972266856,
                                    0.78030230436139887538,
                                    0.80177238402704707327,
                                    0.82225468374469074214,
                                    0.84172396939870412803,
                                    0.86015625489652178749,
                                    0.87752883171698072226,
                                    0.89382029688338912838,
                                    0.90901057932597563424,
                                    0.92308096459962630711,
                                    0.93601411792337302086,
                                    0.94779410550704211194,
                                    0.95840641412551108266,
                                    0.96783796888588742076,
                                    0.97607714908871293012,
                                    0.98311380194644508243,
                                    0.98893925343240808845,
                                    0.99354631340752370081,
                                    0.99692925969451796505,
                                    0.99908366240830210344,
                                    1};
  std::array<double, 90> ref_wgt = {
      0.00024968789013732833958, 0.0015387690406947879013,
      0.0027693321909186197771,  0.0039958371181095491396,
      0.0052173305404752013789,  0.0064323742053852988990,
      0.0076394857323086816201,  0.0088371823565781745678,
      0.010023990150963538754,   0.011198447672339711750,
      0.012359108327817702628,   0.013504542361621505248,
      0.014633338699983519211,   0.015744106726931328456,
      0.016835478015548680809,   0.017906108023132139125,
      0.018954677752674151880,   0.019979895380698184259,
      0.020980497850447824836,   0.021955252428981760459,
      0.022902958226530883646,   0.023822447676397862437,
      0.024712587973663149080,   0.025572282470976441631,
      0.026400472029745222368,   0.027196136325075122801,
      0.027958295102866762356,   0.028686009387528311782,
      0.029378382638821157273,   0.030034561856416975400,
      0.030653738630807821653,   0.031235150139276184004,
      0.031778080085699139507,   0.032281859583029608344,
      0.032745867977368087016,   0.033169533612610039049,
      0.033552334534727216531,   0.033893799134815473871,
      0.034193506730117014933,   0.034451088082301386260,
      0.034666225852366793855,   0.034838654991601380330,
      0.034968163068122854817,   0.035054590528594221082,
      0.035097830894793200935,   0.035097830894793200935,
      0.035054590528594221082,   0.034968163068122854817,
      0.034838654991601380330,   0.034666225852366793855,
      0.034451088082301386260,   0.034193506730117014933,
      0.033893799134815473871,   0.033552334534727216531,
      0.033169533612610039049,   0.032745867977368087016,
      0.032281859583029608344,   0.031778080085699139507,
      0.031235150139276184004,   0.030653738630807821653,
      0.030034561856416975400,   0.029378382638821157273,
      0.028686009387528311782,   0.027958295102866762356,
      0.027196136325075122801,   0.026400472029745222368,
      0.025572282470976441631,   0.024712587973663149080,
      0.023822447676397862437,   0.022902958226530883646,
      0.021955252428981760459,   0.020980497850447824836,
      0.019979895380698184259,   0.018954677752674151880,
      0.017906108023132139125,   0.016835478015548680809,
      0.015744106726931328456,   0.014633338699983519211,
      0.013504542361621505248,   0.012359108327817702628,
      0.011198447672339711750,   0.010023990150963538754,
      0.0088371823565781745678,  0.0076394857323086816201,
      0.0064323742053852988990,  0.0052173305404752013789,
      0.0039958371181095491396,  0.0027693321909186197771,
      0.0015387690406947879013,  0.00024968789013732833958};
  IntegratorXX::GaussLobatto<double, double> quad(90);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 90; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("95 point GaussLobatto", "[1d-quad]") {
  std::array<double, 95> ref_pts = {-1,
                                    -0.99917805379487786174,
                                    -0.99724547284412049965,
                                    -0.99421055258717681255,
                                    -0.99007688196539015187,
                                    -0.98484907056605304189,
                                    -0.97853290741726081879,
                                    -0.97113537681958177940,
                                    -0.96266465561407332104,
                                    -0.95313010563421030662,
                                    -0.94254226389666987526,
                                    -0.93091283117850991563,
                                    -0.91825465918816517322,
                                    -0.90458173641349880345,
                                    -0.88990917268996300382,
                                    -0.87425318251782876238,
                                    -0.85763106715248581334,
                                    -0.84006119549036995960,
                                    -0.82156298377308777391,
                                    -0.80215687413295936274,
                                    -0.78186431200413872066,
                                    -0.76070772242453944826,
                                    -0.73871048525491502746,
                                    -0.71589690934257886056,
                                    -0.69229220565837929808,
                                    -0.66792245943665728877,
                                    -0.64281460134900211775,
                                    -0.61699637774367948608,
                                    -0.59049631998363284866,
                                    -0.56334371291695119081,
                                    -0.53556856251465249274,
                                    -0.50720156271155051369,
                                    -0.47827406148685193331,
                                    -0.44881802622197016572,
                                    -0.41886600837384026837,
                                    -0.38845110750277534260,
                                    -0.35760693469461777814,
                                    -0.32636757541760780634,
                                    -0.29476755185501633172,
                                    -0.26284178475516820151,
                                    -0.23062555484101529611,
                                    -0.19815446382190548132,
                                    -0.16546439505063301219,
                                    -0.13259147386924792804,
                                    -0.099572027687445891730,
                                    -0.066442545837655422247,
                                    -0.033239639251186218400,
                                    0,
                                    0.033239639251186218400,
                                    0.066442545837655422247,
                                    0.099572027687445891730,
                                    0.13259147386924792804,
                                    0.16546439505063301219,
                                    0.19815446382190548132,
                                    0.23062555484101529611,
                                    0.26284178475516820151,
                                    0.29476755185501633172,
                                    0.32636757541760780634,
                                    0.35760693469461777814,
                                    0.38845110750277534260,
                                    0.41886600837384026837,
                                    0.44881802622197016572,
                                    0.47827406148685193331,
                                    0.50720156271155051369,
                                    0.53556856251465249274,
                                    0.56334371291695119081,
                                    0.59049631998363284866,
                                    0.61699637774367948608,
                                    0.64281460134900211775,
                                    0.66792245943665728877,
                                    0.69229220565837929808,
                                    0.71589690934257886056,
                                    0.73871048525491502746,
                                    0.76070772242453944826,
                                    0.78186431200413872066,
                                    0.80215687413295936274,
                                    0.82156298377308777391,
                                    0.84006119549036995960,
                                    0.85763106715248581334,
                                    0.87425318251782876238,
                                    0.88990917268996300382,
                                    0.90458173641349880345,
                                    0.91825465918816517322,
                                    0.93091283117850991563,
                                    0.94254226389666987526,
                                    0.95313010563421030662,
                                    0.96266465561407332104,
                                    0.97113537681958177940,
                                    0.97853290741726081879,
                                    0.98484907056605304189,
                                    0.99007688196539015187,
                                    0.99421055258717681255,
                                    0.99724547284412049965,
                                    0.99917805379487786174,
                                    1};
  std::array<double, 95> ref_wgt = {
      0.00022396416573348264278, 0.0013802830872701997583,
      0.0024842880359858384050,  0.0035849678347405860210,
      0.0046816064245466520032,  0.0057730516789039670546,
      0.0068581105040337929549,  0.0079355877544814374410,
      0.0090042941862899669580,  0.010063049413203391560,
      0.011110683718378111758,   0.012146039530575962871,
      0.013167972778206395744,   0.014175354187115519765,
      0.015167070544696044778,   0.016142025938386090901,
      0.017099142971240733529,   0.018037363955091447999,
      0.018955652080878197438,   0.019852992565322322880,
      0.020728393772919255169,   0.021580888312147571172,
      0.022409534104761163846,   0.023213415427029023931,
      0.023991643921799967997,   0.024743359580291288559,
      0.025467731692527413162,   0.026163959765385414600,
      0.026831274407237577265,   0.027468938178216584020,
      0.028076246405165868459,   0.028652527960376036482,
      0.029197146003247833337,   0.029709498684062797373,
      0.030189019809084406168,   0.030635179466255107440,
      0.031047484610798068643,   0.031425479610076714063,
      0.031768746747110088583,   0.032076906682187737339,
      0.032349618872074065544,   0.032586581946338988775,
      0.032787534040399047207,   0.032952253084900983850,
      0.033080557051128022829,   0.033172304152157675236,
      0.033227392999548792641,   0.033245762715384727697,
      0.033227392999548792641,   0.033172304152157675236,
      0.033080557051128022829,   0.032952253084900983850,
      0.032787534040399047207,   0.032586581946338988775,
      0.032349618872074065544,   0.032076906682187737339,
      0.031768746747110088583,   0.031425479610076714063,
      0.031047484610798068643,   0.030635179466255107440,
      0.030189019809084406168,   0.029709498684062797373,
      0.029197146003247833337,   0.028652527960376036482,
      0.028076246405165868459,   0.027468938178216584020,
      0.026831274407237577265,   0.026163959765385414600,
      0.025467731692527413162,   0.024743359580291288559,
      0.023991643921799967997,   0.023213415427029023931,
      0.022409534104761163846,   0.021580888312147571172,
      0.020728393772919255169,   0.019852992565322322880,
      0.018955652080878197438,   0.018037363955091447999,
      0.017099142971240733529,   0.016142025938386090901,
      0.015167070544696044778,   0.014175354187115519765,
      0.013167972778206395744,   0.012146039530575962871,
      0.011110683718378111758,   0.010063049413203391560,
      0.0090042941862899669580,  0.0079355877544814374410,
      0.0068581105040337929549,  0.0057730516789039670546,
      0.0046816064245466520032,  0.0035849678347405860210,
      0.0024842880359858384050,  0.0013802830872701997583,
      0.00022396416573348264278};
  IntegratorXX::GaussLobatto<double, double> quad(95);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 95; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("100 point GaussLobatto", "[1d-quad]") {
  std::array<double, 100> ref_pts = {-1,
                                     -0.99925857796524492281,
                                     -0.99751524903712861019,
                                     -0.99477730719045528218,
                                     -0.99104769371292829546,
                                     -0.98633016381681099006,
                                     -0.98062943072201649401,
                                     -0.97395118100766038933,
                                     -0.96630207344081899866,
                                     -0.95768973368097411946,
                                     -0.94812274716235324466,
                                     -0.93761065073551865215,
                                     -0.92616392325222888998,
                                     -0.91379397516524176172,
                                     -0.90051313717814936409,
                                     -0.88633464796729654306,
                                     -0.87127264099304026745,
                                     -0.85534213041599032839,
                                     -0.83855899613357534773,
                                     -0.82093996795256403871,
                                     -0.80250260891372504658,
                                     -0.78326529778548670983,
                                     -0.76324721074419237468,
                                     -0.74246830225930305894,
                                     -0.72094928520265911248,
                                     -0.69871161020166595468,
                                     -0.67577744425701006111,
                                     -0.65216964864623643813,
                                     -0.62791175613522542156,
                                     -0.60302794752029303000,
                                     -0.57754302752430398215,
                                     -0.55148240007082879505,
                                     -0.52487204296099522741,
                                     -0.49773848197827894199,
                                     -0.47010876444704793455,
                                     -0.44201043227121937667,
                                     -0.41347149447990545606,
                                     -0.38452039930741602179,
                                     -0.35518600583544984189,
                                     -0.32549755522574257831,
                                     -0.29548464157184773340,
                                     -0.26517718239910640862,
                                     -0.23460538884221235546,
                                     -0.20379973553010013737,
                                     -0.17279093020817593630,
                                     -0.14160988312817233549,
                                     -0.11028767623614002843,
                                     -0.078855532189290610718,
                                     -0.047344783232575205450,
                                     -0.015786839966023482370,
                                     0.015786839966023482370,
                                     0.047344783232575205450,
                                     0.078855532189290610718,
                                     0.11028767623614002843,
                                     0.14160988312817233549,
                                     0.17279093020817593630,
                                     0.20379973553010013737,
                                     0.23460538884221235546,
                                     0.26517718239910640862,
                                     0.29548464157184773340,
                                     0.32549755522574257831,
                                     0.35518600583544984189,
                                     0.38452039930741602179,
                                     0.41347149447990545606,
                                     0.44201043227121937667,
                                     0.47010876444704793455,
                                     0.49773848197827894199,
                                     0.52487204296099522741,
                                     0.55148240007082879505,
                                     0.57754302752430398215,
                                     0.60302794752029303000,
                                     0.62791175613522542156,
                                     0.65216964864623643813,
                                     0.67577744425701006111,
                                     0.69871161020166595468,
                                     0.72094928520265911248,
                                     0.74246830225930305894,
                                     0.76324721074419237468,
                                     0.78326529778548670983,
                                     0.80250260891372504658,
                                     0.82093996795256403871,
                                     0.83855899613357534773,
                                     0.85534213041599032839,
                                     0.87127264099304026745,
                                     0.88633464796729654306,
                                     0.90051313717814936409,
                                     0.91379397516524176172,
                                     0.92616392325222888998,
                                     0.93761065073551865215,
                                     0.94812274716235324466,
                                     0.95768973368097411946,
                                     0.96630207344081899866,
                                     0.97395118100766038933,
                                     0.98062943072201649401,
                                     0.98633016381681099006,
                                     0.99104769371292829546,
                                     0.99477730719045528218,
                                     0.99751524903712861019,
                                     0.99925857796524492281,
                                     1};
  std::array<double, 100> ref_wgt = {
      0.00020202020202020202020, 0.0012450766591352942893,
      0.0022410797550829630450,  0.0032343259236349601274,
      0.0042242763316545074348,  0.0052099980705850798667,
      0.0061905203191467993692,  0.0071648692230117860388,
      0.0081320748477389990538,  0.0090911736265803263805,
      0.010041209778500831941,   0.010981236426462550781,
      0.011910316608771469478,   0.012827524243262733436,
      0.013731945065015462698,   0.014622677545198368306,
      0.015498833793784865807,   0.016359540446913776030,
      0.017203939538825604536,   0.018031189357921348572,
      0.018840465286312474030,   0.019630960622148179418,
      0.020401887383970712731,   0.021152477096338553971,
      0.021881981555959572786,   0.022589673577586142378,
      0.023274847718938643155,   0.023936820983941188731,
      0.024574933503572831284,   0.025188549193658416299,
      0.025777056388945333874,   0.026339868452835451554,
      0.026876424362165378012,   0.027386189266452805112,
      0.027868655021051939597,   0.028323340693686911759,
      0.028749793043858492721,   0.029147586974646425933,
      0.029516325956457147251,   0.029855642422294598437,
      0.030165198134160199712,   0.030444684520216807012,
      0.030693822982380608454,   0.030912365174034381835,
      0.031100093247585310487,   0.031256820071620608072,
      0.031382389417444503601,   0.031476676114810655384,
      0.031539586176694766221,   0.031571056892983030979,
      0.031571056892983030979,   0.031539586176694766221,
      0.031476676114810655384,   0.031382389417444503601,
      0.031256820071620608072,   0.031100093247585310487,
      0.030912365174034381835,   0.030693822982380608454,
      0.030444684520216807012,   0.030165198134160199712,
      0.029855642422294598437,   0.029516325956457147251,
      0.029147586974646425933,   0.028749793043858492721,
      0.028323340693686911759,   0.027868655021051939597,
      0.027386189266452805112,   0.026876424362165378012,
      0.026339868452835451554,   0.025777056388945333874,
      0.025188549193658416299,   0.024574933503572831284,
      0.023936820983941188731,   0.023274847718938643155,
      0.022589673577586142378,   0.021881981555959572786,
      0.021152477096338553971,   0.020401887383970712731,
      0.019630960622148179418,   0.018840465286312474030,
      0.018031189357921348572,   0.017203939538825604536,
      0.016359540446913776030,   0.015498833793784865807,
      0.014622677545198368306,   0.013731945065015462698,
      0.012827524243262733436,   0.011910316608771469478,
      0.010981236426462550781,   0.010041209778500831941,
      0.0090911736265803263805,  0.0081320748477389990538,
      0.0071648692230117860388,  0.0061905203191467993692,
      0.0052099980705850798667,  0.0042242763316545074348,
      0.0032343259236349601274,  0.0022410797550829630450,
      0.0012450766591352942893,  0.00020202020202020202020};
  IntegratorXX::GaussLobatto<double, double> quad(100);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 100; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("105 point GaussLobatto", "[1d-quad]") {
  std::array<double, 105> ref_pts = {-1,
                                     -0.99932782391254231689,
                                     -0.99774725398131411097,
                                     -0.99526475576297836009,
                                     -0.99188276497625806627,
                                     -0.98760437194872914418,
                                     -0.98243345283878579550,
                                     -0.97637468430870585820,
                                     -0.96943354337508953812,
                                     -0.96161630367570360652,
                                     -0.95293003023836428011,
                                     -0.94338257327716190716,
                                     -0.93298256118089728292,
                                     -0.92173939275652429054,
                                     -0.90966322875701878840,
                                     -0.89676498271106246364,
                                     -0.88305631106737759473,
                                     -0.86854960266487949358,
                                     -0.85325796753934535736,
                                     -0.83719522507736229383,
                                     -0.82037589152862809823,
                                     -0.80281516688810674556,
                                     -0.78452892116002479195,
                                     -0.76553368001620399475,
                                     -0.74584660986174320445,
                                     -0.72548550232158001330,
                                     -0.70446875816197460955,
                                     -0.68281537066146165187,
                                     -0.66054490844630873018,
                                     -0.63767749780600073941,
                                     -0.61423380450473725746,
                                     -0.59023501510538400861,
                                     -0.56570281782275907435,
                                     -0.54065938292355914116,
                                     -0.51512734269064027069,
                                     -0.48912977096976100791,
                                     -0.46269016231727270984,
                                     -0.43583241076760241031,
                                     -0.40858078823971699003,
                                     -0.38095992260208357008,
                                     -0.35299477541594958794,
                                     -0.32471061937705666031,
                                     -0.29613301547617482019,
                                     -0.26728778989909778605,
                                     -0.23820101068697534623,
                                     -0.20889896417807550748,
                                     -0.17940813125226656555,
                                     -0.14975516339968752749,
                                     -0.11996685863523418996,
                                     -0.090070137280627508100,
                                     -0.060092017635950552250,
                                     -0.030059591562640234071,
                                     0,
                                     0.030059591562640234071,
                                     0.060092017635950552250,
                                     0.090070137280627508100,
                                     0.11996685863523418996,
                                     0.14975516339968752749,
                                     0.17940813125226656555,
                                     0.20889896417807550748,
                                     0.23820101068697534623,
                                     0.26728778989909778605,
                                     0.29613301547617482019,
                                     0.32471061937705666031,
                                     0.35299477541594958794,
                                     0.38095992260208357008,
                                     0.40858078823971699003,
                                     0.43583241076760241031,
                                     0.46269016231727270984,
                                     0.48912977096976100791,
                                     0.51512734269064027069,
                                     0.54065938292355914116,
                                     0.56570281782275907435,
                                     0.59023501510538400861,
                                     0.61423380450473725746,
                                     0.63767749780600073941,
                                     0.66054490844630873018,
                                     0.68281537066146165187,
                                     0.70446875816197460955,
                                     0.72548550232158001330,
                                     0.74584660986174320445,
                                     0.76553368001620399475,
                                     0.78452892116002479195,
                                     0.80281516688810674556,
                                     0.82037589152862809823,
                                     0.83719522507736229383,
                                     0.85325796753934535736,
                                     0.86854960266487949358,
                                     0.88305631106737759473,
                                     0.89676498271106246364,
                                     0.90966322875701878840,
                                     0.92173939275652429054,
                                     0.93298256118089728292,
                                     0.94338257327716190716,
                                     0.95293003023836428011,
                                     0.96161630367570360652,
                                     0.96943354337508953812,
                                     0.97637468430870585820,
                                     0.98243345283878579550,
                                     0.98760437194872914418,
                                     0.99188276497625806627,
                                     0.99526475576297836009,
                                     0.99774725398131411097,
                                     0.99932782391254231689,
                                     1};
  std::array<double, 105> ref_wgt = {
      0.00018315018315018315018, 0.0011288043522096297711,
      0.0020319054287259699139,  0.0029326961225347243672,
      0.0038307714660274377952,  0.0047253687081835660588,
      0.0056156900499521210497,  0.0065009341084636851632,
      0.0073803020643347673336,  0.0082529997260840139124,
      0.0091182386625912897604,  0.0099752370656740799008,
      0.010823220517788397901,   0.011661422719260091218,
      0.012489086194016707132,   0.013305462980919484674,
      0.014109815313383311294,   0.014901416288189501959,
      0.015679550523625233356,   0.016443514806731989728,
      0.017192618729279264536,   0.017926185312000241281,
      0.018643551616589186833,   0.019344069344945188747,
      0.020027105425143553565,   0.020692042583619517708,
      0.021338279903056198414,   0.021965233365478454868,
      0.022572336380065711170,   0.023159040295209333789,
      0.023724814894353570379,   0.024269148875173167555,
      0.024791550311655479095,   0.025291547098670077256,
      0.025768687378624535129,   0.026222539949821117587,
      0.026652694656145571340,   0.027058762757736015004,
      0.027440377282297075380,   0.027797193356741875851,
      0.028128888518862237770,   0.028435163008745487368,
      0.028715740039674551377,   0.028970366048266556167,
      0.029198810923623900523,   0.029400868215290733376,
      0.029576355319826917498,   0.029725113645830880573,
      0.029847008757262228633,   0.029941930494934605656,
      0.030009793076069009452,   0.030050535171817599759,
      0.030064119962687941849,   0.030050535171817599759,
      0.030009793076069009452,   0.029941930494934605656,
      0.029847008757262228633,   0.029725113645830880573,
      0.029576355319826917498,   0.029400868215290733376,
      0.029198810923623900523,   0.028970366048266556167,
      0.028715740039674551377,   0.028435163008745487368,
      0.028128888518862237770,   0.027797193356741875851,
      0.027440377282297075380,   0.027058762757736015004,
      0.026652694656145571340,   0.026222539949821117587,
      0.025768687378624535129,   0.025291547098670077256,
      0.024791550311655479095,   0.024269148875173167555,
      0.023724814894353570379,   0.023159040295209333789,
      0.022572336380065711170,   0.021965233365478454868,
      0.021338279903056198414,   0.020692042583619517708,
      0.020027105425143553565,   0.019344069344945188747,
      0.018643551616589186833,   0.017926185312000241281,
      0.017192618729279264536,   0.016443514806731989728,
      0.015679550523625233356,   0.014901416288189501959,
      0.014109815313383311294,   0.013305462980919484674,
      0.012489086194016707132,   0.011661422719260091218,
      0.010823220517788397901,   0.0099752370656740799008,
      0.0091182386625912897604,  0.0082529997260840139124,
      0.0073803020643347673336,  0.0065009341084636851632,
      0.0056156900499521210497,  0.0047253687081835660588,
      0.0038307714660274377952,  0.0029326961225347243672,
      0.0020319054287259699139,  0.0011288043522096297711,
      0.00018315018315018315018};
  IntegratorXX::GaussLobatto<double, double> quad(105);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 105; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("110 point GaussLobatto", "[1d-quad]") {
  std::array<double, 110> ref_pts = {-1,
                                     -0.99938780348067124893,
                                     -0.99794822259126990191,
                                     -0.99568702983017628497,
                                     -0.99260626140927179294,
                                     -0.98870848396404268347,
                                     -0.98399691449330013034,
                                     -0.97847543426454706916,
                                     -0.97214858933212516538,
                                     -0.96502158790330583555,
                                     -0.95710029645083317988,
                                     -0.94839123504920339354,
                                     -0.93890157208355591630,
                                     -0.92863911838694484831,
                                     -0.91761232083122327773,
                                     -0.90583025538567785752,
                                     -0.89330261965326863673,
                                     -0.88003972489267519644,
                                     -0.86605248753379239929,
                                     -0.85135242019424833566,
                                     -0.83595162220467366042,
                                     -0.81986276965071792844,
                                     -0.80309910494012868184,
                                     -0.78567442590355486381,
                                     -0.76760307443809296169,
                                     -0.74889992470295411068,
                                     -0.72958037087698865317,
                                     -0.70966031448815862353,
                                     -0.68915615132539660231,
                                     -0.66808475794363022216,
                                     -0.64646347777308451054,
                                     -0.62431010684429862433,
                                     -0.60164287914060889607,
                                     -0.57848045159015607911,
                                     -0.55484188870977091014,
                                     -0.53074664691337830136,
                                     -0.50621455849783635579,
                                     -0.48126581531939171453,
                                     -0.45592095217418725763,
                                     -0.43020082989650166738,
                                     -0.40412661818863261581,
                                     -0.37771977819655615896,
                                     -0.35100204484570412194,
                                     -0.32399540895139866686,
                                     -0.29672209911866868383,
                                     -0.26920456344634597996,
                                     -0.24146545105050031835,
                                     -0.21352759342242104446,
                                     -0.18541398563648920868,
                                     -0.15714776742340763749,
                                     -0.12875220412436722076,
                                     -0.10025066754182567641,
                                     -0.071666616702660145670,
                                     -0.043023578549527092802,
                                     -0.014345128576322071441,
                                     0.014345128576322071441,
                                     0.043023578549527092802,
                                     0.071666616702660145670,
                                     0.10025066754182567641,
                                     0.12875220412436722076,
                                     0.15714776742340763749,
                                     0.18541398563648920868,
                                     0.21352759342242104446,
                                     0.24146545105050031835,
                                     0.26920456344634597996,
                                     0.29672209911866868383,
                                     0.32399540895139866686,
                                     0.35100204484570412194,
                                     0.37771977819655615896,
                                     0.40412661818863261581,
                                     0.43020082989650166738,
                                     0.45592095217418725763,
                                     0.48126581531939171453,
                                     0.50621455849783635579,
                                     0.53074664691337830136,
                                     0.55484188870977091014,
                                     0.57848045159015607911,
                                     0.60164287914060889607,
                                     0.62431010684429862433,
                                     0.64646347777308451054,
                                     0.66808475794363022216,
                                     0.68915615132539660231,
                                     0.70966031448815862353,
                                     0.72958037087698865317,
                                     0.74889992470295411068,
                                     0.76760307443809296169,
                                     0.78567442590355486381,
                                     0.80309910494012868184,
                                     0.81986276965071792844,
                                     0.83595162220467366042,
                                     0.85135242019424833566,
                                     0.86605248753379239929,
                                     0.88003972489267519644,
                                     0.89330261965326863673,
                                     0.90583025538567785752,
                                     0.91761232083122327773,
                                     0.92863911838694484831,
                                     0.93890157208355591630,
                                     0.94839123504920339354,
                                     0.95710029645083317988,
                                     0.96502158790330583555,
                                     0.97214858933212516538,
                                     0.97847543426454706916,
                                     0.98399691449330013034,
                                     0.98870848396404268347,
                                     0.99260626140927179294,
                                     0.99568702983017628497,
                                     0.99794822259126990191,
                                     0.99938780348067124893,
                                     1};
  std::array<double, 110> ref_wgt = {
      0.00016680567139282735613, 0.0010280892444340860144,
      0.0018507001805724657013,  0.0026713560582002482944,
      0.0034897539924223925265,  0.0043052648731612613487,
      0.0051172271848864797075,  0.0059249755498807875021,
      0.0067278462147602813203,  0.0075251788194032402089,
      0.0083163173181602179343,  0.0091006106564767178150,
      0.0098774133624592094719,  0.010646086103075415627,
      0.011405996222404801402,   0.012156518268542106775,
      0.012897034511736718545,   0.013626935454724620866,
      0.014345620335505096342,   0.015052497622491737279,
      0.015746985501813386639,   0.016428512356465405774,
      0.017096517236975036077,   0.017750450323227786593,
      0.018389773377095543756,   0.019013960185506786318,
      0.019622496993602435753,   0.020214882927626140888,
      0.020790630407204435016,   0.021349265546679781792,
      0.021890328545167786283,   0.022413374065018632914,
      0.022917971598372024013,   0.023403705821504466629,
      0.023870176936677647367,   0.024317001001206813900,
      0.024743810243478524025,   0.025150253365657810094,
      0.025535995832835722825,   0.025900720148379350461,
      0.026244126115257744548,   0.026565931083128710956,
      0.026865870180983133015,   0.027143696535155372137,
      0.027399181472520329525,   0.027632114708709940012,
      0.027842304521194195360,   0.028029577907084248995,
      0.028193780725527726723,   0.028334777824579047922,
      0.028452453152440338549,   0.028546709852981380317,
      0.028617470345459979037,   0.028664676388377138653,
      0.028688289127414485094,   0.028688289127414485094,
      0.028664676388377138653,   0.028617470345459979037,
      0.028546709852981380317,   0.028452453152440338549,
      0.028334777824579047922,   0.028193780725527726723,
      0.028029577907084248995,   0.027842304521194195360,
      0.027632114708709940012,   0.027399181472520329525,
      0.027143696535155372137,   0.026865870180983133015,
      0.026565931083128710956,   0.026244126115257744548,
      0.025900720148379350461,   0.025535995832835722825,
      0.025150253365657810094,   0.024743810243478524025,
      0.024317001001206813900,   0.023870176936677647367,
      0.023403705821504466629,   0.022917971598372024013,
      0.022413374065018632914,   0.021890328545167786283,
      0.021349265546679781792,   0.020790630407204435016,
      0.020214882927626140888,   0.019622496993602435753,
      0.019013960185506786318,   0.018389773377095543756,
      0.017750450323227786593,   0.017096517236975036077,
      0.016428512356465405774,   0.015746985501813386639,
      0.015052497622491737279,   0.014345620335505096342,
      0.013626935454724620866,   0.012897034511736718545,
      0.012156518268542106775,   0.011405996222404801402,
      0.010646086103075415627,   0.0098774133624592094719,
      0.0091006106564767178150,  0.0083163173181602179343,
      0.0075251788194032402089,  0.0067278462147602813203,
      0.0059249755498807875021,  0.0051172271848864797075,
      0.0043052648731612613487,  0.0034897539924223925265,
      0.0026713560582002482944,  0.0018507001805724657013,
      0.0010280892444340860144,  0.00016680567139282735613};
  IntegratorXX::GaussLobatto<double, double> quad(110);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 110; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("115 point GaussLobatto", "[1d-quad]") {
  std::array<double, 115> ref_pts = {-1,
                                     -0.99944009914143233288,
                                     -0.99812345308125379183,
                                     -0.99605524860935352887,
                                     -0.99323720271416068403,
                                     -0.98967146500741739001,
                                     -0.98536072772894406137,
                                     -0.98030823885844556816,
                                     -0.97451780306586756040,
                                     -0.96799377986047383787,
                                     -0.96074108067429487459,
                                     -0.95276516531569917735,
                                     -0.94407203792839208681,
                                     -0.93466824250590016704,
                                     -0.92456085798357902235,
                                     -0.91375749291994285009,
                                     -0.90226627977510661434,
                                     -0.89009586879252941277,
                                     -0.87725542148964923836,
                                     -0.86375460376284785159,
                                     -0.84960357861224247520,
                                     -0.83481299849196110109,
                                     -0.81939399729176916544,
                                     -0.80335818195615163177,
                                     -0.78671762374720279271,
                                     -0.76948484915792911920,
                                     -0.75167283048282415917,
                                     -0.73329497605282640216,
                                     -0.71436512014201969558,
                                     -0.69489751255368025755,
                                     -0.67490680789351392342,
                                     -0.65440805453816151090,
                                     -0.63341668330727872869,
                                     -0.61194849584771959300,
                                     -0.59001965273856860685,
                                     -0.56764666132597678462,
                                     -0.54484636329695977449,
                                     -0.52163592200151266640,
                                     -0.49803280953258540978,
                                     -0.47405479357364494772,
                                     -0.44971992402372505836,
                                     -0.42504651941003234105,
                                     -0.40005315309833666575,
                                     -0.37475863931152659396,
                                     -0.34918201896685466252,
                                     -0.32334254534253388732,
                                     -0.29725966958447528789,
                                     -0.27095302606407655882,
                                     -0.24444241759808412883,
                                     -0.21774780054165466734,
                                     -0.19088926976583754422,
                                     -0.16388704353078674772,
                                     -0.13676144826608925341,
                                     -0.10953290326966675374,
                                     -0.082221905336768950748,
                                     -0.054849013330629237617,
                                     -0.027434832706397507645,
                                     0,
                                     0.027434832706397507645,
                                     0.054849013330629237617,
                                     0.082221905336768950748,
                                     0.10953290326966675374,
                                     0.13676144826608925341,
                                     0.16388704353078674772,
                                     0.19088926976583754422,
                                     0.21774780054165466734,
                                     0.24444241759808412883,
                                     0.27095302606407655882,
                                     0.29725966958447528789,
                                     0.32334254534253388732,
                                     0.34918201896685466252,
                                     0.37475863931152659396,
                                     0.40005315309833666575,
                                     0.42504651941003234105,
                                     0.44971992402372505836,
                                     0.47405479357364494772,
                                     0.49803280953258540978,
                                     0.52163592200151266640,
                                     0.54484636329695977449,
                                     0.56764666132597678462,
                                     0.59001965273856860685,
                                     0.61194849584771959300,
                                     0.63341668330727872869,
                                     0.65440805453816151090,
                                     0.67490680789351392342,
                                     0.69489751255368025755,
                                     0.71436512014201969558,
                                     0.73329497605282640216,
                                     0.75167283048282415917,
                                     0.76948484915792911920,
                                     0.78671762374720279271,
                                     0.80335818195615163177,
                                     0.81939399729176916544,
                                     0.83481299849196110109,
                                     0.84960357861224247520,
                                     0.86375460376284785159,
                                     0.87725542148964923836,
                                     0.89009586879252941277,
                                     0.90226627977510661434,
                                     0.91375749291994285009,
                                     0.92456085798357902235,
                                     0.93466824250590016704,
                                     0.94407203792839208681,
                                     0.95276516531569917735,
                                     0.96074108067429487459,
                                     0.96799377986047383787,
                                     0.97451780306586756040,
                                     0.98030823885844556816,
                                     0.98536072772894406137,
                                     0.98967146500741739001,
                                     0.99323720271416068403,
                                     0.99605524860935352887,
                                     0.99812345308125379183,
                                     0.99944009914143233288,
                                     1};
  std::array<double, 115> ref_wgt = {
      0.00015255530129672006102, 0.00094027497892961416533,
      0.0016926920263991283170,  0.0024434399800989259931,
      0.0031922944444129742487,  0.0039387323985088281420,
      0.0046822008313810428221,  0.0054221427642607142478,
      0.0061580021866180931234,  0.0068892255927947453029,
      0.0076152627440497294307,  0.0083355672077186752967,
      0.0090495968194818372803,  0.0097568141142804938405,
      0.010456686741902412699,   0.011148687873366675168,
      0.011832296600560318478,   0.012506998330090783236,
      0.013172285171672350427,   0.013827656321068179504,
      0.014472618437467156799,   0.015106686015104263900,
      0.015729381748897883363,   0.016340236893860184307,
      0.016938791618029064886,   0.017524595348667797371,
      0.018097207111479274563,   0.018656195862584370978,
      0.019201140813017724609,   0.019731631745498822060,
      0.020247269323241398845,   0.020747665390569707095,
      0.021232443265116066676,   0.021701238021380246525,
      0.022153696765437583158,   0.022589478900589306938,
      0.023008256383755294993,   0.023409713972416388437,
      0.023793549461920489512,   0.024159473912973881828,
      0.024507211869146585901,   0.024836501564228065004,
      0.025147095119277226034,   0.025438758729218409908,
      0.025711272838842929320,   0.025964432308083682290,
      0.026198046566438441184,   0.026411939756425582717,
      0.026605950865964278297,   0.026779933849579499717,
      0.026933757738340606187,   0.027067306738450758644,
      0.027180480318412949737,   0.027273193284707036355,
      0.027345375845920809550,   0.027396973665286827697,
      0.027427947901585466098,   0.027438275238383393462,
      0.027427947901585466098,   0.027396973665286827697,
      0.027345375845920809550,   0.027273193284707036355,
      0.027180480318412949737,   0.027067306738450758644,
      0.026933757738340606187,   0.026779933849579499717,
      0.026605950865964278297,   0.026411939756425582717,
      0.026198046566438441184,   0.025964432308083682290,
      0.025711272838842929320,   0.025438758729218409908,
      0.025147095119277226034,   0.024836501564228065004,
      0.024507211869146585901,   0.024159473912973881828,
      0.023793549461920489512,   0.023409713972416388437,
      0.023008256383755294993,   0.022589478900589306938,
      0.022153696765437583158,   0.021701238021380246525,
      0.021232443265116066676,   0.020747665390569707095,
      0.020247269323241398845,   0.019731631745498822060,
      0.019201140813017724609,   0.018656195862584370978,
      0.018097207111479274563,   0.017524595348667797371,
      0.016938791618029064886,   0.016340236893860184307,
      0.015729381748897883363,   0.015106686015104263900,
      0.014472618437467156799,   0.013827656321068179504,
      0.013172285171672350427,   0.012506998330090783236,
      0.011832296600560318478,   0.011148687873366675168,
      0.010456686741902412699,   0.0097568141142804938405,
      0.0090495968194818372803,  0.0083355672077186752967,
      0.0076152627440497294307,  0.0068892255927947453029,
      0.0061580021866180931234,  0.0054221427642607142478,
      0.0046822008313810428221,  0.0039387323985088281420,
      0.0031922944444129742487,  0.0024434399800989259931,
      0.0016926920263991283170,  0.00094027497892961416533,
      0.00015255530129672006102};
  IntegratorXX::GaussLobatto<double, double> quad(115);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 115; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("120 point GaussLobatto", "[1d-quad]") {
  std::array<double, 120> ref_pts = {-1,
                                     -0.99948596944100789186,
                                     -0.99827715961158603151,
                                     -0.99637825779410416468,
                                     -0.99379072330008981587,
                                     -0.99051637032334861012,
                                     -0.98655746916168159212,
                                     -0.98191675854549959711,
                                     -0.97659744686206124576,
                                     -0.97060321086819583994,
                                     -0.96393819348450311919,
                                     -0.95660700107056615870,
                                     -0.94861470030481941323,
                                     -0.93996681471438822396,
                                     -0.93066932087442832982,
                                     -0.92072864428703072653,
                                     -0.91015165494601623019,
                                     -0.89894566259241196384,
                                     -0.88711841166479238733,
                                     -0.87467807594846907972,
                                     -0.86163325292750836476,
                                     -0.84799295784364550023,
                                     -0.83376661746630158856,
                                     -0.81896406357807118770,
                                     -0.80359552618022262409,
                                     -0.78767162642293263874,
                                     -0.77120336926515852874,
                                     -0.75420213586923221320,
                                     -0.73667967573544034028,
                                     -0.71864809858203182177,
                                     -0.70011986597626847756,
                                     -0.68110778272230540127,
                                     -0.66162498801185493030,
                                     -0.64168494634375149214,
                                     -0.62130143821869391739,
                                     -0.60048855061559690086,
                                     -0.57926066725613401460,
                                     -0.55763245866420090498,
                                     -0.53561887202716892301,
                                     -0.51323512086593633439,
                                     -0.49049667452091633157,
                                     -0.46741924746122822650,
                                     -0.44401878842448034970,
                                     -0.42031146939465022961,
                                     -0.39631367442567949444,
                                     -0.37204198831850754732,
                                     -0.34751318515936933987,
                                     -0.32274421672727843808,
                                     -0.29775220077870697180,
                                     -0.27255440921755892079,
                                     -0.24716825615861245827,
                                     -0.22161128589268069169,
                                     -0.19590116076180805892,
                                     -0.17005564895288180931,
                                     -0.14409261221809437962,
                                     -0.11802999353074302645,
                                     -0.091885804684897762942,
                                     -0.065678113847507439270,
                                     -0.039425033071546675052,
                                     -0.013144705778833275628,
                                     0.013144705778833275628,
                                     0.039425033071546675052,
                                     0.065678113847507439270,
                                     0.091885804684897762942,
                                     0.11802999353074302645,
                                     0.14409261221809437962,
                                     0.17005564895288180931,
                                     0.19590116076180805892,
                                     0.22161128589268069169,
                                     0.24716825615861245827,
                                     0.27255440921755892079,
                                     0.29775220077870697180,
                                     0.32274421672727843808,
                                     0.34751318515936933987,
                                     0.37204198831850754732,
                                     0.39631367442567949444,
                                     0.42031146939465022961,
                                     0.44401878842448034970,
                                     0.46741924746122822650,
                                     0.49049667452091633157,
                                     0.51323512086593633439,
                                     0.53561887202716892301,
                                     0.55763245866420090498,
                                     0.57926066725613401460,
                                     0.60048855061559690086,
                                     0.62130143821869391739,
                                     0.64168494634375149214,
                                     0.66162498801185493030,
                                     0.68110778272230540127,
                                     0.70011986597626847756,
                                     0.71864809858203182177,
                                     0.73667967573544034028,
                                     0.75420213586923221320,
                                     0.77120336926515852874,
                                     0.78767162642293263874,
                                     0.80359552618022262409,
                                     0.81896406357807118770,
                                     0.83376661746630158856,
                                     0.84799295784364550023,
                                     0.86163325292750836476,
                                     0.87467807594846907972,
                                     0.88711841166479238733,
                                     0.89894566259241196384,
                                     0.91015165494601623019,
                                     0.92072864428703072653,
                                     0.93066932087442832982,
                                     0.93996681471438822396,
                                     0.94861470030481941323,
                                     0.95660700107056615870,
                                     0.96393819348450311919,
                                     0.97060321086819583994,
                                     0.97659744686206124576,
                                     0.98191675854549959711,
                                     0.98655746916168159212,
                                     0.99051637032334861012,
                                     0.99379072330008981587,
                                     0.99637825779410416468,
                                     0.99827715961158603151,
                                     0.99948596944100789186,
                                     1};
  std::array<double, 120> ref_wgt = {
      0.00014005602240896358543, 0.00086324884440274917640,
      0.0015540847615370483476,  0.0022434841290435047167,
      0.0029312833259709171689,  0.0036170443743203818399,
      0.0043003015024654837595,  0.0049805849746196983119,
      0.0056574255619640731306,  0.0063303558933474843073,
      0.0069989110953464480058,  0.0076626292282443961869,
      0.0083210516520284497971,  0.0089737233642754115122,
      0.0096201933246980304669,  0.010260014772041834935,
      0.010892745535645570812,   0.011517948342610941919,
      0.012135191120933571716,   0.012744047298673886989,
      0.013344096099114886336,   0.013934922831787973569,
      0.014516119179214520670,   0.015087283479193796383,
      0.015648021002459636587,   0.016197944225524817768,
      0.016736673098531460629,   0.017263835307926815986,
      0.017779066533785842862,   0.018282010701604719482,
      0.018772320228392619615,   0.019249656262892611561,
      0.019713688919766315751,   0.020164097507580938983,
      0.020600570750441455885,   0.021022807003115008845,
      0.021430514459499030857,   0.021823411354289149943,
      0.022201226157707600361,   0.022563697763157637594,
      0.022910575667674325243,   0.023241620145047027282,
      0.023556602411493993886,   0.023855304783774568969,
      0.024137520829629768259,   0.024403055510447274389,
      0.024651725316052265849,   0.024883358391530935951,
      0.025097794655999062164,   0.025294885913233551392,
      0.025474495954090509025,   0.025636500650639054931,
      0.025780788041945834023,   0.025907258411450938590,
      0.026015824355881770230,   0.026106410845657216929,
      0.026178955276740401495,   0.026233407513904167164,
      0.026269729925379400559,   0.026287897408862247320,
      0.026287897408862247320,   0.026269729925379400559,
      0.026233407513904167164,   0.026178955276740401495,
      0.026106410845657216929,   0.026015824355881770230,
      0.025907258411450938590,   0.025780788041945834023,
      0.025636500650639054931,   0.025474495954090509025,
      0.025294885913233551392,   0.025097794655999062164,
      0.024883358391530935951,   0.024651725316052265849,
      0.024403055510447274389,   0.024137520829629768259,
      0.023855304783774568969,   0.023556602411493993886,
      0.023241620145047027282,   0.022910575667674325243,
      0.022563697763157637594,   0.022201226157707600361,
      0.021823411354289149943,   0.021430514459499030857,
      0.021022807003115008845,   0.020600570750441455885,
      0.020164097507580938983,   0.019713688919766315751,
      0.019249656262892611561,   0.018772320228392619615,
      0.018282010701604719482,   0.017779066533785842862,
      0.017263835307926815986,   0.016736673098531460629,
      0.016197944225524817768,   0.015648021002459636587,
      0.015087283479193796383,   0.014516119179214520670,
      0.013934922831787973569,   0.013344096099114886336,
      0.012744047298673886989,   0.012135191120933571716,
      0.011517948342610941919,   0.010892745535645570812,
      0.010260014772041834935,   0.0096201933246980304669,
      0.0089737233642754115122,  0.0083210516520284497971,
      0.0076626292282443961869,  0.0069989110953464480058,
      0.0063303558933474843073,  0.0056574255619640731306,
      0.0049805849746196983119,  0.0043003015024654837595,
      0.0036170443743203818399,  0.0029312833259709171689,
      0.0022434841290435047167,  0.0015540847615370483476,
      0.00086324884440274917640, 0.00014005602240896358543};
  IntegratorXX::GaussLobatto<double, double> quad(120);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 120; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("140 point GaussLobatto", "[1d-quad]") {
  std::array<double, 140> ref_pts = {-1,
                                     -0.99962278911655694482,
                                     -0.99873566074908622205,
                                     -0.99734189131454910375,
                                     -0.99544229550857772062,
                                     -0.99303785574741001274,
                                     -0.99012979686346433443,
                                     -0.98671959568133234763,
                                     -0.98280898255569260572,
                                     -0.97839994117606677420,
                                     -0.97349470780668711306,
                                     -0.96809577025387910530,
                                     -0.96220586665081169639,
                                     -0.95582798409189399106,
                                     -0.94896535713007707101,
                                     -0.94162146614327935701,
                                     -0.93380003557331364060,
                                     -0.92550503203947550298,
                                     -0.91674066232841249940,
                                     -0.90751137126165605714,
                                     -0.89782183944210369758,
                                     -0.88767698088071570940,
                                     -0.87708194050470339713,
                                     -0.86604209154851839237,
                                     -0.85456303282899537368,
                                     -0.84265058590604912670,
                                     -0.83031079213037853689,
                                     -0.81754990957968332270,
                                     -0.80437440988495318578,
                                     -0.79079097494844302778,
                                     -0.77680649355500161406,
                                     -0.76242805787847432603,
                                     -0.74766295988495328433,
                                     -0.73251868763470003453,
                                     -0.71700292148461708720,
                                     -0.70112353019319483305,
                                     -0.68488856692990966170,
                                     -0.66830626519109745868,
                                     -0.65138503462437400326,
                                     -0.63413345676372010788,
                                     -0.61656028067739459913,
                                     -0.59867441853088241393,
                                     -0.58048494106712814642,
                                     -0.56200107300634730885,
                                     -0.54323218836774833894,
                                     -0.52418780571553797594,
                                     -0.50487758333162101732,
                                     -0.48531131431744263630,
                                     -0.46549892162745736933,
                                     -0.44545045303674355286,
                                     -0.42517607604531538250,
                                     -0.40468607272171686777,
                                     -0.38399083448851274629,
                                     -0.36310085685232088540,
                                     -0.34202673408105882326,
                                     -0.32077915383110387006,
                                     -0.29936889172709158994,
                                     -0.27780680589710150242,
                                     -0.25610383146600146669,
                                     -0.23427097500974343074,
                                     -0.21231930897342303062,
                                     -0.19025996605593390108,
                                     -0.16810413356406450029,
                                     -0.14586304773890074785,
                                     -0.12354798805741182009,
                                     -0.10117027151210903225,
                                     -0.078741246871678857017,
                                     -0.056272288925500777603,
                                     -0.033774792714968846382,
                                     -0.011260167754542512128,
                                     0.011260167754542512128,
                                     0.033774792714968846382,
                                     0.056272288925500777603,
                                     0.078741246871678857017,
                                     0.10117027151210903225,
                                     0.12354798805741182009,
                                     0.14586304773890074785,
                                     0.16810413356406450029,
                                     0.19025996605593390108,
                                     0.21231930897342303062,
                                     0.23427097500974343074,
                                     0.25610383146600146669,
                                     0.27780680589710150242,
                                     0.29936889172709158994,
                                     0.32077915383110387006,
                                     0.34202673408105882326,
                                     0.36310085685232088540,
                                     0.38399083448851274629,
                                     0.40468607272171686777,
                                     0.42517607604531538250,
                                     0.44545045303674355286,
                                     0.46549892162745736933,
                                     0.48531131431744263630,
                                     0.50487758333162101732,
                                     0.52418780571553797594,
                                     0.54323218836774833894,
                                     0.56200107300634730885,
                                     0.58048494106712814642,
                                     0.59867441853088241393,
                                     0.61656028067739459913,
                                     0.63413345676372010788,
                                     0.65138503462437400326,
                                     0.66830626519109745868,
                                     0.68488856692990966170,
                                     0.70112353019319483305,
                                     0.71700292148461708720,
                                     0.73251868763470003453,
                                     0.74766295988495328433,
                                     0.76242805787847432603,
                                     0.77680649355500161406,
                                     0.79079097494844302778,
                                     0.80437440988495318578,
                                     0.81754990957968332270,
                                     0.83031079213037853689,
                                     0.84265058590604912670,
                                     0.85456303282899537368,
                                     0.86604209154851839237,
                                     0.87708194050470339713,
                                     0.88767698088071570940,
                                     0.89782183944210369758,
                                     0.90751137126165605714,
                                     0.91674066232841249940,
                                     0.92550503203947550298,
                                     0.93380003557331364060,
                                     0.94162146614327935701,
                                     0.94896535713007707101,
                                     0.95582798409189399106,
                                     0.96220586665081169639,
                                     0.96809577025387910530,
                                     0.97349470780668711306,
                                     0.97839994117606677420,
                                     0.98280898255569260572,
                                     0.98671959568133234763,
                                     0.99012979686346433443,
                                     0.99303785574741001274,
                                     0.99544229550857772062,
                                     0.99734189131454910375,
                                     0.99873566074908622205,
                                     0.99962278911655694482,
                                     1};
  std::array<double, 140> ref_wgt = {
      0.00010277492291880781089, 0.00063349207682683677914,
      0.0011405819462423747674,  0.0016468273637848475709,
      0.0021522011300733332895,  0.0026564743575766425848,
      0.0031593972897957312909,  0.0036607166768508936043,
      0.0041601789463094939477,  0.0046575310848528350077,
      0.0051525209991994586564,  0.0056448977281005704027,
      0.0061344116039076715381,  0.0066208143945354888547,
      0.0071038594367558249428,  0.0075833017650935295775,
      0.0080588982381165537719,  0.0085304076629076205290,
      0.0089975909180681893270,  0.0094602110754036858973,
      0.0099180335203410086569,  0.010370826071079687729,
      0.010818359096452042469,   0.011260405632453680321,
      0.011696741497398040977,   0.012127145405644537472,
      0.012551399079847666115,   0.012969287361673428787,
      0.013380598320929075493,   0.013785123363052269750,
      0.014182657334906150161,   0.014572998628827316186,
      0.014955949284874447967,   0.015331315091226043725,
      0.015698905682676601270,   0.016058534637181467767,
      0.016410019570401524408,   0.016753182228199853407,
      0.017087848577043549185,   0.017413848892264880361,
      0.017731017844137081865,   0.018039194581721155222,
      0.018338222814441178306,   0.018627950891346772482,
      0.018908231878022543920,   0.019178923631105506088,
      0.019439888870372701138,   0.019690995248362468325,
      0.019932115417494056974,   0.020163127094651549062,
      0.020383913123199341615,   0.020594361532397740941,
      0.020794365594188538744,   0.020983823877321773480,
      0.021162640298796228395,   0.021330724172587579727,
      0.021487990255639483865,   0.021634358791094280165,
      0.021769755548741385910,   0.021894111862662870765,
      0.022007364666057119468,   0.022109456523222922483,
      0.022200335658687774385,   0.022279955983465607970,
      0.022348277118430647833,   0.022405264414795529665,
      0.022450888971683300034,   0.022485127650784385234,
      0.022507963088091096062,   0.022519383702703717518,
      0.022519383702703717518,   0.022507963088091096062,
      0.022485127650784385234,   0.022450888971683300034,
      0.022405264414795529665,   0.022348277118430647833,
      0.022279955983465607970,   0.022200335658687774385,
      0.022109456523222922483,   0.022007364666057119468,
      0.021894111862662870765,   0.021769755548741385910,
      0.021634358791094280165,   0.021487990255639483865,
      0.021330724172587579727,   0.021162640298796228395,
      0.020983823877321773480,   0.020794365594188538744,
      0.020594361532397740941,   0.020383913123199341615,
      0.020163127094651549062,   0.019932115417494056974,
      0.019690995248362468325,   0.019439888870372701138,
      0.019178923631105506088,   0.018908231878022543920,
      0.018627950891346772482,   0.018338222814441178306,
      0.018039194581721155222,   0.017731017844137081865,
      0.017413848892264880361,   0.017087848577043549185,
      0.016753182228199853407,   0.016410019570401524408,
      0.016058534637181467767,   0.015698905682676601270,
      0.015331315091226043725,   0.014955949284874447967,
      0.014572998628827316186,   0.014182657334906150161,
      0.013785123363052269750,   0.013380598320929075493,
      0.012969287361673428787,   0.012551399079847666115,
      0.012127145405644537472,   0.011696741497398040977,
      0.011260405632453680321,   0.010818359096452042469,
      0.010370826071079687729,   0.0099180335203410086569,
      0.0094602110754036858973,  0.0089975909180681893270,
      0.0085304076629076205290,  0.0080588982381165537719,
      0.0075833017650935295775,  0.0071038594367558249428,
      0.0066208143945354888547,  0.0061344116039076715381,
      0.0056448977281005704027,  0.0051525209991994586564,
      0.0046575310848528350077,  0.0041601789463094939477,
      0.0036607166768508936043,  0.0031593972897957312909,
      0.0026564743575766425848,  0.0021522011300733332895,
      0.0016468273637848475709,  0.0011405819462423747674,
      0.00063349207682683677914, 0.00010277492291880781089};
  IntegratorXX::GaussLobatto<double, double> quad(140);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 140; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("160 point GaussLobatto", "[1d-quad]") {
  std::array<double, 160> ref_pts = {-1,
                                     -0.99971145313375530267,
                                     -0.99903281207349807308,
                                     -0.99796650217409610637,
                                     -0.99651301959419720501,
                                     -0.99467294276313906591,
                                     -0.99244698967307779677,
                                     -0.98983602540009997650,
                                     -0.98684106351775027690,
                                     -0.98346326622565775567,
                                     -0.97970394408671993707,
                                     -0.97556455559629860773,
                                     -0.97104670665191568908,
                                     -0.96615214994787038403,
                                     -0.96088278430462257231,
                                     -0.95524065393737523103,
                                     -0.94922794766608932737,
                                     -0.94284699806820614781,
                                     -0.93610028057491245120,
                                     -0.92899041251157620387,
                                     -0.92152015208288274179,
                                     -0.91369239730315776570,
                                     -0.90551018487234833146,
                                     -0.89697668899813287417,
                                     -0.88809522016463953015,
                                     -0.87886922384826496340,
                                     -0.86930227918110154853,
                                     -0.85939809756249796224,
                                     -0.84916052121929631504,
                                     -0.83859352171530750776,
                                     -0.82770119841060527280,
                                     -0.81648777687123819819,
                                     -0.80495760722997782976,
                                     -0.79311516249873963347,
                                     -0.78096503683333212822,
                                     -0.76851194375120783483,
                                     -0.75576071430290780377,
                                     -0.74271629519790936350,
                                     -0.72938374688560435692,
                                     -0.71576824159215249285,
                                     -0.70187506131397152164,
                                     -0.68770959576864273914,
                                     -0.67327734030402682268,
                                     -0.65858389376640119842,
                                     -0.64363495632844602450,
                                     -0.62843632727792144043,
                                     -0.61299390276789397537,
                                     -0.59731367352938491816,
                                     -0.58140172254732802532,
                                     -0.56526422270073817319,
                                     -0.54890743436800644093,
                                     -0.53233770299825063798,
                                     -0.51556145664966345542,
                                     -0.49858520349581322244,
                                     -0.48141552930086467990,
                                     -0.46405909486469923913,
                                     -0.44652263343892587043,
                                     -0.42881294811478505763,
                                     -0.41093690918395915812,
                                     -0.39290145147331301820,
                                     -0.37471357165459880624,
                                     -0.35638032553016873861,
                                     -0.33790882529574868019,
                                     -0.31930623678133450009,
                                     -0.30057977667128155020,
                                     -0.28173670970466570549,
                                     -0.26278434585700205872,
                                     -0.24373003750441459374,
                                     -0.22458117657135696972,
                                     -0.20534519166299092960,
                                     -0.18602954518333479791,
                                     -0.16664173044030005340,
                                     -0.14718926873873904850,
                                     -0.12767970646263159840,
                                     -0.10812061214754237637,
                                     -0.088519573544484825531,
                                     -0.068884194676330631883,
                                     -0.049222092887906694442,
                                     -0.029540895890923977748,
                                     -0.0098482388048846366302,
                                     0.0098482388048846366302,
                                     0.029540895890923977748,
                                     0.049222092887906694442,
                                     0.068884194676330631883,
                                     0.088519573544484825531,
                                     0.10812061214754237637,
                                     0.12767970646263159840,
                                     0.14718926873873904850,
                                     0.16664173044030005340,
                                     0.18602954518333479791,
                                     0.20534519166299092960,
                                     0.22458117657135696972,
                                     0.24373003750441459374,
                                     0.26278434585700205872,
                                     0.28173670970466570549,
                                     0.30057977667128155020,
                                     0.31930623678133450009,
                                     0.33790882529574868019,
                                     0.35638032553016873861,
                                     0.37471357165459880624,
                                     0.39290145147331301820,
                                     0.41093690918395915812,
                                     0.42881294811478505763,
                                     0.44652263343892587043,
                                     0.46405909486469923913,
                                     0.48141552930086467990,
                                     0.49858520349581322244,
                                     0.51556145664966345542,
                                     0.53233770299825063798,
                                     0.54890743436800644093,
                                     0.56526422270073817319,
                                     0.58140172254732802532,
                                     0.59731367352938491816,
                                     0.61299390276789397537,
                                     0.62843632727792144043,
                                     0.64363495632844602450,
                                     0.65858389376640119842,
                                     0.67327734030402682268,
                                     0.68770959576864273914,
                                     0.70187506131397152164,
                                     0.71576824159215249285,
                                     0.72938374688560435692,
                                     0.74271629519790936350,
                                     0.75576071430290780377,
                                     0.76851194375120783483,
                                     0.78096503683333212822,
                                     0.79311516249873963347,
                                     0.80495760722997782976,
                                     0.81648777687123819819,
                                     0.82770119841060527280,
                                     0.83859352171530750776,
                                     0.84916052121929631504,
                                     0.85939809756249796224,
                                     0.86930227918110154853,
                                     0.87886922384826496340,
                                     0.88809522016463953015,
                                     0.89697668899813287417,
                                     0.90551018487234833146,
                                     0.91369239730315776570,
                                     0.92152015208288274179,
                                     0.92899041251157620387,
                                     0.93610028057491245120,
                                     0.94284699806820614781,
                                     0.94922794766608932737,
                                     0.95524065393737523103,
                                     0.96088278430462257231,
                                     0.96615214994787038403,
                                     0.97104670665191568908,
                                     0.97556455559629860773,
                                     0.97970394408671993707,
                                     0.98346326622565775567,
                                     0.98684106351775027690,
                                     0.98983602540009997650,
                                     0.99244698967307779677,
                                     0.99467294276313906591,
                                     0.99651301959419720501,
                                     0.99796650217409610637,
                                     0.99903281207349807308,
                                     0.99971145313375530267,
                                     1};
  std::array<double, 160> ref_wgt = {
      0.000078616352201257861635, 0.00048459592033087200889,
      0.00087255992077994839446,  0.0012599819474220856875,
      0.0016468872827636468379,   0.0020331467968542411424,
      0.0024186152208103113449,   0.0028031443968991671102,
      0.0031865856630769322909,   0.0035687904866461864312,
      0.0039496106997814546961,   0.0043288986213639649945,
      0.0047065071404988993844,   0.0050822897853198745176,
      0.0054561007854726455390,   0.0058277951315720076650,
      0.0061972286330292158461,   0.0065642579748787039644,
      0.0069287407738984831298,   0.0072905356341640558971,
      0.0076495022021004829003,   0.0080055012210589876950,
      0.0083583945854242760577,   0.0087080453942477209989,
      0.0090543180043953929639,   0.0093970780831963949601,
      0.0097361926605749369299,   0.010071530180648424476,
      0.010402960552773193551,    0.010730355202019194316,
      0.011053587119054796433,    0.011372530909422884178,
      0.011687062842189489886,    0.011997060897946351542,
      0.012302404816148957896,    0.012602976141771851259,
      0.012898658271263187030,    0.013189336497780795169,
      0.013474898055692249079,    0.013755232164321719425,
      0.014030230070926672738,    0.014299785092887766111,
      0.014563792659095589071,    0.014822150350518211186,
      0.015074757939933808638,    0.015321517430812964530,
      0.015562333095335565760,    0.015797111511527553580,
      0.016025761599503125341,    0.016248194656798331088,
      0.016464324392782360465,    0.016674066962133172692,
      0.016877340997364484910,    0.017074067640391501863,
      0.017264170573123142562,    0.017447576047068896972,
      0.017624212911948827893,    0.017794012643295619756,
      0.017956909369037966985,    0.018112839895054989631,
      0.018261743729691763126,    0.018403563107226451926,
      0.018538243010279943495,    0.018665731191159289282,
      0.018785978192126672928,    0.018898937364586042720,
      0.019004564887179965188,    0.019102819782789679488,
      0.019193663934431757655,    0.019277062100045203893,
      0.019352981926163256458,    0.019421393960464588373,
      0.019482271663199037911,    0.019535591417483436410,
      0.019581332538463539283,    0.019619477281338505993,
      0.019650010848244815999,    0.019672921393996950149,
      0.019688200030682610507,    0.019695840831110695951,
      0.019695840831110695951,    0.019688200030682610507,
      0.019672921393996950149,    0.019650010848244815999,
      0.019619477281338505993,    0.019581332538463539283,
      0.019535591417483436410,    0.019482271663199037911,
      0.019421393960464588373,    0.019352981926163256458,
      0.019277062100045203893,    0.019193663934431757655,
      0.019102819782789679488,    0.019004564887179965188,
      0.018898937364586042720,    0.018785978192126672928,
      0.018665731191159289282,    0.018538243010279943495,
      0.018403563107226451926,    0.018261743729691763126,
      0.018112839895054989631,    0.017956909369037966985,
      0.017794012643295619756,    0.017624212911948827893,
      0.017447576047068896972,    0.017264170573123142562,
      0.017074067640391501863,    0.016877340997364484910,
      0.016674066962133172692,    0.016464324392782360465,
      0.016248194656798331088,    0.016025761599503125341,
      0.015797111511527553580,    0.015562333095335565760,
      0.015321517430812964530,    0.015074757939933808638,
      0.014822150350518211186,    0.014563792659095589071,
      0.014299785092887766111,    0.014030230070926672738,
      0.013755232164321719425,    0.013474898055692249079,
      0.013189336497780795169,    0.012898658271263187030,
      0.012602976141771851259,    0.012302404816148957896,
      0.011997060897946351542,    0.011687062842189489886,
      0.011372530909422884178,    0.011053587119054796433,
      0.010730355202019194316,    0.010402960552773193551,
      0.010071530180648424476,    0.0097361926605749369299,
      0.0093970780831963949601,   0.0090543180043953929639,
      0.0087080453942477209989,   0.0083583945854242760577,
      0.0080055012210589876950,   0.0076495022021004829003,
      0.0072905356341640558971,   0.0069287407738984831298,
      0.0065642579748787039644,   0.0061972286330292158461,
      0.0058277951315720076650,   0.0054561007854726455390,
      0.0050822897853198745176,   0.0047065071404988993844,
      0.0043288986213639649945,   0.0039496106997814546961,
      0.0035687904866461864312,   0.0031865856630769322909,
      0.0028031443968991671102,   0.0024186152208103113449,
      0.0020331467968542411424,   0.0016468872827636468379,
      0.0012599819474220856875,   0.00087255992077994839446,
      0.00048459592033087200889,  0.000078616352201257861635};
  IntegratorXX::GaussLobatto<double, double> quad(160);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 160; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("180 point GaussLobatto", "[1d-quad]") {
  std::array<double, 180> ref_pts = {-1,
                                     -0.99977216925617369761,
                                     -0.99923630988091331239,
                                     -0.99839429312041741945,
                                     -0.99724644202486436341,
                                     -0.99579311969100498012,
                                     -0.99403477456327779086,
                                     -0.99197194645453847186,
                                     -0.98960526776166522049,
                                     -0.98693546368382825556,
                                     -0.98396335214880965268,
                                     -0.98068984362373564797,
                                     -0.97711594086421867430,
                                     -0.97324273862110345426,
                                     -0.96907142331249369027,
                                     -0.96460327266445378003,
                                     -0.95983965532203469992,
                                     -0.95478203043150770219,
                                     -0.94943194719433374196,
                                     -0.94379104439322402201,
                                     -0.93786104989056120842,
                                     -0.93164378009940811577,
                                     -0.92514113942731024218,
                                     -0.91835511969309013202,
                                     -0.91128779951682981484,
                                     -0.90394134368323964963,
                                     -0.89631800247861620766,
                                     -0.88842011100159745097,
                                     -0.88025008844792987905,
                                     -0.87181043736946920533,
                                     -0.86310374290764329437,
                                     -0.85413267200161341612,
                                     -0.84489997257137727908,
                                     -0.83540847267606473625,
                                     -0.82566107964768448330,
                                     -0.81566077920058746273,
                                     -0.80541063451692003528,
                                     -0.79491378530834726710,
                                     -0.78417344685433390019,
                                     -0.77319290901727771723,
                                     -0.76197553523479707360,
                                     -0.75052476148948134634,
                                     -0.73884409525641993650,
                                     -0.72693711442883225518,
                                     -0.71480746622212782179,
                                     -0.70245886605673220237,
                                     -0.68989509642002101372,
                                     -0.67712000570771061421,
                                     -0.66413750704506039021,
                                     -0.65095157708824772875,
                                     -0.63756625480628283705,
                                     -0.62398564024383652910,
                                     -0.61021389326535994387,
                                     -0.59625523228088088917,
                                     -0.58211393295386711675,
                                     -0.56779432689155232607,
                                     -0.55330080031812606581,
                                     -0.53863779273119394999,
                                     -0.52380979554191972995,
                                     -0.50882135069926576116,
                                     -0.49367704929875327441,
                                     -0.47838153017616860236,
                                     -0.46293947848664612323,
                                     -0.44735562426956316283,
                                     -0.43163474099968644123,
                                     -0.41578164412501386229,
                                     -0.39980118959175951879,
                                     -0.38369827235693372438,
                                     -0.36747782488897368299,
                                     -0.35114481565688406665,
                                     -0.33470424760835029193,
                                     -0.31816115663729066308,
                                     -0.30152061004131678476,
                                     -0.28478770496957473842,
                                     -0.26796756686144246292,
                                     -0.25106534787656158048,
                                     -0.23408622531668456382,
                                     -0.21703540003982064689,
                                     -0.19991809486716624083,
                                     -0.18273955298330782689,
                                     -0.16550503633018735860,
                                     -0.14821982399532211630,
                                     -0.13088921059477271678,
                                     -0.11351850465135458972,
                                     -0.096113026968589689291,
                                     -0.078678109000896514362,
                                     -0.061219091220517662772,
                                     -0.043741321481685144583,
                                     -0.026250153382524525246,
                                     -0.0087509446251996622480,
                                     0.0087509446251996622480,
                                     0.026250153382524525246,
                                     0.043741321481685144583,
                                     0.061219091220517662772,
                                     0.078678109000896514362,
                                     0.096113026968589689291,
                                     0.11351850465135458972,
                                     0.13088921059477271678,
                                     0.14821982399532211630,
                                     0.16550503633018735860,
                                     0.18273955298330782689,
                                     0.19991809486716624083,
                                     0.21703540003982064689,
                                     0.23408622531668456382,
                                     0.25106534787656158048,
                                     0.26796756686144246292,
                                     0.28478770496957473842,
                                     0.30152061004131678476,
                                     0.31816115663729066308,
                                     0.33470424760835029193,
                                     0.35114481565688406665,
                                     0.36747782488897368299,
                                     0.38369827235693372438,
                                     0.39980118959175951879,
                                     0.41578164412501386229,
                                     0.43163474099968644123,
                                     0.44735562426956316283,
                                     0.46293947848664612323,
                                     0.47838153017616860236,
                                     0.49367704929875327441,
                                     0.50882135069926576116,
                                     0.52380979554191972995,
                                     0.53863779273119394999,
                                     0.55330080031812606581,
                                     0.56779432689155232607,
                                     0.58211393295386711675,
                                     0.59625523228088088917,
                                     0.61021389326535994387,
                                     0.62398564024383652910,
                                     0.63756625480628283705,
                                     0.65095157708824772875,
                                     0.66413750704506039021,
                                     0.67712000570771061421,
                                     0.68989509642002101372,
                                     0.70245886605673220237,
                                     0.71480746622212782179,
                                     0.72693711442883225518,
                                     0.73884409525641993650,
                                     0.75052476148948134634,
                                     0.76197553523479707360,
                                     0.77319290901727771723,
                                     0.78417344685433390019,
                                     0.79491378530834726710,
                                     0.80541063451692003528,
                                     0.81566077920058746273,
                                     0.82566107964768448330,
                                     0.83540847267606473625,
                                     0.84489997257137727908,
                                     0.85413267200161341612,
                                     0.86310374290764329437,
                                     0.87181043736946920533,
                                     0.88025008844792987905,
                                     0.88842011100159745097,
                                     0.89631800247861620766,
                                     0.90394134368323964963,
                                     0.91128779951682981484,
                                     0.91835511969309013202,
                                     0.92514113942731024218,
                                     0.93164378009940811577,
                                     0.93786104989056120842,
                                     0.94379104439322402201,
                                     0.94943194719433374196,
                                     0.95478203043150770219,
                                     0.95983965532203469992,
                                     0.96460327266445378003,
                                     0.96907142331249369027,
                                     0.97324273862110345426,
                                     0.97711594086421867430,
                                     0.98068984362373564797,
                                     0.98396335214880965268,
                                     0.98693546368382825556,
                                     0.98960526776166522049,
                                     0.99197194645453847186,
                                     0.99403477456327779086,
                                     0.99579311969100498012,
                                     0.99724644202486436341,
                                     0.99839429312041741945,
                                     0.99923630988091331239,
                                     0.99977216925617369761,
                                     1};
  std::array<double, 180> ref_wgt = {
      0.000062073246430788330230, 0.00038263096671374093638,
      0.00068899536827799482773,  0.00099498807214151415573,
      0.0013006539791875229838,   0.0016059160145875828695,
      0.0019106842870520831715,   0.0022148665334274590192,
      0.0025183699842431747080,   0.0028211018468750357408,
      0.0031229694744214511607,   0.0034238804448876019804,
      0.0037237426101987569267,   0.0040224641336891673559,
      0.0043199535227014307859,   0.0046161196589059297837,
      0.0049108718274523637985,   0.0052041197454585220668,
      0.0054957735900773530594,   0.0057857440262613003144,
      0.0060739422342834311184,   0.0063602799370446113776,
      0.0066446694271799476839,   0.0069270235939689331490,
      0.0072072559500487772095,   0.0074852806579275333617,
      0.0077610125562919485953,   0.0080343671861039482695,
      0.0083052608164790636213,   0.0085736104703397476318,
      0.0088393339498363158080,   0.0091023498615281359822,
      0.0093625776413176415663,   0.0096199375791297347084,
      0.0098743508433291661113,   0.010125739504868518311,
      0.010374026561159473342,    0.010619135959660110235,
      0.010860992621171050180,    0.011099522462833345772,
      0.011334652420821094297,    0.011566310472721842797,
      0.011794425659597943941,    0.012018928107722116242,
      0.012239749049980559505,    0.012456820846937076325,
      0.012670077007551752895,    0.012879452209547857043,
      0.013084882319420718347,    0.013286304412082464141,
      0.013483656790136596242,    0.013676879002776506211,
      0.013865911864302141782,    0.014050697472249153836,
      0.014231179225124971747,    0.014407301839746375189,
      0.014579011368173252386,    0.014746255214233358406,
      0.014908982149633012254,    0.015067142329648798295,
      0.015220687308395465812,    0.015369570053665350273,
      0.015513744961334771071,    0.015653167869332993132,
      0.015787796071169473719,    0.015917588329015251054,
      0.016042504886334467930,    0.016162507480062161259,
      0.016277559352324587474,    0.016387625261698493816,
      0.016492671494005886753,    0.016592665872640991051,
      0.016687577768426236298,    0.016777378108994251946,
      0.016862039387692997126,    0.016941535672011297517,
      0.017015842611522208515,    0.017084937445341771565,
      0.017148799009100879019,    0.017207407741428111970,
      0.017260745689941565344,    0.017308796516747824901,
      0.017351545503446411770,    0.017388979555638161631,
      0.017421087206936157578,    0.017447858622477988107,
      0.017469285601938254380,    0.017485361582040404014,
      0.017496081638567122020,    0.017501442487868663064,
      0.017501442487868663064,    0.017496081638567122020,
      0.017485361582040404014,    0.017469285601938254380,
      0.017447858622477988107,    0.017421087206936157578,
      0.017388979555638161631,    0.017351545503446411770,
      0.017308796516747824901,    0.017260745689941565344,
      0.017207407741428111970,    0.017148799009100879019,
      0.017084937445341771565,    0.017015842611522208515,
      0.016941535672011297517,    0.016862039387692997126,
      0.016777378108994251946,    0.016687577768426236298,
      0.016592665872640991051,    0.016492671494005886753,
      0.016387625261698493816,    0.016277559352324587474,
      0.016162507480062161259,    0.016042504886334467930,
      0.015917588329015251054,    0.015787796071169473719,
      0.015653167869332993132,    0.015513744961334771071,
      0.015369570053665350273,    0.015220687308395465812,
      0.015067142329648798295,    0.014908982149633012254,
      0.014746255214233358406,    0.014579011368173252386,
      0.014407301839746375189,    0.014231179225124971747,
      0.014050697472249153836,    0.013865911864302141782,
      0.013676879002776506211,    0.013483656790136596242,
      0.013286304412082464141,    0.013084882319420718347,
      0.012879452209547857043,    0.012670077007551752895,
      0.012456820846937076325,    0.012239749049980559505,
      0.012018928107722116242,    0.011794425659597943941,
      0.011566310472721842797,    0.011334652420821094297,
      0.011099522462833345772,    0.010860992621171050180,
      0.010619135959660110235,    0.010374026561159473342,
      0.010125739504868518311,    0.0098743508433291661113,
      0.0096199375791297347084,   0.0093625776413176415663,
      0.0091023498615281359822,   0.0088393339498363158080,
      0.0085736104703397476318,   0.0083052608164790636213,
      0.0080343671861039482695,   0.0077610125562919485953,
      0.0074852806579275333617,   0.0072072559500487772095,
      0.0069270235939689331490,   0.0066446694271799476839,
      0.0063602799370446113776,   0.0060739422342834311184,
      0.0057857440262613003144,   0.0054957735900773530594,
      0.0052041197454585220668,   0.0049108718274523637985,
      0.0046161196589059297837,   0.0043199535227014307859,
      0.0040224641336891673559,   0.0037237426101987569267,
      0.0034238804448876019804,   0.0031229694744214511607,
      0.0028211018468750357408,   0.0025183699842431747080,
      0.0022148665334274590192,   0.0019106842870520831715,
      0.0016059160145875828695,   0.0013006539791875229838,
      0.00099498807214151415573,  0.00068899536827799482773,
      0.00038263096671374093638,  0.000062073246430788330230};
  IntegratorXX::GaussLobatto<double, double> quad(180);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 180; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("200 point GaussLobatto", "[1d-quad]") {
  std::array<double, 200> ref_pts = {-1,
                                     -0.99981555880264623410,
                                     -0.99938174140186838554,
                                     -0.99870003735107445262,
                                     -0.99777066842138561529,
                                     -0.99659387438045613187,
                                     -0.99516994969584302990,
                                     -0.99349924844708733213,
                                     -0.99158218535580009892,
                                     -0.98941923601631248635,
                                     -0.98701093689790951346,
                                     -0.98435788526139485790,
                                     -0.98146073903367077807,
                                     -0.97832021665583940894,
                                     -0.97493709691100423125,
                                     -0.97131221873448068280,
                                     -0.96744648100770874076,
                                     -0.96334084233653736249,
                                     -0.95899632081425947383,
                                     -0.95441399376963332222,
                                     -0.94959499750005334301,
                                     -0.94454052698999591354,
                                     -0.93925183561484570008,
                                     -0.93373023483019838308,
                                     -0.92797709384673105334,
                                     -0.92199383929073018770,
                                     -0.91578195485036755586,
                                     -0.90934298090781594832,
                                     -0.90267851415729882355,
                                     -0.89579020720917059382,
                                     -0.88867976818012714760,
                                     -0.88134896026964924417,
                                     -0.87379960132278455084,
                                     -0.86603356337937728374,
                                     -0.85805277220985763403,
                                     -0.84985920683770639260,
                                     -0.84145489904871341718,
                                     -0.83284193288715180631,
                                     -0.82402244413899284884,
                                     -0.81499861980229000122,
                                     -0.80577269754486330355,
                                     -0.79634696514941877761,
                                     -0.78672375994624045220,
                                     -0.77690546823359573270,
                                     -0.76689452468599787075,
                                     -0.75669341175047229441,
                                     -0.74630465903097652944,
                                     -0.73573084266112637578,
                                     -0.72497458466538390002,
                                     -0.71403855230886566345,
                                     -0.70292545743593242505,
                                     -0.69163805579772433921,
                                     -0.68017914636880840769,
                                     -0.66855157065310764449,
                                     -0.65675821197928406889,
                                     -0.64480199478575025665,
                                     -0.63268588389548675058,
                                     -0.62041288378084515896,
                                     -0.60798603781851925336,
                                     -0.59540842753486881488,
                                     -0.58268317184178337022,
                                     -0.56981342626327530408,
                                     -0.55680238215299413365,
                                     -0.54365326590285598150,
                                     -0.53036933814298448678,
                                     -0.51695389293316154866,
                                     -0.50341025694598840128,
                                     -0.48974178864195957521,
                                     -0.47595187743665430538,
                                     -0.46204394286025190039,
                                     -0.44802143370957949116,
                                     -0.43388782719290242904,
                                     -0.41964662806766940260,
                                     -0.40530136777142608966,
                                     -0.39085560354611285513,
                                     -0.37631291755596364545,
                                     -0.36167691599922481754,
                                     -0.34695122821391417233,
                                     -0.33213950577784194102,
                                     -0.31724542160311689489,
                                     -0.30227266902536211716,
                                     -0.28722496088786628714,
                                     -0.27210602862089758293,
                                     -0.25691962131640850815,
                                     -0.24166950479836109151,
                                     -0.22635946068890299364,
                                     -0.21099328547062608481,
                                     -0.19557478954514002837,
                                     -0.18010779628819431860,
                                     -0.16459614110158307762,
                                     -0.14904367046206771358,
                                     -0.13345424096755328216,
                                     -0.11783171838075507407,
                                     -0.10217997667059257391,
                                     -0.086502897051548498930,
                                     -0.070804367021231131386,
                                     -0.055088279396378603033,
                                     -0.039358531347544177257,
                                     -0.023619023432701901052,
                                     -0.0078736586300122669269,
                                     0.0078736586300122669269,
                                     0.023619023432701901052,
                                     0.039358531347544177257,
                                     0.055088279396378603033,
                                     0.070804367021231131386,
                                     0.086502897051548498930,
                                     0.10217997667059257391,
                                     0.11783171838075507407,
                                     0.13345424096755328216,
                                     0.14904367046206771358,
                                     0.16459614110158307762,
                                     0.18010779628819431860,
                                     0.19557478954514002837,
                                     0.21099328547062608481,
                                     0.22635946068890299364,
                                     0.24166950479836109151,
                                     0.25691962131640850815,
                                     0.27210602862089758293,
                                     0.28722496088786628714,
                                     0.30227266902536211716,
                                     0.31724542160311689489,
                                     0.33213950577784194102,
                                     0.34695122821391417233,
                                     0.36167691599922481754,
                                     0.37631291755596364545,
                                     0.39085560354611285513,
                                     0.40530136777142608966,
                                     0.41964662806766940260,
                                     0.43388782719290242904,
                                     0.44802143370957949116,
                                     0.46204394286025190039,
                                     0.47595187743665430538,
                                     0.48974178864195957521,
                                     0.50341025694598840128,
                                     0.51695389293316154866,
                                     0.53036933814298448678,
                                     0.54365326590285598150,
                                     0.55680238215299413365,
                                     0.56981342626327530408,
                                     0.58268317184178337022,
                                     0.59540842753486881488,
                                     0.60798603781851925336,
                                     0.62041288378084515896,
                                     0.63268588389548675058,
                                     0.64480199478575025665,
                                     0.65675821197928406889,
                                     0.66855157065310764449,
                                     0.68017914636880840769,
                                     0.69163805579772433921,
                                     0.70292545743593242505,
                                     0.71403855230886566345,
                                     0.72497458466538390002,
                                     0.73573084266112637578,
                                     0.74630465903097652944,
                                     0.75669341175047229441,
                                     0.76689452468599787075,
                                     0.77690546823359573270,
                                     0.78672375994624045220,
                                     0.79634696514941877761,
                                     0.80577269754486330355,
                                     0.81499861980229000122,
                                     0.82402244413899284884,
                                     0.83284193288715180631,
                                     0.84145489904871341718,
                                     0.84985920683770639260,
                                     0.85805277220985763403,
                                     0.86603356337937728374,
                                     0.87379960132278455084,
                                     0.88134896026964924417,
                                     0.88867976818012714760,
                                     0.89579020720917059382,
                                     0.90267851415729882355,
                                     0.90934298090781594832,
                                     0.91578195485036755586,
                                     0.92199383929073018770,
                                     0.92797709384673105334,
                                     0.93373023483019838308,
                                     0.93925183561484570008,
                                     0.94454052698999591354,
                                     0.94959499750005334301,
                                     0.95441399376963332222,
                                     0.95899632081425947383,
                                     0.96334084233653736249,
                                     0.96744648100770874076,
                                     0.97131221873448068280,
                                     0.97493709691100423125,
                                     0.97832021665583940894,
                                     0.98146073903367077807,
                                     0.98435788526139485790,
                                     0.98701093689790951346,
                                     0.98941923601631248635,
                                     0.99158218535580009892,
                                     0.99349924844708733213,
                                     0.99516994969584302990,
                                     0.99659387438045613187,
                                     0.99777066842138561529,
                                     0.99870003735107445262,
                                     0.99938174140186838554,
                                     0.99981555880264623410,
                                     1};
  std::array<double, 200> ref_wgt = {
      0.000050251256281407035176, 0.00030976251435716016104,
      0.00055780169077174357160,  0.00080557249413304998728,
      0.0010531257091405344483,   0.0013004133495005470602,
      0.0015473770193742858502,   0.0017939563607759977079,
      0.0020400905558552534489,   0.0022857187100975599316,
      0.0025307799811195085467,   0.0027752136348815916539,
      0.0030189590775071300262,   0.0032619558778057293491,
      0.0035041437858757830148,   0.0037454627499018758623,
      0.0039858529320505621974,   0.0042252547238766868052,
      0.0044636087614386051818,   0.0047008559402218066450,
      0.0049369374299223019542,   0.0051717946891166084975,
      0.0054053694798321649138,   0.0056376038820248721704,
      0.0058684403079664210840,   0.0060978215165417201545,
      0.0063256906274553423767,   0.0065519911353450639858,
      0.0067766669238000478841,   0.0069996622792809015920,
      0.0072209219049386388371,   0.0074403909343294503803,
      0.0076580149450221159046,   0.0078737399720948476876,
      0.0080875125215183375380,   0.0082992795834217741467,
      0.0085089886452386040613,   0.0087165877047288229331,
      0.0089220252828746025034,   0.0091252504366460816188,
      0.0093262127716341754606,   0.0095248624545472854839,
      0.0097211502255688228314,   0.0099150274105724898791,
      0.010106445933192297866,    0.010295358326744333065,
      0.010481717745997319548,    0.010665477978789063218,
      0.010846593457485899264,    0.011025019270282303615,
      0.011200711172337868162,    0.011373625596748879502,
      0.011543719665351781715,    0.011710951199355845155,
      0.011875278729802405413,    0.012036661507848079480,
      0.012195059514869409682,    0.012350433472386430135,
      0.012502744851802695311,    0.012651955883959355750,
      0.012798029568500912022,    0.012940929683050324680,
      0.013080620792191205225,    0.013217068256254860876,
      0.013350238239910014317,    0.013480097720553068529,
      0.013606614496496836216,    0.013729757194955703339,
      0.013849495279825246695,    0.013965799059254376491,
      0.014078639693008126242,    0.014187989199619264289,
      0.014293820463326953549,    0.014396107240800738927,
      0.014494824167648195065,    0.014589946764704620703,
      0.014681451444103220021,    0.014769315515124265723,
      0.014853517189821793449,    0.014934035588426432257,
      0.015010850744523031430,    0.015083943610001799707,
      0.015153296059781729189,    0.015218890896305132661,
      0.015280711853802179797,    0.015338743602324374769,
      0.015392971751545975073,    0.015443382854332408922,
      0.015489964410074806347,    0.015532704867789817115,
      0.015571593628983946826,    0.015606621050281700880,
      0.015637778445816884637,    0.015665058089386466766,
      0.015688453216366471711,    0.015707958025389426161,
      0.015723567679782943584,    0.015735278308769090077,
      0.015743087008424234140,    0.015746991842399142347,
      0.015746991842399142347,    0.015743087008424234140,
      0.015735278308769090077,    0.015723567679782943584,
      0.015707958025389426161,    0.015688453216366471711,
      0.015665058089386466766,    0.015637778445816884637,
      0.015606621050281700880,    0.015571593628983946826,
      0.015532704867789817115,    0.015489964410074806347,
      0.015443382854332408922,    0.015392971751545975073,
      0.015338743602324374769,    0.015280711853802179797,
      0.015218890896305132661,    0.015153296059781729189,
      0.015083943610001799707,    0.015010850744523031430,
      0.014934035588426432257,    0.014853517189821793449,
      0.014769315515124265723,    0.014681451444103220021,
      0.014589946764704620703,    0.014494824167648195065,
      0.014396107240800738927,    0.014293820463326953549,
      0.014187989199619264289,    0.014078639693008126242,
      0.013965799059254376491,    0.013849495279825246695,
      0.013729757194955703339,    0.013606614496496836216,
      0.013480097720553068529,    0.013350238239910014317,
      0.013217068256254860876,    0.013080620792191205225,
      0.012940929683050324680,    0.012798029568500912022,
      0.012651955883959355750,    0.012502744851802695311,
      0.012350433472386430135,    0.012195059514869409682,
      0.012036661507848079480,    0.011875278729802405413,
      0.011710951199355845155,    0.011543719665351781715,
      0.011373625596748879502,    0.011200711172337868162,
      0.011025019270282303615,    0.010846593457485899264,
      0.010665477978789063218,    0.010481717745997319548,
      0.010295358326744333065,    0.010106445933192297866,
      0.0099150274105724898791,   0.0097211502255688228314,
      0.0095248624545472854839,   0.0093262127716341754606,
      0.0091252504366460816188,   0.0089220252828746025034,
      0.0087165877047288229331,   0.0085089886452386040613,
      0.0082992795834217741467,   0.0080875125215183375380,
      0.0078737399720948476876,   0.0076580149450221159046,
      0.0074403909343294503803,   0.0072209219049386388371,
      0.0069996622792809015920,   0.0067766669238000478841,
      0.0065519911353450639858,   0.0063256906274553423767,
      0.0060978215165417201545,   0.0058684403079664210840,
      0.0056376038820248721704,   0.0054053694798321649138,
      0.0051717946891166084975,   0.0049369374299223019542,
      0.0047008559402218066450,   0.0044636087614386051818,
      0.0042252547238766868052,   0.0039858529320505621974,
      0.0037454627499018758623,   0.0035041437858757830148,
      0.0032619558778057293491,   0.0030189590775071300262,
      0.0027752136348815916539,   0.0025307799811195085467,
      0.0022857187100975599316,   0.0020400905558552534489,
      0.0017939563607759977079,   0.0015473770193742858502,
      0.0013004133495005470602,   0.0010531257091405344483,
      0.00080557249413304998728,  0.00055780169077174357160,
      0.00030976251435716016104,  0.000050251256281407035176};
  IntegratorXX::GaussLobatto<double, double> quad(200);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 200; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("225 point GaussLobatto", "[1d-quad]") {
  std::array<double, 225> ref_pts = {-1,
                                     -0.99985434906516644766,
                                     -0.99951176139797977714,
                                     -0.99897339540365953887,
                                     -0.99823939814206131777,
                                     -0.99730992069621820876,
                                     -0.99618514717327413464,
                                     -0.99486529860496050503,
                                     -0.99335063378704760641,
                                     -0.99164144949199958060,
                                     -0.98973808050574594359,
                                     -0.98764089960128270716,
                                     -0.98535031748358637044,
                                     -0.98286678271807105465,
                                     -0.98019078164745185978,
                                     -0.97732283829913597755,
                                     -0.97426351428414331573,
                                     -0.97101340868806498825,
                                     -0.96757315795433660198,
                                     -0.96394343575998898529,
                                     -0.96012495288398016181,
                                     -0.95611845706818109509,
                                     -0.95192473287107075666,
                                     -0.94754460151418680420,
                                     -0.94297892072137318490,
                                     -0.93822858455086347199,
                                     -0.93329452322023768746,
                                     -0.92817770292429018395,
                                     -0.92287912564584651847,
                                     -0.91739982895956794690,
                                     -0.91174088582878307978,
                                     -0.90590340439538728780,
                                     -0.89988852776285158273,
                                     -0.89369743377238389379,
                                     -0.88733133477228688915,
                                     -0.88079147738055774527,
                                     -0.87407914224077653179,
                                     -0.86719564377133115101,
                                     -0.86014232990802804453,
                                     -0.85292058184013915058,
                                     -0.84553181373993686327,
                                     -0.83797747248577000640,
                                     -0.83025903737873508881,
                                     -0.82237801985299835431,
                                     -0.81433596317982537642,
                                     -0.80613444216537617522,
                                     -0.79777506284232505074,
                                     -0.78925946215536553355,
                                     -0.78058930764066204796,
                                     -0.77176629709931106707,
                                     -0.76279215826487570999,
                                     -0.75366864846505889119,
                                     -0.74439755427758127841,
                                     -0.73498069118033144982,
                                     -0.72541990319585676196,
                                     -0.71571706253026454756,
                                     -0.70587406920660435648,
                                     -0.69589285069280303364,
                                     -0.68577536152422549362,
                                     -0.67552358292093510437,
                                     -0.66513952239972862960,
                                     -0.65462521338102170295,
                                     -0.64398271479066181504,
                                     -0.63321411065674678760,
                                     -0.62232150970152768702,
                                     -0.61130704492847609199,
                                     -0.60017287320459657677,
                                     -0.58892117483806620258,
                                     -0.57755415315128372489,
                                     -0.56607403404941212273,
                                     -0.55448306558449893920,
                                     -0.54278351751525978769,
                                     -0.53097768086261122796,
                                     -0.51906786746104004840,
                                     -0.50705640950589680610,
                                     -0.49494565909670227437,
                                     -0.48273798777655622839,
                                     -0.47043578606773876240,
                                     -0.45804146300359507795,
                                     -0.44555744565679541017,
                                     -0.43298617866406246877,
                                     -0.42033012374745946259,
                                     -0.40759175923233244953,
                                     -0.39477357956200140927,
                                     -0.38187809480929507258,
                                     -0.36890783018502515916,
                                     -0.35586532554349627527,
                                     -0.34275313488514830302,
                                     -0.32957382585642867433,
                                     -0.31632997924699246548,
                                     -0.30302418848432877115,
                                     -0.28965905912591232088,
                                     -0.27623720834897978549,
                                     -0.26276126443803068629,
                                     -0.24923386627015326512,
                                     -0.23565766279827609969,
                                     -0.22203531253244665430,
                                     -0.20836948301923834289,
                                     -0.19466285031938804746,
                                     -0.18091809848376638179,
                                     -0.16713791902778331640,
                                     -0.15332501040433208758,
                                     -0.13948207747537459915,
                                     -0.12561183098227179194,
                                     -0.11171698701496270149,
                                     -0.097800266480096150086,
                                     -0.083864394568219224298,
                                     -0.069912100220126873850,
                                     -0.055946115592477131989,
                                     -0.041969175522776601268,
                                     -0.027984016993840972000,
                                     -0.013993378597835443438,
                                     0,
                                     0.013993378597835443438,
                                     0.027984016993840972000,
                                     0.041969175522776601268,
                                     0.055946115592477131989,
                                     0.069912100220126873850,
                                     0.083864394568219224298,
                                     0.097800266480096150086,
                                     0.11171698701496270149,
                                     0.12561183098227179194,
                                     0.13948207747537459915,
                                     0.15332501040433208758,
                                     0.16713791902778331640,
                                     0.18091809848376638179,
                                     0.19466285031938804746,
                                     0.20836948301923834289,
                                     0.22203531253244665430,
                                     0.23565766279827609969,
                                     0.24923386627015326512,
                                     0.26276126443803068629,
                                     0.27623720834897978549,
                                     0.28965905912591232088,
                                     0.30302418848432877115,
                                     0.31632997924699246548,
                                     0.32957382585642867433,
                                     0.34275313488514830302,
                                     0.35586532554349627527,
                                     0.36890783018502515916,
                                     0.38187809480929507258,
                                     0.39477357956200140927,
                                     0.40759175923233244953,
                                     0.42033012374745946259,
                                     0.43298617866406246877,
                                     0.44555744565679541017,
                                     0.45804146300359507795,
                                     0.47043578606773876240,
                                     0.48273798777655622839,
                                     0.49494565909670227437,
                                     0.50705640950589680610,
                                     0.51906786746104004840,
                                     0.53097768086261122796,
                                     0.54278351751525978769,
                                     0.55448306558449893920,
                                     0.56607403404941212273,
                                     0.57755415315128372489,
                                     0.58892117483806620258,
                                     0.60017287320459657677,
                                     0.61130704492847609199,
                                     0.62232150970152768702,
                                     0.63321411065674678760,
                                     0.64398271479066181504,
                                     0.65462521338102170295,
                                     0.66513952239972862960,
                                     0.67552358292093510437,
                                     0.68577536152422549362,
                                     0.69589285069280303364,
                                     0.70587406920660435648,
                                     0.71571706253026454756,
                                     0.72541990319585676196,
                                     0.73498069118033144982,
                                     0.74439755427758127841,
                                     0.75366864846505889119,
                                     0.76279215826487570999,
                                     0.77176629709931106707,
                                     0.78058930764066204796,
                                     0.78925946215536553355,
                                     0.79777506284232505074,
                                     0.80613444216537617522,
                                     0.81433596317982537642,
                                     0.82237801985299835431,
                                     0.83025903737873508881,
                                     0.83797747248577000640,
                                     0.84553181373993686327,
                                     0.85292058184013915058,
                                     0.86014232990802804453,
                                     0.86719564377133115101,
                                     0.87407914224077653179,
                                     0.88079147738055774527,
                                     0.88733133477228688915,
                                     0.89369743377238389379,
                                     0.89988852776285158273,
                                     0.90590340439538728780,
                                     0.91174088582878307978,
                                     0.91739982895956794690,
                                     0.92287912564584651847,
                                     0.92817770292429018395,
                                     0.93329452322023768746,
                                     0.93822858455086347199,
                                     0.94297892072137318490,
                                     0.94754460151418680420,
                                     0.95192473287107075666,
                                     0.95611845706818109509,
                                     0.96012495288398016181,
                                     0.96394343575998898529,
                                     0.96757315795433660198,
                                     0.97101340868806498825,
                                     0.97426351428414331573,
                                     0.97732283829913597755,
                                     0.98019078164745185978,
                                     0.98286678271807105465,
                                     0.98535031748358637044,
                                     0.98764089960128270716,
                                     0.98973808050574594359,
                                     0.99164144949199958060,
                                     0.99335063378704760641,
                                     0.99486529860496050503,
                                     0.99618514717327413464,
                                     0.99730992069621820876,
                                     0.99823939814206131777,
                                     0.99897339540365953887,
                                     0.99951176139797977714,
                                     0.99985434906516644766,
                                     1};
  std::array<double, 225> ref_wgt = {
      0.000039682539682539682540, 0.00024461721215270298197,
      0.00044050535165395276656,  0.00063620453193167315062,
      0.00083176505203046058177,  0.0010271591986922110907,
      0.0012223510191987928130,   0.0014173029876046105901,
      0.0016119771865525163910,   0.0018063356053820787379,
      0.0020003402373497736929,   0.0021939531195447879000,
      0.0023871363535554043281,   0.0025798521188103899351,
      0.0027720626828410255471,   0.0029637304101361111937,
      0.0031548177703048808851,   0.0033452873458747812671,
      0.0035351018398822186823,   0.0037242240833363104143,
      0.0039126170425976518129,   0.0041002438266947335756,
      0.0042870676945903685420,   0.0044730520624048445529,
      0.0046581605105993229712,   0.0048423567911211403660,
      0.0050256048345115592581,   0.0052078687569758357324,
      0.0053891128674150502483,   0.0055693016744188819020,
      0.0057483998932183363863,   0.0059263724525973284479,
      0.0061031845017619490760,   0.0062788014171662024869,
      0.0064531888092929696651,   0.0066263125293889383006,
      0.0067981386761522298567,   0.0069686336023714508356,
      0.0071377639215148955124,   0.0073054965142686303908,
      0.0074717985350221956756,   0.0076366374183006656313,
      0.0077999808851418174538,   0.0079617969494171669660,
      0.0081220539240956388751,   0.0082807204274486493701,
      0.0084377653891953893931,   0.0085931580565871079233,
      0.0087468680004292060035,   0.0088988651210399639912,
      0.0090491196541447365853,   0.0091976021767044625482,
      0.0093442836126773486972,   0.0094891352387126006531,
      0.0096321286897750860054,   0.0097732359646998289734,
      0.0099124294316752492877,   0.010049681833654071907,
      0.010184966293690848282,    0.010318256320205044210,
      0.010449525812168663855,    0.010578749064217394250,
      0.010705900771684269560,    0.010830956035554869521,
      0.010953890367343081827,    0.011074679693886473773,
      0.011193300362060334185,    0.011309729143409462598,
      0.011423943238696798731,    0.011535920282368001584,
      0.011645638346931103936,    0.011753075947250384654,
      0.011858212044753618003,    0.011961026051551876122,
      0.012061497834471077938,    0.012159607718994495070,
      0.012255336493115442728,    0.012348665411099401156,
      0.012439576197154830968,    0.012528051049011963516,
      0.012614072641408865540,    0.012697624129484095437,
      0.012778689152075286809,    0.012857251834923013365,
      0.012933296793779307800,    0.013006809137420225933,
      0.013077774470561866198,    0.013146178896679273457,
      0.013212009020727675153,    0.013275251951765516923,
      0.013335895305478784021,    0.013393927206606114248,
      0.013449336291264227504,    0.013502111709173216582,
      0.013552243125781263456,    0.013599720724288365005,
      0.013644535207568671869,    0.013686677799991064025,
      0.013726140249137606553,    0.013762914827419549104,
      0.013796994333590552612,    0.013828372094156846931,
      0.013857041964684043259,    0.013882998331000345451,
      0.013906236110295924598,    0.013926750752118241607,
      0.013944538239263122860,    0.013959595088561414471,
      0.013971918351561061100,    0.013981505615104475747,
      0.013988355001801087476,    0.013992465170394974528,
      0.013993835316027510840,    0.013992465170394974528,
      0.013988355001801087476,    0.013981505615104475747,
      0.013971918351561061100,    0.013959595088561414471,
      0.013944538239263122860,    0.013926750752118241607,
      0.013906236110295924598,    0.013882998331000345451,
      0.013857041964684043259,    0.013828372094156846931,
      0.013796994333590552612,    0.013762914827419549104,
      0.013726140249137606553,    0.013686677799991064025,
      0.013644535207568671869,    0.013599720724288365005,
      0.013552243125781263456,    0.013502111709173216582,
      0.013449336291264227504,    0.013393927206606114248,
      0.013335895305478784021,    0.013275251951765516923,
      0.013212009020727675153,    0.013146178896679273457,
      0.013077774470561866198,    0.013006809137420225933,
      0.012933296793779307800,    0.012857251834923013365,
      0.012778689152075286809,    0.012697624129484095437,
      0.012614072641408865540,    0.012528051049011963516,
      0.012439576197154830968,    0.012348665411099401156,
      0.012255336493115442728,    0.012159607718994495070,
      0.012061497834471077938,    0.011961026051551876122,
      0.011858212044753618003,    0.011753075947250384654,
      0.011645638346931103936,    0.011535920282368001584,
      0.011423943238696798731,    0.011309729143409462598,
      0.011193300362060334185,    0.011074679693886473773,
      0.010953890367343081827,    0.010830956035554869521,
      0.010705900771684269560,    0.010578749064217394250,
      0.010449525812168663855,    0.010318256320205044210,
      0.010184966293690848282,    0.010049681833654071907,
      0.0099124294316752492877,   0.0097732359646998289734,
      0.0096321286897750860054,   0.0094891352387126006531,
      0.0093442836126773486972,   0.0091976021767044625482,
      0.0090491196541447365853,   0.0088988651210399639912,
      0.0087468680004292060035,   0.0085931580565871079233,
      0.0084377653891953893931,   0.0082807204274486493701,
      0.0081220539240956388751,   0.0079617969494171669660,
      0.0077999808851418174538,   0.0076366374183006656313,
      0.0074717985350221956756,   0.0073054965142686303908,
      0.0071377639215148955124,   0.0069686336023714508356,
      0.0067981386761522298567,   0.0066263125293889383006,
      0.0064531888092929696651,   0.0062788014171662024869,
      0.0061031845017619490760,   0.0059263724525973284479,
      0.0057483998932183363863,   0.0055693016744188819020,
      0.0053891128674150502483,   0.0052078687569758357324,
      0.0050256048345115592581,   0.0048423567911211403660,
      0.0046581605105993229712,   0.0044730520624048445529,
      0.0042870676945903685420,   0.0041002438266947335756,
      0.0039126170425976518129,   0.0037242240833363104143,
      0.0035351018398822186823,   0.0033452873458747812671,
      0.0031548177703048808851,   0.0029637304101361111937,
      0.0027720626828410255471,   0.0025798521188103899351,
      0.0023871363535554043281,   0.0021939531195447879000,
      0.0020003402373497736929,   0.0018063356053820787379,
      0.0016119771865525163910,   0.0014173029876046105901,
      0.0012223510191987928130,   0.0010271591986922110907,
      0.00083176505203046058177,  0.00063620453193167315062,
      0.00044050535165395276656,  0.00024461721215270298197,
      0.000039682539682539682540};
  IntegratorXX::GaussLobatto<double, double> quad(225);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 225; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("250 point GaussLobatto", "[1d-quad]") {
  std::array<double, 250> ref_pts = {-1,
                                     -0.99988207484275208625,
                                     -0.99960469708028914305,
                                     -0.99916879426083679746,
                                     -0.99857446920443263988,
                                     -0.99782182208962226086,
                                     -0.99691097394154720362,
                                     -0.99584206979985377432,
                                     -0.99461527941036853030,
                                     -0.99323079741137951907,
                                     -0.99168884337959536384,
                                     -0.98998966182703454767,
                                     -0.98813352217675895200,
                                     -0.98612071872734830446,
                                     -0.98395157061004688622,
                                     -0.98162642174029364304,
                                     -0.97914564076443968065,
                                     -0.97650962100205710295,
                                     -0.97371878038405523695,
                                     -0.97077356138672721549,
                                     -0.96767443096180170675,
                                     -0.96442188046254871730,
                                     -0.96101642556597411662,
                                     -0.95745860619112949465,
                                     -0.95374898641355940737,
                                     -0.94988815437590550675,
                                     -0.94587672219468567068,
                                     -0.94171532586326558043,
                                     -0.93740462515103996366,
                                     -0.93294530349884076853,
                                     -0.92833806791058975866,
                                     -0.92358364884121335733,
                                     -0.91868280008083798378,
                                     -0.91363629863528458843,
                                     -0.90844494460288159099,
                                     -0.90310956104761594461,
                                     -0.89763099386864258274,
                                     -0.89201011166617304816,
                                     -0.88624780560376465199,
                                     -0.88034498926703206191,
                                     -0.87430259851880377161,
                                     -0.86812159135074645597,
                                     -0.86180294773148076797,
                                     -0.85534766945121268328,
                                     -0.84875677996290504561,
                                     -0.84203132422001451053,
                                     -0.83517236851081962692,
                                     -0.82818100028936633324,
                                     -0.82105832800305767999,
                                     -0.81380548091691512040,
                                     -0.80642360893453923758,
                                     -0.79891388241579829896,
                                     -0.79127749199127354651,
                                     -0.78351564837349064489,
                                     -0.77562958216496721875,
                                     -0.76762054366310691457,
                                     -0.75948980266197092209,
                                     -0.75123864825095838534,
                                     -0.74286838861042762263,
                                     -0.73438035080429056029,
                                     -0.72577588056961326405,
                                     -0.71705634210325592691,
                                     -0.70822311784558614137,
                                     -0.69927760826129974791,
                                     -0.69022123161738401008,
                                     -0.68105542375825831938,
                                     -0.67178163787812808097,
                                     -0.66240134429058787251,
                                     -0.65291603019551040478,
                                     -0.64332719944325824316,
                                     -0.63363637229625567301,
                                     -0.62384508518795851099,
                                     -0.61395489047926007657,
                                     -0.60396735621237194460,
                                     -0.59388406586221849997,
                                     -0.58370661808538470985,
                                     -0.57343662646665691654,
                                     -0.56307571926319683583,
                                     -0.55262553914638932108,
                                     -0.54208774294140482146,
                                     -0.53146400136451782608,
                                     -0.52075599875822294042,
                                     -0.50996543282419059154,
                                     -0.49909401435410470053,
                                     -0.48814346695842499663,
                                     -0.47711552679311697654,
                                     -0.46601194228439283445,
                                     -0.45483447385150700403,
                                     -0.44358489362765026155,
                                     -0.43226498517898664129,
                                     -0.42087654322187770844,
                                     -0.40942137333833902221,
                                     -0.39790129168977390233,
                                     -0.38631812472902988487,
                                     -0.37467370891082351956,
                                     -0.36296989040057941934,
                                     -0.35120852478172972426,
                                     -0.33939147676152038611,
                                     -0.32752061987537091659,
                                     -0.31559783618983447149,
                                     -0.30362501600420536507,
                                     -0.29160405755082132336,
                                     -0.27953686669410799191,
                                     -0.26742535662841341317,
                                     -0.25527144757468038023,
                                     -0.24307706647600475815,
                                     -0.23084414669212804063,
                                     -0.21857462769291257861,
                                     -0.20627045475084807903,
                                     -0.19393357863263812513,
                                     -0.18156595528991561595,
                                     -0.16916954554913616044,
                                     -0.15674631480069859211,
                                     -0.14429823268734189275,
                                     -0.13182727279186792825,
                                     -0.11933541232423950663,
                                     -0.10682463180810336728,
                                     -0.094296914766787801859,
                                     -0.081754247408824690145,
                                     -0.069198618313045809979,
                                     -0.056632018113303347678,
                                     -0.044056439182864594957,
                                     -0.031473875318530870040,
                                     -0.018886321424530744388,
                                     -0.0062957731962376922065,
                                     0.0062957731962376922065,
                                     0.018886321424530744388,
                                     0.031473875318530870040,
                                     0.044056439182864594957,
                                     0.056632018113303347678,
                                     0.069198618313045809979,
                                     0.081754247408824690145,
                                     0.094296914766787801859,
                                     0.10682463180810336728,
                                     0.11933541232423950663,
                                     0.13182727279186792825,
                                     0.14429823268734189275,
                                     0.15674631480069859211,
                                     0.16916954554913616044,
                                     0.18156595528991561595,
                                     0.19393357863263812513,
                                     0.20627045475084807903,
                                     0.21857462769291257861,
                                     0.23084414669212804063,
                                     0.24307706647600475815,
                                     0.25527144757468038023,
                                     0.26742535662841341317,
                                     0.27953686669410799191,
                                     0.29160405755082132336,
                                     0.30362501600420536507,
                                     0.31559783618983447149,
                                     0.32752061987537091659,
                                     0.33939147676152038611,
                                     0.35120852478172972426,
                                     0.36296989040057941934,
                                     0.37467370891082351956,
                                     0.38631812472902988487,
                                     0.39790129168977390233,
                                     0.40942137333833902221,
                                     0.42087654322187770844,
                                     0.43226498517898664129,
                                     0.44358489362765026155,
                                     0.45483447385150700403,
                                     0.46601194228439283445,
                                     0.47711552679311697654,
                                     0.48814346695842499663,
                                     0.49909401435410470053,
                                     0.50996543282419059154,
                                     0.52075599875822294042,
                                     0.53146400136451782608,
                                     0.54208774294140482146,
                                     0.55262553914638932108,
                                     0.56307571926319683583,
                                     0.57343662646665691654,
                                     0.58370661808538470985,
                                     0.59388406586221849997,
                                     0.60396735621237194460,
                                     0.61395489047926007657,
                                     0.62384508518795851099,
                                     0.63363637229625567301,
                                     0.64332719944325824316,
                                     0.65291603019551040478,
                                     0.66240134429058787251,
                                     0.67178163787812808097,
                                     0.68105542375825831938,
                                     0.69022123161738401008,
                                     0.69927760826129974791,
                                     0.70822311784558614137,
                                     0.71705634210325592691,
                                     0.72577588056961326405,
                                     0.73438035080429056029,
                                     0.74286838861042762263,
                                     0.75123864825095838534,
                                     0.75948980266197092209,
                                     0.76762054366310691457,
                                     0.77562958216496721875,
                                     0.78351564837349064489,
                                     0.79127749199127354651,
                                     0.79891388241579829896,
                                     0.80642360893453923758,
                                     0.81380548091691512040,
                                     0.82105832800305767999,
                                     0.82818100028936633324,
                                     0.83517236851081962692,
                                     0.84203132422001451053,
                                     0.84875677996290504561,
                                     0.85534766945121268328,
                                     0.86180294773148076797,
                                     0.86812159135074645597,
                                     0.87430259851880377161,
                                     0.88034498926703206191,
                                     0.88624780560376465199,
                                     0.89201011166617304816,
                                     0.89763099386864258274,
                                     0.90310956104761594461,
                                     0.90844494460288159099,
                                     0.91363629863528458843,
                                     0.91868280008083798378,
                                     0.92358364884121335733,
                                     0.92833806791058975866,
                                     0.93294530349884076853,
                                     0.93740462515103996366,
                                     0.94171532586326558043,
                                     0.94587672219468567068,
                                     0.94988815437590550675,
                                     0.95374898641355940737,
                                     0.95745860619112949465,
                                     0.96101642556597411662,
                                     0.96442188046254871730,
                                     0.96767443096180170675,
                                     0.97077356138672721549,
                                     0.97371878038405523695,
                                     0.97650962100205710295,
                                     0.97914564076443968065,
                                     0.98162642174029364304,
                                     0.98395157061004688622,
                                     0.98612071872734830446,
                                     0.98813352217675895200,
                                     0.98998966182703454767,
                                     0.99168884337959536384,
                                     0.99323079741137951907,
                                     0.99461527941036853030,
                                     0.99584206979985377432,
                                     0.99691097394154720362,
                                     0.99782182208962226086,
                                     0.99857446920443263988,
                                     0.99916879426083679746,
                                     0.99960469708028914305,
                                     0.99988207484275208625,
                                     1};
  std::array<double, 250> ref_wgt = {
      0.000032128514056224899598, 0.00019805335646928629255,
      0.00035666116691527394371,  0.00051512928252666077110,
      0.00067350432933035885621,  0.00083176976486726353657,
      0.00098990236681108002862,  0.0011478776281104736834,
      0.0013056707117460296527,   0.0014632566900081691996,
      0.0016206106211326728165,   0.0017777075795450459127,
      0.0019345226705249943970,   0.0020910310389460135728,
      0.0022472078755280687364,   0.0024030284219578997899,
      0.0025584679754563347366,   0.0027135018930578725859,
      0.0028681055957310871952,   0.0030222545724051942207,
      0.0031759243839373355116,   0.0033290906670394443360,
      0.0034817291381752334792,   0.0036338155974332771047,
      0.0037853259323795662491,   0.0039362361218914074176,
      0.0040865222399736308523,   0.0042361604595575230037,
      0.0043851270562825533453,   0.0045333984122607469624,
      0.0046809510198234133049,   0.0048277614852498493553,
      0.0049738065324775746890,   0.0051190630067936155645,
      0.0052635078785063283799,   0.0054071182465972351291,
      0.0055498713423523319934,   0.0056917445329723249963,
      0.0058327153251612424570,   0.0059727613686928719207,
      0.0061118604599544687380,   0.0062499905454671840916,
      0.0063871297253826617338,   0.0065232562569552548078,
      0.0066583485579893167255,   0.0067923852102610230575,
      0.0069253449629141846927,   0.0070572067358295160716,
      0.0071879496229668260642,   0.0073175528956796030062,
      0.0074459960060014695135,   0.0075732585899039869357,
      0.0076993204705252936842,   0.0078241616613690661547,
      0.0079477623694732955613,   0.0080701029985483786973,
      0.0081911641520840254300,   0.0083109266364244906243,
      0.0084293714638116431649,   0.0085464798553953898061,
      0.0086622332442109767253,   0.0087766132781226968777,
      0.0088896018227335365585,   0.0090011809642602999577,
      0.0091113330123737559537,   0.0092200405030033569237,
      0.0093272862011060849553,   0.0094330531033989865242,
      0.0095373244410549624495,   0.0096400836823613857616,
      0.0097413145353411260022,   0.0098410009503355644337,
      0.0099391271225491906585,   0.010035677494555377233,
      0.010130636758762935021,    0.010223989859843058231,
      0.010315721997116274386,    0.010405818626899020785,
      0.010494265464809475437,    0.010581048488032276888,
      0.010666153937541773902,    0.010749568320283452512,
      0.010831278411313194581,    0.010911271255894028732,
      0.010989534171550041204,    0.011066054750077121006,
      0.011140820859510220580,    0.011213820646046820079,
      0.011285042535926290300,    0.011354475237264856319,
      0.011422107741845870900,    0.011487929326865113838,
      0.011551929556630840545,    0.011614098284218310326,
      0.011674425653078532040,    0.011732902098600972088,
      0.011789518349629976969,    0.011844265429934669982,
      0.011897134659632089027,    0.011948117656563339889,
      0.011997206337622546797,    0.012044392920038389590,
      0.012089669922608024288,    0.012133030166883191441,
      0.012174466778308324212,    0.012213973187310475749,
      0.012251543130340893035,    0.012287170650868072094,
      0.012320850100322137106,    0.012352576138990393690,
      0.012382343736863914393,    0.012410148174435022148,
      0.012435985043445545263,    0.012459850247585725317,
      0.012481740003143667157,    0.012501650839605228009,
      0.012519579600204250627,    0.012535523442423053206,
      0.012549479838443096738,    0.012561446575545758349,
      0.012571421756463147073,    0.012579403799678906448,
      0.012585391439678956238,    0.012589383727152133545,
      0.012591380029140701464,    0.012591380029140701464,
      0.012589383727152133545,    0.012585391439678956238,
      0.012579403799678906448,    0.012571421756463147073,
      0.012561446575545758349,    0.012549479838443096738,
      0.012535523442423053206,    0.012519579600204250627,
      0.012501650839605228009,    0.012481740003143667157,
      0.012459850247585725317,    0.012435985043445545263,
      0.012410148174435022148,    0.012382343736863914393,
      0.012352576138990393690,    0.012320850100322137106,
      0.012287170650868072094,    0.012251543130340893035,
      0.012213973187310475749,    0.012174466778308324212,
      0.012133030166883191441,    0.012089669922608024288,
      0.012044392920038389590,    0.011997206337622546797,
      0.011948117656563339889,    0.011897134659632089027,
      0.011844265429934669982,    0.011789518349629976969,
      0.011732902098600972088,    0.011674425653078532040,
      0.011614098284218310326,    0.011551929556630840545,
      0.011487929326865113838,    0.011422107741845870900,
      0.011354475237264856319,    0.011285042535926290300,
      0.011213820646046820079,    0.011140820859510220580,
      0.011066054750077121006,    0.010989534171550041204,
      0.010911271255894028732,    0.010831278411313194581,
      0.010749568320283452512,    0.010666153937541773902,
      0.010581048488032276888,    0.010494265464809475437,
      0.010405818626899020785,    0.010315721997116274386,
      0.010223989859843058231,    0.010130636758762935021,
      0.010035677494555377233,    0.0099391271225491906585,
      0.0098410009503355644337,   0.0097413145353411260022,
      0.0096400836823613857616,   0.0095373244410549624495,
      0.0094330531033989865242,   0.0093272862011060849553,
      0.0092200405030033569237,   0.0091113330123737559537,
      0.0090011809642602999577,   0.0088896018227335365585,
      0.0087766132781226968777,   0.0086622332442109767253,
      0.0085464798553953898061,   0.0084293714638116431649,
      0.0083109266364244906243,   0.0081911641520840254300,
      0.0080701029985483786973,   0.0079477623694732955613,
      0.0078241616613690661547,   0.0076993204705252936842,
      0.0075732585899039869357,   0.0074459960060014695135,
      0.0073175528956796030062,   0.0071879496229668260642,
      0.0070572067358295160716,   0.0069253449629141846927,
      0.0067923852102610230575,   0.0066583485579893167255,
      0.0065232562569552548078,   0.0063871297253826617338,
      0.0062499905454671840916,   0.0061118604599544687380,
      0.0059727613686928719207,   0.0058327153251612424570,
      0.0056917445329723249963,   0.0055498713423523319934,
      0.0054071182465972351291,   0.0052635078785063283799,
      0.0051190630067936155645,   0.0049738065324775746890,
      0.0048277614852498493553,   0.0046809510198234133049,
      0.0045333984122607469624,   0.0043851270562825533453,
      0.0042361604595575230037,   0.0040865222399736308523,
      0.0039362361218914074176,   0.0037853259323795662491,
      0.0036338155974332771047,   0.0034817291381752334792,
      0.0033290906670394443360,   0.0031759243839373355116,
      0.0030222545724051942207,   0.0028681055957310871952,
      0.0027135018930578725859,   0.0025584679754563347366,
      0.0024030284219578997899,   0.0022472078755280687364,
      0.0020910310389460135728,   0.0019345226705249943970,
      0.0017777075795450459127,   0.0016206106211326728165,
      0.0014632566900081691996,   0.0013056707117460296527,
      0.0011478776281104736834,   0.00098990236681108002862,
      0.00083176976486726353657,  0.00067350432933035885621,
      0.00051512928252666077110,  0.00035666116691527394371,
      0.00019805335646928629255,  0.000032128514056224899598};
  IntegratorXX::GaussLobatto<double, double> quad(250);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 250; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("275 point GaussLobatto", "[1d-quad]") {
  std::array<double, 275> ref_pts = {-1,
                                     -0.99990257642836475790,
                                     -0.99967341886349430538,
                                     -0.99931328727683469323,
                                     -0.99882225668777779370,
                                     -0.99820039632871373746,
                                     -0.99744778905348605769,
                                     -0.99656453395950035512,
                                     -0.99555074696515071722,
                                     -0.99440656097075876974,
                                     -0.99313212590462579061,
                                     -0.99172760872958366484,
                                     -0.99019319343310370873,
                                     -0.98852908100913720757,
                                     -0.98673548943493308748,
                                     -0.98481265364424370911,
                                     -0.98276082549758009890,
                                     -0.98058027374984723428,
                                     -0.97827128401553453172,
                                     -0.97583415873155957221,
                                     -0.97326921711782307179,
                                     -0.97057679513551151785,
                                     -0.96775724544317187479,
                                     -0.96481093735057590439,
                                     -0.96173825677038766291,
                                     -0.95853960616764540551,
                                     -0.95521540450706777102,
                                     -0.95176608719819335243,
                                     -0.94819210603836235398,
                                     -0.94449392915354886142,
                                     -0.94067204093705222454,
                                     -0.93672694198605611931,
                                     -0.93265914903606398950,
                                     -0.92846919489321974148,
                                     -0.92415762836452276923,
                                     -0.91972501418594660903,
                                     -0.91517193294847075902,
                                     -0.91049898102203544353,
                                     -0.90570677047742935304,
                                     -0.90079592900612064537,
                                     -0.89576709983804175128,
                                     -0.89062094165733878631,
                                     -0.88535812851609663043,
                                     -0.87997934974605099695,
                                     -0.87448530986829907128,
                                     -0.86887672850102055939,
                                     -0.86315434026522124345,
                                     -0.85731889468851139950,
                                     -0.85137115610693168747,
                                     -0.84531190356483937845,
                                     -0.83914193071286803716,
                                     -0.83286204570397402888,
                                     -0.82647307108758347043,
                                     -0.81997584370185349240,
                                     -0.81337121456406192709,
                                     -0.80666004875913978076,
                                     -0.79984322532636109215,
                                     -0.79292163714420502022,
                                     -0.78589619081340524307,
                                     -0.77876780653820198761,
                                     -0.77153741800581224444,
                                     -0.76420597226413395599,
                                     -0.75677442959770019696,
                                     -0.74924376340189959532,
                                     -0.74161496005547946913,
                                     -0.73388901879134837945,
                                     -0.72606695156569502187,
                                     -0.71814978292544060039,
                                     -0.71013854987404204476,
                                     -0.70203430173566364923,
                                     -0.69383810001773492362,
                                     -0.68555101827191265937,
                                     -0.67717414195346542227,
                                     -0.66870856827909888980,
                                     -0.66015540608324065563,
                                     -0.65151577567280332544,
                                     -0.64279080868044492733,
                                     -0.63398164791634585740,
                                     -0.62508944721852177467,
                                     -0.61611537130169205210,
                                     -0.60706059560472357876,
                                     -0.59792630613666989568,
                                     -0.58871369932142583115,
                                     -0.57942398184101798306,
                                     -0.57005837047755157437,
                                     -0.56061809195383438365,
                                     -0.55110438277269862632,
                                     -0.54151848905504183221,
                                     -0.53186166637660793331,
                                     -0.52213517960352994035,
                                     -0.51234030272665574912,
                                     -0.50247831869467877678,
                                     -0.49255051924609528509,
                                     -0.48255820474001040090,
                                     -0.47250268398581499548,
                                     -0.46238527407175573157,
                                     -0.45220730019242073263,
                                     -0.44197009547516347027,
                                     -0.43167500080548760533,
                                     -0.42132336465141565387,
                                     -0.41091654288686448258,
                                     -0.40045589861405076821,
                                     -0.38994280198494968260,
                                     -0.37937863002183018901,
                                     -0.36876476643689045621,
                                     -0.35810260145101701496,
                                     -0.34739353161169139583,
                                     -0.33663895961006809962,
                                     -0.32584029409724785937,
                                     -0.31499894949977025919,
                                     -0.30411634583434987669,
                                     -0.29319390852188021537,
                                     -0.28223306820072978882,
                                     -0.27123526053935481181,
                                     -0.26020192604825304226,
                                     -0.24913450989128340488,
                                     -0.23803446169637611003,
                                     -0.22690323536565806139,
                                     -0.21574228888501842244,
                                     -0.20455308413313928515,
                                     -0.19333708669001645446,
                                     -0.18209576564499542869,
                                     -0.17083059340434771969,
                                     -0.15954304549841271668,
                                     -0.14823460038833035467,
                                     -0.13690673927238990187,
                                     -0.12556094589202023093,
                                     -0.11419870633744698566,
                                     -0.10282150885304209850,
                                     -0.091430843642391154512,
                                     -0.080028202673104134442,
                                     -0.068615079481395102932,
                                     -0.057192968976456438533,
                                     -0.045763367244653228772,
                                     -0.034327771353563477256,
                                     -0.022887679155889789921,
                                     -0.011444589093268224413,
                                     0,
                                     0.011444589093268224413,
                                     0.022887679155889789921,
                                     0.034327771353563477256,
                                     0.045763367244653228772,
                                     0.057192968976456438533,
                                     0.068615079481395102932,
                                     0.080028202673104134442,
                                     0.091430843642391154512,
                                     0.10282150885304209850,
                                     0.11419870633744698566,
                                     0.12556094589202023093,
                                     0.13690673927238990187,
                                     0.14823460038833035467,
                                     0.15954304549841271668,
                                     0.17083059340434771969,
                                     0.18209576564499542869,
                                     0.19333708669001645446,
                                     0.20455308413313928515,
                                     0.21574228888501842244,
                                     0.22690323536565806139,
                                     0.23803446169637611003,
                                     0.24913450989128340488,
                                     0.26020192604825304226,
                                     0.27123526053935481181,
                                     0.28223306820072978882,
                                     0.29319390852188021537,
                                     0.30411634583434987669,
                                     0.31499894949977025919,
                                     0.32584029409724785937,
                                     0.33663895961006809962,
                                     0.34739353161169139583,
                                     0.35810260145101701496,
                                     0.36876476643689045621,
                                     0.37937863002183018901,
                                     0.38994280198494968260,
                                     0.40045589861405076821,
                                     0.41091654288686448258,
                                     0.42132336465141565387,
                                     0.43167500080548760533,
                                     0.44197009547516347027,
                                     0.45220730019242073263,
                                     0.46238527407175573157,
                                     0.47250268398581499548,
                                     0.48255820474001040090,
                                     0.49255051924609528509,
                                     0.50247831869467877678,
                                     0.51234030272665574912,
                                     0.52213517960352994035,
                                     0.53186166637660793331,
                                     0.54151848905504183221,
                                     0.55110438277269862632,
                                     0.56061809195383438365,
                                     0.57005837047755157437,
                                     0.57942398184101798306,
                                     0.58871369932142583115,
                                     0.59792630613666989568,
                                     0.60706059560472357876,
                                     0.61611537130169205210,
                                     0.62508944721852177467,
                                     0.63398164791634585740,
                                     0.64279080868044492733,
                                     0.65151577567280332544,
                                     0.66015540608324065563,
                                     0.66870856827909888980,
                                     0.67717414195346542227,
                                     0.68555101827191265937,
                                     0.69383810001773492362,
                                     0.70203430173566364923,
                                     0.71013854987404204476,
                                     0.71814978292544060039,
                                     0.72606695156569502187,
                                     0.73388901879134837945,
                                     0.74161496005547946913,
                                     0.74924376340189959532,
                                     0.75677442959770019696,
                                     0.76420597226413395599,
                                     0.77153741800581224444,
                                     0.77876780653820198761,
                                     0.78589619081340524307,
                                     0.79292163714420502022,
                                     0.79984322532636109215,
                                     0.80666004875913978076,
                                     0.81337121456406192709,
                                     0.81997584370185349240,
                                     0.82647307108758347043,
                                     0.83286204570397402888,
                                     0.83914193071286803716,
                                     0.84531190356483937845,
                                     0.85137115610693168747,
                                     0.85731889468851139950,
                                     0.86315434026522124345,
                                     0.86887672850102055939,
                                     0.87448530986829907128,
                                     0.87997934974605099695,
                                     0.88535812851609663043,
                                     0.89062094165733878631,
                                     0.89576709983804175128,
                                     0.90079592900612064537,
                                     0.90570677047742935304,
                                     0.91049898102203544353,
                                     0.91517193294847075902,
                                     0.91972501418594660903,
                                     0.92415762836452276923,
                                     0.92846919489321974148,
                                     0.93265914903606398950,
                                     0.93672694198605611931,
                                     0.94067204093705222454,
                                     0.94449392915354886142,
                                     0.94819210603836235398,
                                     0.95176608719819335243,
                                     0.95521540450706777102,
                                     0.95853960616764540551,
                                     0.96173825677038766291,
                                     0.96481093735057590439,
                                     0.96775724544317187479,
                                     0.97057679513551151785,
                                     0.97326921711782307179,
                                     0.97583415873155957221,
                                     0.97827128401553453172,
                                     0.98058027374984723428,
                                     0.98276082549758009890,
                                     0.98481265364424370911,
                                     0.98673548943493308748,
                                     0.98852908100913720757,
                                     0.99019319343310370873,
                                     0.99172760872958366484,
                                     0.99313212590462579061,
                                     0.99440656097075876974,
                                     0.99555074696515071722,
                                     0.99656453395950035512,
                                     0.99744778905348605769,
                                     0.99820039632871373746,
                                     0.99882225668777779370,
                                     0.99931328727683469323,
                                     0.99967341886349430538,
                                     0.99990257642836475790,
                                     1};
  std::array<double, 275> ref_wgt = {
      0.000026542800265428002654, 0.00016362184071271624163,
      0.00029466046874082717486,  0.00042559181007000527926,
      0.00055645799086615915203,  0.00068724894764411407983,
      0.00081794909394925689179,  0.00094854177647734471799,
      0.0010790100627993089309,   0.0012093369379990523001,
      0.0013395053669469317808,   0.0014694983182493621243,
      0.0015992987753292949713,   0.0017288897426142172038,
      0.0018582542496721570696,   0.0019873753544149607091,
      0.0021162361458477181718,   0.0022448197465837056669,
      0.0023731093152312689193,   0.0025010880487068518382,
      0.0026287391845029388252,   0.0027560460029267153188,
      0.0028829918293183757490,   0.0030095600362542308071,
      0.0031357340457376244988,   0.0032614973313794227113,
      0.0033868334205690881352,   0.0035117258966368993088,
      0.0036361584010075859758,   0.0037601146353454711781,
      0.0038835783636910928390,   0.0040065334145892003026,
      0.0041289636832079698618,   0.0042508531334492487274,
      0.0043721858000496134432,   0.0044929457906720127911,
      0.0046131172879877543458,   0.0047326845517485864674,
      0.0048516319208486225912,   0.0049699438153758514796,
      0.0050876047386529751402,   0.0052045992792673150530,
      0.0053209121130895269467,   0.0054365280052808644499,
      0.0055514318122887323949,   0.0056656084838302712938,
      0.0057790430648637154555,   0.0058917206975472683480,
      0.0060036266231852400716,   0.0061147461841611931948,
      0.0062250648258578446784,   0.0063345680985634731704,
      0.0064432416593645825802,   0.0065510712740245745288,
      0.0066580428188481840128,   0.0067641422825314344129,
      0.0068693557679968698143,   0.0069736694942138244901,
      0.0070770697980034913148,   0.0071795431358285528392,
      0.0072810760855671407516,   0.0073816553482708914812,
      0.0074812677499068677652,   0.0075799002430831181010,
      0.0076775399087576481341,   0.0077741739579305801950,
      0.0078697897333192793935,   0.0079643747110162269000,
      0.0080579165021294233003,   0.0081504028544051071908,
      0.0082418216538325764950,   0.0083321609262309023210,
      0.0084214088388173275511,   0.0085095537017571447470,
      0.0085965839696948503816,   0.0086824882432663748560,
      0.0087672552705921902402,   0.0088508739487511001747,
      0.0089333333252345189061,   0.0090146225993810489765,
      0.0090947311237911696725,   0.0091736484057218509407,
      0.0092513641084609101053,   0.0093278680526809313783,
      0.0094031502177725708257,   0.0094772007431570721565,
      0.0095500099295778214219,   0.0096215682403707714561,
      0.0096918663027135696609,   0.0097608949088532255221,
      0.0098286450173121570583,   0.0098951077540724582339,
      0.0099602744137382322205,   0.010024136460675838264,
      0.010086685530131902806,    0.010147913429328948425,
      0.010207812138538497087,    0.010266373812131507152,
      0.010323590779606006550,    0.010379455546591787522,
      0.010433960795832031338,    0.010487099388141734407,
      0.010538864363342810256,    0.010589248941175744883,
      0.010638246522187686088,    0.010685850688596850451,
      0.010732055205133134737,    0.010776854019854821625,
      0.010820241264941272790,    0.010862211257461505501,
      0.010902758500118552080,    0.010941877681969504715,
      0.010979563679121151309,    0.011015811555401111272,
      0.011050616563004383322,    0.011083974143115220629,
      0.011115879926504251840,    0.011146329734100769774,
      0.011175319577540112829,    0.011202845659686067405,
      0.011228904375128222913,    0.011253492310654214232,
      0.011276606245696789759,    0.011298243152755646485,
      0.011318400197793976856,    0.011337074740609675474,
      0.011354264335181157013,    0.011369966729987740064,
      0.011384179868304554933,    0.011396901888471936771,
      0.011408131124139268753,    0.011417866104483243361,
      0.011426105554400513187,    0.011432848394674706017,
      0.011438093742117782330,    0.011441840909685716687,
      0.011444089406568487860,    0.011444838938254365921,
      0.011444089406568487860,    0.011441840909685716687,
      0.011438093742117782330,    0.011432848394674706017,
      0.011426105554400513187,    0.011417866104483243361,
      0.011408131124139268753,    0.011396901888471936771,
      0.011384179868304554933,    0.011369966729987740064,
      0.011354264335181157013,    0.011337074740609675474,
      0.011318400197793976856,    0.011298243152755646485,
      0.011276606245696789759,    0.011253492310654214232,
      0.011228904375128222913,    0.011202845659686067405,
      0.011175319577540112829,    0.011146329734100769774,
      0.011115879926504251840,    0.011083974143115220629,
      0.011050616563004383322,    0.011015811555401111272,
      0.010979563679121151309,    0.010941877681969504715,
      0.010902758500118552080,    0.010862211257461505501,
      0.010820241264941272790,    0.010776854019854821625,
      0.010732055205133134737,    0.010685850688596850451,
      0.010638246522187686088,    0.010589248941175744883,
      0.010538864363342810256,    0.010487099388141734407,
      0.010433960795832031338,    0.010379455546591787522,
      0.010323590779606006550,    0.010266373812131507152,
      0.010207812138538497087,    0.010147913429328948425,
      0.010086685530131902806,    0.010024136460675838264,
      0.0099602744137382322205,   0.0098951077540724582339,
      0.0098286450173121570583,   0.0097608949088532255221,
      0.0096918663027135696609,   0.0096215682403707714561,
      0.0095500099295778214219,   0.0094772007431570721565,
      0.0094031502177725708257,   0.0093278680526809313783,
      0.0092513641084609101053,   0.0091736484057218509407,
      0.0090947311237911696725,   0.0090146225993810489765,
      0.0089333333252345189061,   0.0088508739487511001747,
      0.0087672552705921902402,   0.0086824882432663748560,
      0.0085965839696948503816,   0.0085095537017571447470,
      0.0084214088388173275511,   0.0083321609262309023210,
      0.0082418216538325764950,   0.0081504028544051071908,
      0.0080579165021294233003,   0.0079643747110162269000,
      0.0078697897333192793935,   0.0077741739579305801950,
      0.0076775399087576481341,   0.0075799002430831181010,
      0.0074812677499068677652,   0.0073816553482708914812,
      0.0072810760855671407516,   0.0071795431358285528392,
      0.0070770697980034913148,   0.0069736694942138244901,
      0.0068693557679968698143,   0.0067641422825314344129,
      0.0066580428188481840128,   0.0065510712740245745288,
      0.0064432416593645825802,   0.0063345680985634731704,
      0.0062250648258578446784,   0.0061147461841611931948,
      0.0060036266231852400716,   0.0058917206975472683480,
      0.0057790430648637154555,   0.0056656084838302712938,
      0.0055514318122887323949,   0.0054365280052808644499,
      0.0053209121130895269467,   0.0052045992792673150530,
      0.0050876047386529751402,   0.0049699438153758514796,
      0.0048516319208486225912,   0.0047326845517485864674,
      0.0046131172879877543458,   0.0044929457906720127911,
      0.0043721858000496134432,   0.0042508531334492487274,
      0.0041289636832079698618,   0.0040065334145892003026,
      0.0038835783636910928390,   0.0037601146353454711781,
      0.0036361584010075859758,   0.0035117258966368993088,
      0.0033868334205690881352,   0.0032614973313794227113,
      0.0031357340457376244988,   0.0030095600362542308071,
      0.0028829918293183757490,   0.0027560460029267153188,
      0.0026287391845029388252,   0.0025010880487068518382,
      0.0023731093152312689193,   0.0022448197465837056669,
      0.0021162361458477181718,   0.0019873753544149607091,
      0.0018582542496721570696,   0.0017288897426142172038,
      0.0015992987753292949713,   0.0014694983182493621243,
      0.0013395053669469317808,   0.0012093369379990523001,
      0.0010790100627993089309,   0.00094854177647734471799,
      0.00081794909394925689179,  0.00068724894764411407983,
      0.00055645799086615915203,  0.00042559181007000527926,
      0.00029466046874082717486,  0.00016362184071271624163,
      0.000026542800265428002654};
  IntegratorXX::GaussLobatto<double, double> quad(275);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 275; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("300 point GaussLobatto", "[1d-quad]") {
  std::array<double, 300> ref_pts = {-1,
                                     -0.99991816181503180984,
                                     -0.99972566217474400226,
                                     -0.99942313543766990488,
                                     -0.99901063828349747670,
                                     -0.99848822022815810059,
                                     -0.99785593992943099022,
                                     -0.99711386739220835018,
                                     -0.99626208445673774406,
                                     -0.99530068493755982404,
                                     -0.99422977466649157546,
                                     -0.99304947150297996608,
                                     -0.99175990533119519782,
                                     -0.99036121805072878556,
                                     -0.98885356356362160683,
                                     -0.98723710775890600334,
                                     -0.98551202849521617540,
                                     -0.98367851558174321679,
                                     -0.98173677075768044220,
                                     -0.97968700767023978311,
                                     -0.97752945185128630598,
                                     -0.97526434069261967463,
                                     -0.97289192341992118639,
                                     -0.97041246106537915244,
                                     -0.96782622643900194975,
                                     -0.96513350409862601609,
                                     -0.96233459031862482296,
                                     -0.95942979305732411962,
                                     -0.95641943192312830622,
                                     -0.95330383813936255155,
                                     -0.95008335450783515302,
                                     -0.94675833537112459916,
                                     -0.94332914657359581149,
                                     -0.93979616542115009561,
                                     -0.93615978063971340810,
                                     -0.93242039233246764022,
                                     -0.92857841193582972491,
                                     -0.92463426217418348750,
                                     -0.92058837701336927977,
                                     -0.91644120161293656060,
                                     -0.91219319227716471222,
                                     -0.90784481640485750914,
                                     -0.90339655243791678581,
                                     -0.89884888980870097888,
                                     -0.89420232888617435002,
                                     -0.88945738092085282576,
                                     -0.88461456798855252081,
                                     -0.87967442293294714158,
                                     -0.87463748930694059604,
                                     -0.86950432131286126573,
                                     -0.86427548374148452400,
                                     -0.85895155190989021329,
                                     -0.85353311159816192142,
                                     -0.84802075898493502426,
                                     -0.84241510058180058805,
                                     -0.83671675316657235042,
                                     -0.83092634371542412406,
                                     -0.82504450933390509081,
                                     -0.81907189718684057753,
                                     -0.81300916442712602730,
                                     -0.80685697812342200138,
                                     -0.80061601518675816815,
                                     -0.79428696229605435489,
                                     -0.78787051582256685799,
                                     -0.78136738175326832455,
                                     -0.77477827561316963639,
                                     -0.76810392238659234327,
                                     -0.76134505643740030793,
                                     -0.75450242142819933976,
                                     -0.74757677023851370775,
                                     -0.74056886488194853551,
                                     -0.73347947642234719312,
                                     -0.72630938488895291095,
                                     -0.71905937919058394988,
                                     -0.71173025702883177156,
                                     -0.70432282481029175893,
                                     -0.69683789755783614454,
                                     -0.68927629882093890886,
                                     -0.68163886058506251563,
                                     -0.67392642318011645406,
                                     -0.66613983518799766022,
                                     -0.65827995334922299064,
                                     -0.65034764246866402122,
                                     -0.64234377532039454328,
                                     -0.63426923255166122615,
                                     -0.62612490258598801234,
                                     -0.61791168152542490630,
                                     -0.60963047305195191231,
                                     -0.60128218832804896981,
                                     -0.59286774589644282616,
                                     -0.58438807157904187750,
                                     -0.57584409837507009772,
                                     -0.56723676635841126370,
                                     -0.55856702257417477163,
                                     -0.54983582093449442526,
                                     -0.54104412211357166096,
                                     -0.53219289344197475780,
                                     -0.52328310880020566274,
                                     -0.51431574851154614143,
                                     -0.50529179923419504457,
                                     -0.49621225385270855773,
                                     -0.48707811136875537923,
                                     -0.47789037679119884600,
                                     -0.46865006102551810147,
                                     -0.45935818076258047224,
                                     -0.45001575836677729160,
                                     -0.44062382176353547817,
                                     -0.43118340432621724632,
                                     -0.42169554476242039284,
                                     -0.41216128699969166958,
                                     -0.40258168007066581722,
                                     -0.39295777799764289760,
                                     -0.38329063967661662470,
                                     -0.37358132876076645411,
                                     -0.36383091354342625019,
                                     -0.35404046684054240766,
                                     -0.34421106587263436032,
                                     -0.33434379214627046475,
                                     -0.32443973133507229970,
                                     -0.31449997316026047420,
                                     -0.30452561127075508746,
                                     -0.29451774312284403304,
                                     -0.28447746985943238696,
                                     -0.27440589618888616571,
                                     -0.26430413026348378473,
                                     -0.25417328355748859109,
                                     -0.24401447074485588565,
                                     -0.23382880957658789051,
                                     -0.22361742075775015589,
                                     -0.21338142782416293821,
                                     -0.20312195701878111672,
                                     -0.19284013716777625016,
                                     -0.18253709955633440810,
                                     -0.17221397780418344241,
                                     -0.16187190774086339450,
                                     -0.15151202728075376193,
                                     -0.14113547629787137483,
                                     -0.13074339650045265802,
                                     -0.12033693130533407797,
                                     -0.10991722571214459652,
                                     -0.099485426177323973492,
                                     -0.089042680487980779719,
                                     -0.078590137635603999648,
                                     -0.068128947689642118696,
                                     -0.057660261670963605176,
                                     -0.047185231425212709663,
                                     -0.036705009496074516142,
                                     -0.026220748998463189334,
                                     -0.015733603491647370973,
                                     -0.0052447268523266847784,
                                     0.0052447268523266847784,
                                     0.015733603491647370973,
                                     0.026220748998463189334,
                                     0.036705009496074516142,
                                     0.047185231425212709663,
                                     0.057660261670963605176,
                                     0.068128947689642118696,
                                     0.078590137635603999648,
                                     0.089042680487980779719,
                                     0.099485426177323973492,
                                     0.10991722571214459652,
                                     0.12033693130533407797,
                                     0.13074339650045265802,
                                     0.14113547629787137483,
                                     0.15151202728075376193,
                                     0.16187190774086339450,
                                     0.17221397780418344241,
                                     0.18253709955633440810,
                                     0.19284013716777625016,
                                     0.20312195701878111672,
                                     0.21338142782416293821,
                                     0.22361742075775015589,
                                     0.23382880957658789051,
                                     0.24401447074485588565,
                                     0.25417328355748859109,
                                     0.26430413026348378473,
                                     0.27440589618888616571,
                                     0.28447746985943238696,
                                     0.29451774312284403304,
                                     0.30452561127075508746,
                                     0.31449997316026047420,
                                     0.32443973133507229970,
                                     0.33434379214627046475,
                                     0.34421106587263436032,
                                     0.35404046684054240766,
                                     0.36383091354342625019,
                                     0.37358132876076645411,
                                     0.38329063967661662470,
                                     0.39295777799764289760,
                                     0.40258168007066581722,
                                     0.41216128699969166958,
                                     0.42169554476242039284,
                                     0.43118340432621724632,
                                     0.44062382176353547817,
                                     0.45001575836677729160,
                                     0.45935818076258047224,
                                     0.46865006102551810147,
                                     0.47789037679119884600,
                                     0.48707811136875537923,
                                     0.49621225385270855773,
                                     0.50529179923419504457,
                                     0.51431574851154614143,
                                     0.52328310880020566274,
                                     0.53219289344197475780,
                                     0.54104412211357166096,
                                     0.54983582093449442526,
                                     0.55856702257417477163,
                                     0.56723676635841126370,
                                     0.57584409837507009772,
                                     0.58438807157904187750,
                                     0.59286774589644282616,
                                     0.60128218832804896981,
                                     0.60963047305195191231,
                                     0.61791168152542490630,
                                     0.62612490258598801234,
                                     0.63426923255166122615,
                                     0.64234377532039454328,
                                     0.65034764246866402122,
                                     0.65827995334922299064,
                                     0.66613983518799766022,
                                     0.67392642318011645406,
                                     0.68163886058506251563,
                                     0.68927629882093890886,
                                     0.69683789755783614454,
                                     0.70432282481029175893,
                                     0.71173025702883177156,
                                     0.71905937919058394988,
                                     0.72630938488895291095,
                                     0.73347947642234719312,
                                     0.74056886488194853551,
                                     0.74757677023851370775,
                                     0.75450242142819933976,
                                     0.76134505643740030793,
                                     0.76810392238659234327,
                                     0.77477827561316963639,
                                     0.78136738175326832455,
                                     0.78787051582256685799,
                                     0.79428696229605435489,
                                     0.80061601518675816815,
                                     0.80685697812342200138,
                                     0.81300916442712602730,
                                     0.81907189718684057753,
                                     0.82504450933390509081,
                                     0.83092634371542412406,
                                     0.83671675316657235042,
                                     0.84241510058180058805,
                                     0.84802075898493502426,
                                     0.85353311159816192142,
                                     0.85895155190989021329,
                                     0.86427548374148452400,
                                     0.86950432131286126573,
                                     0.87463748930694059604,
                                     0.87967442293294714158,
                                     0.88461456798855252081,
                                     0.88945738092085282576,
                                     0.89420232888617435002,
                                     0.89884888980870097888,
                                     0.90339655243791678581,
                                     0.90784481640485750914,
                                     0.91219319227716471222,
                                     0.91644120161293656060,
                                     0.92058837701336927977,
                                     0.92463426217418348750,
                                     0.92857841193582972491,
                                     0.93242039233246764022,
                                     0.93615978063971340810,
                                     0.93979616542115009561,
                                     0.94332914657359581149,
                                     0.94675833537112459916,
                                     0.95008335450783515302,
                                     0.95330383813936255155,
                                     0.95641943192312830622,
                                     0.95942979305732411962,
                                     0.96233459031862482296,
                                     0.96513350409862601609,
                                     0.96782622643900194975,
                                     0.97041246106537915244,
                                     0.97289192341992118639,
                                     0.97526434069261967463,
                                     0.97752945185128630598,
                                     0.97968700767023978311,
                                     0.98173677075768044220,
                                     0.98367851558174321679,
                                     0.98551202849521617540,
                                     0.98723710775890600334,
                                     0.98885356356362160683,
                                     0.99036121805072878556,
                                     0.99175990533119519782,
                                     0.99304947150297996608,
                                     0.99422977466649157546,
                                     0.99530068493755982404,
                                     0.99626208445673774406,
                                     0.99711386739220835018,
                                     0.99785593992943099022,
                                     0.99848822022815810059,
                                     0.99901063828349747670,
                                     0.99942313543766990488,
                                     0.99972566217474400226,
                                     0.99991816181503180984,
                                     1};
  std::array<double, 300> ref_wgt = {
      0.000022296544035674470457, 0.00013744670847815020706,
      0.00024752567471858605265,  0.00035751970420307424635,
      0.00046746648723014873411,  0.00057735987185576756884,
      0.00068718906436248873626,  0.00079694237194154113401,
      0.00090660786384457748440,  0.0010161735360102775210,
      0.0011256273628227765774,   0.0012349573166780445947,
      0.0013441513767408545841,   0.0014531975335929918806,
      0.0015620837921588750184,   0.0016707981738488923214,
      0.0017793287183228222449,   0.0018876634850577093760,
      0.0019957905548096941817,   0.0021036980310154278787,
      0.0022113740411573368490,   0.0023188067381061109418,
      0.0024259843014480142026,   0.0025328949388014432747,
      0.0026395268871253595410,   0.0027458684140211717647,
      0.0028519078190290182283,   0.0029576334349190130439,
      0.0030630336289777810320,   0.0031680968042904524699,
      0.0032728114010181897483,   0.0033771658976712526181,
      0.0034811488123775650511,   0.0035847487041467172267,
      0.0036879541741293159793,   0.0037907538668715831379,
      0.0038931364715650915354,   0.0039950907232915217474,
      0.0040966054042623179410,   0.0041976693450531179717,
      0.0042982714258328306528,   0.0043984005775872316455,
      0.0044980457833369484772,   0.0045971960793497046571,
      0.0046958405563466926094,   0.0047939683607029451236,
      0.0048915686956415751645,   0.0049886308224217541656,
      0.0050851440615202993085,   0.0051810977938067407532,
      0.0052764814617117403109,   0.0053712845703887336368,
      0.0054654966888686686424,   0.0055591074512077134949,
      0.0056521065576278082682,   0.0057444837756499350351,
      0.0058362289412199819455,   0.0059273319598270776046,
      0.0060177828076142728675,   0.0061075715324814479771,
      0.0061966882551803238068,   0.0062851231704014568227,
      0.0063728665478530982433,   0.0064599087333317987603,
      0.0065462401497846410819,   0.0066318512983629834696,
      0.0067167327594675983717,   0.0068008751937850911913,
      0.0068842693433154851866,   0.0069669060323908594651,
      0.0070487761686849280152,   0.0071298707442134487141,
      0.0072101808363253522542,   0.0072896976086844819513,
      0.0073684123122418364289,   0.0074463162861982082144,
      0.0075234009589571123414,   0.0075996578490679001157,
      0.0076750785661589542858,   0.0077496548118608629443,
      0.0078233783807194705931,   0.0078962411610987059155,
      0.0079682351360730869228,   0.0080393523843098052796,
      0.0081095850809402927574,   0.0081789254984211739224,
      0.0082473660073845103320,   0.0083148990774772426909,
      0.0083815172781897386088,   0.0084472132796733547964,
      0.0085119798535469237470,   0.0085758098736920761713,
      0.0086386963170373116761,   0.0087006322643307314213,
      0.0087616109009013477322,   0.0088216255174088869039,
      0.0088806695105820027001,   0.0089387363839448193208,
      0.0089958197485317239026,   0.0090519133235903299033,
      0.0091070109372725340263,   0.0091611065273135906502,
      0.0092141941416991290469,   0.0092662679393200399979,
      0.0093173221906151597538,   0.0093673512782016806247,
      0.0094163496974932188377,   0.0094643120573054716591,
      0.0095112330804493971408,   0.0095571076043118512264,
      0.0096019305814236183293,   0.0096456970800147728855,
      0.0096884022845573107755,   0.0097300414962949909104,
      0.0097706101337603286857,   0.0098101037332786844196,
      0.0098485179494593913114,   0.0098858485556738688830,
      0.0099220914445206692975,   0.0099572426282774053872,
      0.0099912982393395106671,   0.010024254530645783057,
      0.010056107876090665489,    0.010086854770923218048,
      0.010116491832132737729,    0.010145015798820983402,
      0.010172423532560965013,    0.010198712017742257562,
      0.010223878361902801841,    0.010247919796047155452,
      0.010270833674951159060,    0.010292617477452984381,
      0.010313268806730531880,    0.010332785390565147636,
      0.010351165081591630391,    0.010368405857534501245,
      0.010384505821430510018,    0.010399463201837353799,
      0.010413276353028584701,    0.010425943755174685394,
      0.010437464014510292481,    0.010447835863487549327,
      0.010457058160915571460,    0.010465129892086009204,
      0.010472050168884693724,    0.010477818229889354206,
      0.010482433440453395415,    0.010485895292775726410,
      0.010488203405956632745,    0.010489357526039685992,
      0.010489357526039685992,    0.010488203405956632745,
      0.010485895292775726410,    0.010482433440453395415,
      0.010477818229889354206,    0.010472050168884693724,
      0.010465129892086009204,    0.010457058160915571460,
      0.010447835863487549327,    0.010437464014510292481,
      0.010425943755174685394,    0.010413276353028584701,
      0.010399463201837353799,    0.010384505821430510018,
      0.010368405857534501245,    0.010351165081591630391,
      0.010332785390565147636,    0.010313268806730531880,
      0.010292617477452984381,    0.010270833674951159060,
      0.010247919796047155452,    0.010223878361902801841,
      0.010198712017742257562,    0.010172423532560965013,
      0.010145015798820983402,    0.010116491832132737729,
      0.010086854770923218048,    0.010056107876090665489,
      0.010024254530645783057,    0.0099912982393395106671,
      0.0099572426282774053872,   0.0099220914445206692975,
      0.0098858485556738688830,   0.0098485179494593913114,
      0.0098101037332786844196,   0.0097706101337603286857,
      0.0097300414962949909104,   0.0096884022845573107755,
      0.0096456970800147728855,   0.0096019305814236183293,
      0.0095571076043118512264,   0.0095112330804493971408,
      0.0094643120573054716591,   0.0094163496974932188377,
      0.0093673512782016806247,   0.0093173221906151597538,
      0.0092662679393200399979,   0.0092141941416991290469,
      0.0091611065273135906502,   0.0091070109372725340263,
      0.0090519133235903299033,   0.0089958197485317239026,
      0.0089387363839448193208,   0.0088806695105820027001,
      0.0088216255174088869039,   0.0087616109009013477322,
      0.0087006322643307314213,   0.0086386963170373116761,
      0.0085758098736920761713,   0.0085119798535469237470,
      0.0084472132796733547964,   0.0083815172781897386088,
      0.0083148990774772426909,   0.0082473660073845103320,
      0.0081789254984211739224,   0.0081095850809402927574,
      0.0080393523843098052796,   0.0079682351360730869228,
      0.0078962411610987059155,   0.0078233783807194705931,
      0.0077496548118608629443,   0.0076750785661589542858,
      0.0075996578490679001157,   0.0075234009589571123414,
      0.0074463162861982082144,   0.0073684123122418364289,
      0.0072896976086844819513,   0.0072101808363253522542,
      0.0071298707442134487141,   0.0070487761686849280152,
      0.0069669060323908594651,   0.0068842693433154851866,
      0.0068008751937850911913,   0.0067167327594675983717,
      0.0066318512983629834696,   0.0065462401497846410819,
      0.0064599087333317987603,   0.0063728665478530982433,
      0.0062851231704014568227,   0.0061966882551803238068,
      0.0061075715324814479771,   0.0060177828076142728675,
      0.0059273319598270776046,   0.0058362289412199819455,
      0.0057444837756499350351,   0.0056521065576278082682,
      0.0055591074512077134949,   0.0054654966888686686424,
      0.0053712845703887336368,   0.0052764814617117403109,
      0.0051810977938067407532,   0.0050851440615202993085,
      0.0049886308224217541656,   0.0048915686956415751645,
      0.0047939683607029451236,   0.0046958405563466926094,
      0.0045971960793497046571,   0.0044980457833369484772,
      0.0043984005775872316455,   0.0042982714258328306528,
      0.0041976693450531179717,   0.0040966054042623179410,
      0.0039950907232915217474,   0.0038931364715650915354,
      0.0037907538668715831379,   0.0036879541741293159793,
      0.0035847487041467172267,   0.0034811488123775650511,
      0.0033771658976712526181,   0.0032728114010181897483,
      0.0031680968042904524699,   0.0030630336289777810320,
      0.0029576334349190130439,   0.0028519078190290182283,
      0.0027458684140211717647,   0.0026395268871253595410,
      0.0025328949388014432747,   0.0024259843014480142026,
      0.0023188067381061109418,   0.0022113740411573368490,
      0.0021036980310154278787,   0.0019957905548096941817,
      0.0018876634850577093760,   0.0017793287183228222449,
      0.0016707981738488923214,   0.0015620837921588750184,
      0.0014531975335929918806,   0.0013441513767408545841,
      0.0012349573166780445947,   0.0011256273628227765774,
      0.0010161735360102775210,   0.00090660786384457748440,
      0.00079694237194154113401,  0.00068718906436248873626,
      0.00057735987185576756884,  0.00046746648723014873411,
      0.00035751970420307424635,  0.00024752567471858605265,
      0.00013744670847815020706,  0.000022296544035674470457};
  IntegratorXX::GaussLobatto<double, double> quad(300);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 300; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("350 point GaussLobatto", "[1d-quad]") {
  std::array<double, 350> ref_pts = {-1,
                                     -0.99993990248226300027,
                                     -0.99979853948548840248,
                                     -0.99957637271360879931,
                                     -0.99927343729584337550,
                                     -0.99888976074147930428,
                                     -0.99842537491545420139,
                                     -0.99788031765991455452,
                                     -0.99725463315534188533,
                                     -0.99654837202561925191,
                                     -0.99576159137308331028,
                                     -0.99489435479006355487,
                                     -0.99394673236113178415,
                                     -0.99291880066110258098,
                                     -0.99181064275078529774,
                                     -0.99062234817135630505,
                                     -0.98935401293775768066,
                                     -0.98800573953132438169,
                                     -0.98657763689174590452,
                                     -0.98506982040842073104,
                                     -0.98348241191123703257,
                                     -0.98181553966079965064,
                                     -0.98006933833811582533,
                                     -0.97824394903374777612,
                                     -0.97633951923643764832,
                                     -0.97435620282120876524,
                                     -0.97229416003694615552,
                                     -0.97015355749345871723,
                                     -0.96793456814802499867,
                                     -0.96563737129142433503,
                                     -0.96326215253345493151,
                                     -0.96080910378794039425,
                                     -0.95827842325722616085,
                                     -0.95567031541616725947,
                                     -0.95298499099560882127,
                                     -0.95022266696536077865,
                                     -0.94738356651666819899,
                                     -0.94446791904417872669,
                                     -0.94147596012740863371,
                                     -0.93840793151170900968,
                                     -0.93526408108873365564,
                                     -0.93204466287641028002,
                                     -0.92874993699841663136,
                                     -0.92538016966316323897,
                                     -0.92193563314228446987,
                                     -0.91841660574863964830,
                                     -0.91482337181382602183,
                                     -0.91115622166520539646,
                                     -0.90741545160244630131,
                                     -0.90360136387358358187,
                                     -0.89971426665059735921,
                                     -0.89575447400451333069,
                                     -0.89172230588002642607,
                                     -0.88761808806964987124,
                                     -0.88344215218739174947,
                                     -0.87919483564196118847,
                                     -0.87487648160950633899,
                                     -0.87048743900588634873,
                                     -0.86602806245847957243,
                                     -0.86149871227753029676,
                                     -0.85689975442703629565,
                                     -0.85223156049517956866,
                                     -0.84749450766430265198,
                                     -0.84268897868043292823,
                                     -0.83781536182235739782,
                                     -0.83287405087025041058,
                                     -0.82786544507385689301,
                                     -0.82278994912023364179,
                                     -0.81764797310105129043,
                                     -0.81243993247945959081,
                                     -0.80716624805651868736,
                                     -0.80182734593719909591,
                                     -0.79642365749595313475,
                                     -0.79095561934186058947,
                                     -0.78542367328335142809,
                                     -0.77982826629250841675,
                                     -0.77416985046895252026,
                                     -0.76844888300331400568,
                                     -0.76266582614029220041,
                                     -0.75682114714130688942,
                                     -0.75091531824674436960,
                                     -0.74494881663780121149,
                                     -0.73892212439792881143,
                                     -0.73283572847388184952,
                                     -0.72669012063637380044,
                                     -0.72048579744034267617,
                                     -0.71422326018483021123,
                                     -0.70790301487247773190,
                                     -0.70152557216864198235,
                                     -0.69509144736013421087,
                                     -0.68860116031358585019,
                                     -0.68205523543344415573,
                                     -0.67545420161960119578,
                                     -0.66879859222465961714,
                                     -0.66208894501083863889,
                                     -0.65532580210652375657,
                                     -0.64850970996246366708,
                                     -0.64164121930761795391,
                                     -0.63472088510465909977,
                                     -0.62774926650513242237,
                                     -0.62072692680427755600,
                                     -0.61365443339551512950,
                                     -0.60653235772460231794,
                                     -0.59936127524346097215,
                                     -0.59214176536368205683,
                                     -0.58487441140971015375,
                                     -0.57755980057171181302,
                                     -0.57019852385813156025,
                                     -0.56279117604793939324,
                                     -0.55533835564257362635,
                                     -0.54784066481758296561,
                                     -0.54029870937397172185,
                                     -0.53271309868925209281,
                                     -0.52508444566820746951,
                                     -0.51741336669337074484,
                                     -0.50970048157522162572,
                                     -0.50194641350210697285,
                                     -0.49415178898988821438,
                                     -0.48631723783131990186,
                                     -0.47844339304516349871,
                                     -0.47053089082504051255,
                                     -0.46258037048802910422,
                                     -0.45459247442300832654,
                                     -0.44656784803875416671,
                                     -0.43850713971179158605,
                                     -0.43041100073400677042,
                                     -0.42228008526002382437,
                                     -0.41411505025435016079,
                                     -0.40591655543829485660,
                                     -0.39768526323666426344,
                                     -0.38942183872423918023,
                                     -0.38112694957203791223,
                                     -0.37280126599336955836,
                                     -0.36444546068968188563,
                                     -0.35606020879620816608,
                                     -0.34764618782741736793,
                                     -0.33920407762227210832,
                                     -0.33073456028929879090,
                                     -0.32223832015147436638,
                                     -0.31371604369093416916,
                                     -0.30516841949350529748,
                                     -0.29659613819307001884,
                                     -0.28799989241576369587,
                                     -0.27938037672401174151,
                                     -0.27073828756041012511,
                                     -0.26207432319145396389,
                                     -0.25338918365111874636,
                                     -0.24468357068429874624,
                                     -0.23595818769010719698,
                                     -0.22721373966504280811,
                                     -0.21845093314602721554,
                                     -0.20967047615331796818,
                                     -0.20087307813330166346,
                                     -0.19205944990117185407,
                                     -0.18323030358349635726,
                                     -0.17438635256067860735,
                                     -0.16552831140931770035,
                                     -0.15665689584447178795,
                                     -0.14777282266182948594,
                                     -0.13887680967979396944,
                                     -0.12996957568148443452,
                                     -0.12105184035665961228,
                                     -0.11212432424356802812,
                                     -0.10318774867072970422,
                                     -0.094242835698654009609,
                                     -0.085290308061498366531,
                                     -0.076330889108672527275,
                                     -0.067365302746393139588,
                                     -0.058394273379193323015,
                                     -0.049418525851391982104,
                                     -0.040438785388527585640,
                                     -0.031455777538761143972,
                                     -0.022470228114253118972,
                                     -0.013482863132519003271,
                                     -0.0044944087577683071595,
                                     0.0044944087577683071595,
                                     0.013482863132519003271,
                                     0.022470228114253118972,
                                     0.031455777538761143972,
                                     0.040438785388527585640,
                                     0.049418525851391982104,
                                     0.058394273379193323015,
                                     0.067365302746393139588,
                                     0.076330889108672527275,
                                     0.085290308061498366531,
                                     0.094242835698654009609,
                                     0.10318774867072970422,
                                     0.11212432424356802812,
                                     0.12105184035665961228,
                                     0.12996957568148443452,
                                     0.13887680967979396944,
                                     0.14777282266182948594,
                                     0.15665689584447178795,
                                     0.16552831140931770035,
                                     0.17438635256067860735,
                                     0.18323030358349635726,
                                     0.19205944990117185407,
                                     0.20087307813330166346,
                                     0.20967047615331796818,
                                     0.21845093314602721554,
                                     0.22721373966504280811,
                                     0.23595818769010719698,
                                     0.24468357068429874624,
                                     0.25338918365111874636,
                                     0.26207432319145396389,
                                     0.27073828756041012511,
                                     0.27938037672401174151,
                                     0.28799989241576369587,
                                     0.29659613819307001884,
                                     0.30516841949350529748,
                                     0.31371604369093416916,
                                     0.32223832015147436638,
                                     0.33073456028929879090,
                                     0.33920407762227210832,
                                     0.34764618782741736793,
                                     0.35606020879620816608,
                                     0.36444546068968188563,
                                     0.37280126599336955836,
                                     0.38112694957203791223,
                                     0.38942183872423918023,
                                     0.39768526323666426344,
                                     0.40591655543829485660,
                                     0.41411505025435016079,
                                     0.42228008526002382437,
                                     0.43041100073400677042,
                                     0.43850713971179158605,
                                     0.44656784803875416671,
                                     0.45459247442300832654,
                                     0.46258037048802910422,
                                     0.47053089082504051255,
                                     0.47844339304516349871,
                                     0.48631723783131990186,
                                     0.49415178898988821438,
                                     0.50194641350210697285,
                                     0.50970048157522162572,
                                     0.51741336669337074484,
                                     0.52508444566820746951,
                                     0.53271309868925209281,
                                     0.54029870937397172185,
                                     0.54784066481758296561,
                                     0.55533835564257362635,
                                     0.56279117604793939324,
                                     0.57019852385813156025,
                                     0.57755980057171181302,
                                     0.58487441140971015375,
                                     0.59214176536368205683,
                                     0.59936127524346097215,
                                     0.60653235772460231794,
                                     0.61365443339551512950,
                                     0.62072692680427755600,
                                     0.62774926650513242237,
                                     0.63472088510465909977,
                                     0.64164121930761795391,
                                     0.64850970996246366708,
                                     0.65532580210652375657,
                                     0.66208894501083863889,
                                     0.66879859222465961714,
                                     0.67545420161960119578,
                                     0.68205523543344415573,
                                     0.68860116031358585019,
                                     0.69509144736013421087,
                                     0.70152557216864198235,
                                     0.70790301487247773190,
                                     0.71422326018483021123,
                                     0.72048579744034267617,
                                     0.72669012063637380044,
                                     0.73283572847388184952,
                                     0.73892212439792881143,
                                     0.74494881663780121149,
                                     0.75091531824674436960,
                                     0.75682114714130688942,
                                     0.76266582614029220041,
                                     0.76844888300331400568,
                                     0.77416985046895252026,
                                     0.77982826629250841675,
                                     0.78542367328335142809,
                                     0.79095561934186058947,
                                     0.79642365749595313475,
                                     0.80182734593719909591,
                                     0.80716624805651868736,
                                     0.81243993247945959081,
                                     0.81764797310105129043,
                                     0.82278994912023364179,
                                     0.82786544507385689301,
                                     0.83287405087025041058,
                                     0.83781536182235739782,
                                     0.84268897868043292823,
                                     0.84749450766430265198,
                                     0.85223156049517956866,
                                     0.85689975442703629565,
                                     0.86149871227753029676,
                                     0.86602806245847957243,
                                     0.87048743900588634873,
                                     0.87487648160950633899,
                                     0.87919483564196118847,
                                     0.88344215218739174947,
                                     0.88761808806964987124,
                                     0.89172230588002642607,
                                     0.89575447400451333069,
                                     0.89971426665059735921,
                                     0.90360136387358358187,
                                     0.90741545160244630131,
                                     0.91115622166520539646,
                                     0.91482337181382602183,
                                     0.91841660574863964830,
                                     0.92193563314228446987,
                                     0.92538016966316323897,
                                     0.92874993699841663136,
                                     0.93204466287641028002,
                                     0.93526408108873365564,
                                     0.93840793151170900968,
                                     0.94147596012740863371,
                                     0.94446791904417872669,
                                     0.94738356651666819899,
                                     0.95022266696536077865,
                                     0.95298499099560882127,
                                     0.95567031541616725947,
                                     0.95827842325722616085,
                                     0.96080910378794039425,
                                     0.96326215253345493151,
                                     0.96563737129142433503,
                                     0.96793456814802499867,
                                     0.97015355749345871723,
                                     0.97229416003694615552,
                                     0.97435620282120876524,
                                     0.97633951923643764832,
                                     0.97824394903374777612,
                                     0.98006933833811582533,
                                     0.98181553966079965064,
                                     0.98348241191123703257,
                                     0.98506982040842073104,
                                     0.98657763689174590452,
                                     0.98800573953132438169,
                                     0.98935401293775768066,
                                     0.99062234817135630505,
                                     0.99181064275078529774,
                                     0.99291880066110258098,
                                     0.99394673236113178415,
                                     0.99489435479006355487,
                                     0.99576159137308331028,
                                     0.99654837202561925191,
                                     0.99725463315534188533,
                                     0.99788031765991455452,
                                     0.99842537491545420139,
                                     0.99888976074147930428,
                                     0.99927343729584337550,
                                     0.99957637271360879931,
                                     0.99979853948548840248,
                                     0.99993990248226300027,
                                     1};
  std::array<double, 350> ref_wgt = {
      0.000016373311502251330332, 0.00010093376258783174895,
      0.00018177316784998628712,  0.00026255551344140315549,
      0.00034331083691864254586,  0.00042403697916318762089,
      0.00050472837049251042095,  0.00058537877861909974258,
      0.00066598179371236465972,  0.00074653094884166395280,
      0.00082701975753596917523,  0.00090744172770409135062,
      0.00098779036761770468255,  0.0010680591888778010419,
      0.0011482417081169049760,   0.0012283314481276183496,
      0.0013083219387130346407,   0.0013882067173944791127,
      0.0014679793300423611514,   0.0015476333314637117596,
      0.0016271622859642884211,   0.0017065597678951323578,
      0.0017858193621892216397,   0.0018649346648915331641,
      0.0019438992836845051401,   0.0020227068384101209840,
      0.0021013509615893743609,   0.0021798252989395926823,
      0.0022581235098899197284,   0.0023362392680951454259,
      0.0024141662619479977052,   0.0024918981950899631392,
      0.0025694287869206707731,   0.0026467517731058516421,
      0.0027238609060838714070,   0.0028007499555708230703,
      0.0028774127090641593818,   0.0029538429723448393360,
      0.0030300345699779594473,   0.0031059813458118378172,
      0.0031816771634755170903,   0.0032571159068746510013,
      0.0033322914806857382190,   0.0034071978108486664748,
      0.0034818288450575294540,   0.0035561785532496785788,
      0.0036302409280929715764,   0.0037040099854711795791,
      0.0037774797649675144277,   0.0038506443303462378223,
      0.0039234977700323139824,   0.0039960341975890675258,
      0.0040682477521938083493,   0.0041401325991113853903,
      0.0042116829301656312587,   0.0042828929642086598552,
      0.0043537569475879792282,   0.0044242691546113820708,
      0.0044944238880095764113,   0.0045642154793965192181,
      0.0046336382897274158065,   0.0047026867097543481102,
      0.0047713551604794950626,   0.0048396380936059085184,
      0.0049075299919858083329,   0.0049750253700663604160,
      0.0050421187743329017697,   0.0051088047837495767262,
      0.0051750780101973488031,   0.0052409330989093528057,
      0.0053063647289035520168,   0.0053713676134126655290,
      0.0054359365003113309955,   0.0055000661725404682944,
      0.0055637514485288098293,   0.0056269871826115634139,
      0.0056897682654461739203,   0.0057520896244251501051,
      0.0058139462240859232619,   0.0058753330665177045890,
      0.0059362451917653084031,   0.0059966776782299085746,
      0.0060566256430666958065,   0.0061160842425794036299,
      0.0061750486726116712418,   0.0062335141689352115653,
      0.0062914760076347531709,   0.0063489295054897249586,
      0.0064058700203526527615,   0.0064622929515242372997,
      0.0065181937401250831791,   0.0065735678694640489018,
      0.0066284108654031881263,   0.0066827182967192526918,
      0.0067364857754617281993,   0.0067897089573073732205,
      0.0068423835419112334891,   0.0068945052732541027142,
      0.0069460699399864019420,   0.0069970733757684496804,
      0.0070475114596070952946,   0.0070973801161886884747,
      0.0071466753162083578717,   0.0071953930766955722966,
      0.0072435294613359581798,   0.0072910805807893472867,
      0.0073380425930040289933,   0.0073844117035271817306,
      0.0074301841658114585151,   0.0074753562815177017952,
      0.0075199244008137631531,   0.0075638849226694037198,
      0.0076072342951472514749,   0.0076499690156897919227,
      0.0076920856314023689567,   0.0077335807393321730455,
      0.0077744509867431941997,   0.0078146930713871175039,
      0.0078543037417701393245,   0.0078932797974156826375,
      0.0079316180891229902473,   0.0079693155192215750035,
      0.0080063690418215064569,   0.0080427756630595137314,
      0.0080785324413408847274,   0.0081136364875771421116,
      0.0081480849654194768897,   0.0081818750914879207007,
      0.0082150041355962383160,   0.0082474694209725221723,
      0.0082792683244754711159,   0.0083103982768063358813,
      0.0083408567627165141812,   0.0083706413212107786331,
      0.0083997495457461211039,   0.0084281790844261974038,
      0.0084559276401913566206,   0.0084829929710042397403,
      0.0085093728900309325562,   0.0085350652658176582315,
      0.0085600680224629952388,   0.0085843791397856067602,
      0.0086079966534874679971,   0.0086309186553125782008,
      0.0086531432932011445998,   0.0086746687714392257671,
      0.0086954933508038223352,   0.0087156153487034033369,
      0.0087350331393138568167,   0.0087537451537098537285,
      0.0087717498799916145069,   0.0087890458634070680667,
      0.0088056317064693933635,   0.0088215060690699340158,
      0.0088366676685864768675,   0.0088511152799868857393,
      0.0088648477359280819990,   0.0088778639268503639495,
      0.0088901628010670574172,   0.0089017433648494902946,
      0.0089126046825072841722,   0.0089227458764639565730,
      0.0089321661273278276797,   0.0089408646739582258263,
      0.0089488408135269864048,   0.0089560939015752392179,
      0.0089626233520654796887,   0.0089684286374289197215,
      0.0089735092886081143870,   0.0089778648950948609867,
      0.0089814951049633674374,   0.0089843996248986872916,
      0.0089865782202204191007,   0.0089880307149016682024,
      0.0089887569915832694030,   0.0089887569915832694030,
      0.0089880307149016682024,   0.0089865782202204191007,
      0.0089843996248986872916,   0.0089814951049633674374,
      0.0089778648950948609867,   0.0089735092886081143870,
      0.0089684286374289197215,   0.0089626233520654796887,
      0.0089560939015752392179,   0.0089488408135269864048,
      0.0089408646739582258263,   0.0089321661273278276797,
      0.0089227458764639565730,   0.0089126046825072841722,
      0.0089017433648494902946,   0.0088901628010670574172,
      0.0088778639268503639495,   0.0088648477359280819990,
      0.0088511152799868857393,   0.0088366676685864768675,
      0.0088215060690699340158,   0.0088056317064693933635,
      0.0087890458634070680667,   0.0087717498799916145069,
      0.0087537451537098537285,   0.0087350331393138568167,
      0.0087156153487034033369,   0.0086954933508038223352,
      0.0086746687714392257671,   0.0086531432932011445998,
      0.0086309186553125782008,   0.0086079966534874679971,
      0.0085843791397856067602,   0.0085600680224629952388,
      0.0085350652658176582315,   0.0085093728900309325562,
      0.0084829929710042397403,   0.0084559276401913566206,
      0.0084281790844261974038,   0.0083997495457461211039,
      0.0083706413212107786331,   0.0083408567627165141812,
      0.0083103982768063358813,   0.0082792683244754711159,
      0.0082474694209725221723,   0.0082150041355962383160,
      0.0081818750914879207007,   0.0081480849654194768897,
      0.0081136364875771421116,   0.0080785324413408847274,
      0.0080427756630595137314,   0.0080063690418215064569,
      0.0079693155192215750035,   0.0079316180891229902473,
      0.0078932797974156826375,   0.0078543037417701393245,
      0.0078146930713871175039,   0.0077744509867431941997,
      0.0077335807393321730455,   0.0076920856314023689567,
      0.0076499690156897919227,   0.0076072342951472514749,
      0.0075638849226694037198,   0.0075199244008137631531,
      0.0074753562815177017952,   0.0074301841658114585151,
      0.0073844117035271817306,   0.0073380425930040289933,
      0.0072910805807893472867,   0.0072435294613359581798,
      0.0071953930766955722966,   0.0071466753162083578717,
      0.0070973801161886884747,   0.0070475114596070952946,
      0.0069970733757684496804,   0.0069460699399864019420,
      0.0068945052732541027142,   0.0068423835419112334891,
      0.0067897089573073732205,   0.0067364857754617281993,
      0.0066827182967192526918,   0.0066284108654031881263,
      0.0065735678694640489018,   0.0065181937401250831791,
      0.0064622929515242372997,   0.0064058700203526527615,
      0.0063489295054897249586,   0.0062914760076347531709,
      0.0062335141689352115653,   0.0061750486726116712418,
      0.0061160842425794036299,   0.0060566256430666958065,
      0.0059966776782299085746,   0.0059362451917653084031,
      0.0058753330665177045890,   0.0058139462240859232619,
      0.0057520896244251501051,   0.0056897682654461739203,
      0.0056269871826115634139,   0.0055637514485288098293,
      0.0055000661725404682944,   0.0054359365003113309955,
      0.0053713676134126655290,   0.0053063647289035520168,
      0.0052409330989093528057,   0.0051750780101973488031,
      0.0051088047837495767262,   0.0050421187743329017697,
      0.0049750253700663604160,   0.0049075299919858083329,
      0.0048396380936059085184,   0.0047713551604794950626,
      0.0047026867097543481102,   0.0046336382897274158065,
      0.0045642154793965192181,   0.0044944238880095764113,
      0.0044242691546113820708,   0.0043537569475879792282,
      0.0042828929642086598552,   0.0042116829301656312587,
      0.0041401325991113853903,   0.0040682477521938083493,
      0.0039960341975890675258,   0.0039234977700323139824,
      0.0038506443303462378223,   0.0037774797649675144277,
      0.0037040099854711795791,   0.0036302409280929715764,
      0.0035561785532496785788,   0.0034818288450575294540,
      0.0034071978108486664748,   0.0033322914806857382190,
      0.0032571159068746510013,   0.0031816771634755170903,
      0.0031059813458118378172,   0.0030300345699779594473,
      0.0029538429723448393360,   0.0028774127090641593818,
      0.0028007499555708230703,   0.0027238609060838714070,
      0.0026467517731058516421,   0.0025694287869206707731,
      0.0024918981950899631392,   0.0024141662619479977052,
      0.0023362392680951454259,   0.0022581235098899197284,
      0.0021798252989395926823,   0.0021013509615893743609,
      0.0020227068384101209840,   0.0019438992836845051401,
      0.0018649346648915331641,   0.0017858193621892216397,
      0.0017065597678951323578,   0.0016271622859642884211,
      0.0015476333314637117596,   0.0014679793300423611514,
      0.0013882067173944791127,   0.0013083219387130346407,
      0.0012283314481276183496,   0.0011482417081169049760,
      0.0010680591888778010419,   0.00098779036761770468255,
      0.00090744172770409135062,  0.00082701975753596917523,
      0.00074653094884166395280,  0.00066598179371236465972,
      0.00058537877861909974258,  0.00050472837049251042095,
      0.00042403697916318762089,  0.00034331083691864254586,
      0.00026255551344140315549,  0.00018177316784998628712,
      0.00010093376258783174895,  0.000016373311502251330332};
  IntegratorXX::GaussLobatto<double, double> quad(350);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 350; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("400 point GaussLobatto", "[1d-quad]") {
  std::array<double, 400> ref_pts = {-1,
                                     -0.99995400420397788399,
                                     -0.99984581080364012447,
                                     -0.99967577111277569395,
                                     -0.99944390879397510577,
                                     -0.99915024050638476634,
                                     -0.99879478507184962200,
                                     -0.99837756471676726763,
                                     -0.99789860534943692175,
                                     -0.99735793664159997549,
                                     -0.99675559205656173677,
                                     -0.99609160885948425197,
                                     -0.99536602812073565845,
                                     -0.99457889471615386129,
                                     -0.99373025732575541677,
                                     -0.99282016843155431604,
                                     -0.99184868431480130744,
                                     -0.99081586505279814474,
                                     -0.98972177451536762694,
                                     -0.98856648036102376636,
                                     -0.98735005403286740235,
                                     -0.98607257075422226418,
                                     -0.98473410952402069241,
                                     -0.98333475311194486845,
                                     -0.98187458805332740092,
                                     -0.98035370464381389606,
                                     -0.97877219693378937875,
                                     -0.97713016272256994817,
                                     -0.97542770355236074223,
                                     -0.97366492470198108353,
                                     -0.97184193518035754834,
                                     -0.96995884771978561429,
                                     -0.96801577876896048747,
                                     -0.96601284848577767484,
                                     -0.96395018072990384725,
                                     -0.96182790305511852741,
                                     -0.95964614670142713293,
                                     -0.95740504658694590541,
                                     -0.95510474129955926046,
                                     -0.95274537308835010013,
                                     -0.95032708785480363787,
                                     -0.94785003514378529545,
                                     -0.94531436813429324222,
                                     -0.94272024362998615852,
                                     -0.94006782204948681660,
                                     -0.93735726741646208527,
                                     -0.93458874734947997666,
                                     -0.93176243305164436650,
                                     -0.92887849930000803226,
                                     -0.92593712443476466673,
                                     -0.92293849034822053749,
                                     -0.91988278247354647624,
                                     -0.91677018977331089519,
                                     -0.91360090472779454070,
                                     -0.91037512332308770815,
                                     -0.90709304503897065476,
                                     -0.90375487283657796072,
                                     -0.90036081314584760211,
                                     -0.89691107585275551222,
                                     -0.89340587428633642123,
                                     -0.88984542520549177719,
                                     -0.88622994878558556453,
                                     -0.88255966860482884910,
                                     -0.87883481163045389227,
                                     -0.87505560820467868890,
                                     -0.87122229203046279772,
                                     -0.86733510015705534472,
                                     -0.86339427296533609375,
                                     -0.85940005415295049070,
                                     -0.85535269071923960072,
                                     -0.85125243294996587047,
                                     -0.84709953440183565998,
                                     -0.84289425188681950142,
                                     -0.83863684545627105431,
                                     -0.83432757838484573943,
                                     -0.82996671715422004586,
                                     -0.82555453143661251802,
                                     -0.82109129407810744179,
                                     -0.81657728108178226089,
                                     -0.81201277159063976717,
                                     -0.80739804787034612005,
                                     -0.80273339529177576274,
                                     -0.79801910231336431464,
                                     -0.79325546046327053120,
                                     -0.78844276432134843439,
                                     -0.78358131150093072854,
                                     -0.77867140263042462822,
                                     -0.77371334133472123604,
                                     -0.76870743421641962030,
                                     -0.76365399083686675325,
                                     -0.75855332369701448278,
                                     -0.75340574821809472109,
                                     -0.74821158272211404550,
                                     -0.74297114841216891759,
                                     -0.73768476935258273789,
                                     -0.73235277244886596459,
                                     -0.72697548742750053533,
                                     -0.72155324681554984237,
                                     -0.71608638592009552191,
                                     -0.71057524280750232931,
                                     -0.70502015828251238225,
                                     -0.69942147586717006492,
                                     -0.69377954177957889624,
                                     -0.68809470491249167587,
                                     -0.68236731681173523211,
                                     -0.67659773165447110562,
                                     -0.67078630622729351356,
                                     -0.66493339990416594840,
                                     -0.65903937462419777588,
                                     -0.65310459486926220626,
                                     -0.64712942764145702318,
                                     -0.64111424244040946370,
                                     -0.63505941124042665308,
                                     -0.62896530846749300735,
                                     -0.62283231097611602604,
                                     -0.61666079802602190698,
                                     -0.61045115125870242416,
                                     -0.60420375467381451923,
                                     -0.59791899460543406580,
                                     -0.59159725969816527516,
                                     -0.58523894088310722069,
                                     -0.57884443135367896730,
                                     -0.57241412654130480073,
                                     -0.56594842409096106035,
                                     -0.55944772383658608769,
                                     -0.55291242777635481125,
                                     -0.54634294004781949661,
                                     -0.53973966690291819918,
                                     -0.53310301668285246491,
                                     -0.52643339979283583269,
                                     -0.51973122867671469980,
                                     -0.51299691779146311992,
                                     -0.50623088358155311095,
                                     -0.49943354445320205746,
                                     -0.49260532074849880039,
                                     -0.48574663471941001400,
                                     -0.47885791050166847742,
                                     -0.47193957408854485563,
                                     -0.46499205330450461176,
                                     -0.45801577777875167975,
                                     -0.45101117891866053335,
                                     -0.44397868988309829452,
                                     -0.43691874555563853089,
                                     -0.42983178251766839871,
                                     -0.42271823902139079435,
                                     -0.41557855496272318388,
                                     -0.40841317185409478667,
                                     -0.40122253279714379507,
                                     -0.39400708245531631881,
                                     -0.38676726702636874830,
                                     -0.37950353421477523744,
                                     -0.37221633320404201222,
                                     -0.36490611462893021711,
                                     -0.35757333054758901695,
                                     -0.35021843441360067777,
                                     -0.34284188104793935498,
                                     -0.33544412661084532320,
                                     -0.32802562857361638697,
                                     -0.32058684569031821659,
                                     -0.31312823796941535868,
                                     -0.30565026664532467571,
                                     -0.29815339414989297353,
                                     -0.29063808408380058087,
                                     -0.28310480118789264904,
                                     -0.27555401131443994474,
                                     -0.26798618139833091320,
                                     -0.26040177942819679311,
                                     -0.25280127441747156887,
                                     -0.24518513637538854991,
                                     -0.23755383627791537054,
                                     -0.22990784603862920771,
                                     -0.22224763847953401773,
                                     -0.21457368730182159658,
                                     -0.20688646705657827202,
                                     -0.19918645311543903875,
                                     -0.19147412164119095162,
                                     -0.18374994955832759457,
                                     -0.17601441452355644620,
                                     -0.16826799489626096587,
                                     -0.16051116970891922685,
                                     -0.15274441863748092583,
                                     -0.14496822197170460062,
                                     -0.13718306058545689049,
                                     -0.12938941590697567557,
                                     -0.12158776988909893456,
                                     -0.11377860497946116140,
                                     -0.10596240409065918425,
                                     -0.098139650570389231499,
                                     -0.090310828171557091578,
                                     -0.082476421022363214951,
                                     -0.074636913596364608164,
                                     -0.066792790682515371326,
                                     -0.058944537355187731675,
                                     -0.051092638944175427122,
                                     -0.043237581004681294719,
                                     -0.035379849287290920014,
                                     -0.027519929707934204088,
                                     -0.019658308317836705831,
                                     -0.011795471273462617640,
                                     -0.0039319048064512332437,
                                     0.0039319048064512332437,
                                     0.011795471273462617640,
                                     0.019658308317836705831,
                                     0.027519929707934204088,
                                     0.035379849287290920014,
                                     0.043237581004681294719,
                                     0.051092638944175427122,
                                     0.058944537355187731675,
                                     0.066792790682515371326,
                                     0.074636913596364608164,
                                     0.082476421022363214951,
                                     0.090310828171557091578,
                                     0.098139650570389231499,
                                     0.10596240409065918425,
                                     0.11377860497946116140,
                                     0.12158776988909893456,
                                     0.12938941590697567557,
                                     0.13718306058545689049,
                                     0.14496822197170460062,
                                     0.15274441863748092583,
                                     0.16051116970891922685,
                                     0.16826799489626096587,
                                     0.17601441452355644620,
                                     0.18374994955832759457,
                                     0.19147412164119095162,
                                     0.19918645311543903875,
                                     0.20688646705657827202,
                                     0.21457368730182159658,
                                     0.22224763847953401773,
                                     0.22990784603862920771,
                                     0.23755383627791537054,
                                     0.24518513637538854991,
                                     0.25280127441747156887,
                                     0.26040177942819679311,
                                     0.26798618139833091320,
                                     0.27555401131443994474,
                                     0.28310480118789264904,
                                     0.29063808408380058087,
                                     0.29815339414989297353,
                                     0.30565026664532467571,
                                     0.31312823796941535868,
                                     0.32058684569031821659,
                                     0.32802562857361638697,
                                     0.33544412661084532320,
                                     0.34284188104793935498,
                                     0.35021843441360067777,
                                     0.35757333054758901695,
                                     0.36490611462893021711,
                                     0.37221633320404201222,
                                     0.37950353421477523744,
                                     0.38676726702636874830,
                                     0.39400708245531631881,
                                     0.40122253279714379507,
                                     0.40841317185409478667,
                                     0.41557855496272318388,
                                     0.42271823902139079435,
                                     0.42983178251766839871,
                                     0.43691874555563853089,
                                     0.44397868988309829452,
                                     0.45101117891866053335,
                                     0.45801577777875167975,
                                     0.46499205330450461176,
                                     0.47193957408854485563,
                                     0.47885791050166847742,
                                     0.48574663471941001400,
                                     0.49260532074849880039,
                                     0.49943354445320205746,
                                     0.50623088358155311095,
                                     0.51299691779146311992,
                                     0.51973122867671469980,
                                     0.52643339979283583269,
                                     0.53310301668285246491,
                                     0.53973966690291819918,
                                     0.54634294004781949661,
                                     0.55291242777635481125,
                                     0.55944772383658608769,
                                     0.56594842409096106035,
                                     0.57241412654130480073,
                                     0.57884443135367896730,
                                     0.58523894088310722069,
                                     0.59159725969816527516,
                                     0.59791899460543406580,
                                     0.60420375467381451923,
                                     0.61045115125870242416,
                                     0.61666079802602190698,
                                     0.62283231097611602604,
                                     0.62896530846749300735,
                                     0.63505941124042665308,
                                     0.64111424244040946370,
                                     0.64712942764145702318,
                                     0.65310459486926220626,
                                     0.65903937462419777588,
                                     0.66493339990416594840,
                                     0.67078630622729351356,
                                     0.67659773165447110562,
                                     0.68236731681173523211,
                                     0.68809470491249167587,
                                     0.69377954177957889624,
                                     0.69942147586717006492,
                                     0.70502015828251238225,
                                     0.71057524280750232931,
                                     0.71608638592009552191,
                                     0.72155324681554984237,
                                     0.72697548742750053533,
                                     0.73235277244886596459,
                                     0.73768476935258273789,
                                     0.74297114841216891759,
                                     0.74821158272211404550,
                                     0.75340574821809472109,
                                     0.75855332369701448278,
                                     0.76365399083686675325,
                                     0.76870743421641962030,
                                     0.77371334133472123604,
                                     0.77867140263042462822,
                                     0.78358131150093072854,
                                     0.78844276432134843439,
                                     0.79325546046327053120,
                                     0.79801910231336431464,
                                     0.80273339529177576274,
                                     0.80739804787034612005,
                                     0.81201277159063976717,
                                     0.81657728108178226089,
                                     0.82109129407810744179,
                                     0.82555453143661251802,
                                     0.82996671715422004586,
                                     0.83432757838484573943,
                                     0.83863684545627105431,
                                     0.84289425188681950142,
                                     0.84709953440183565998,
                                     0.85125243294996587047,
                                     0.85535269071923960072,
                                     0.85940005415295049070,
                                     0.86339427296533609375,
                                     0.86733510015705534472,
                                     0.87122229203046279772,
                                     0.87505560820467868890,
                                     0.87883481163045389227,
                                     0.88255966860482884910,
                                     0.88622994878558556453,
                                     0.88984542520549177719,
                                     0.89340587428633642123,
                                     0.89691107585275551222,
                                     0.90036081314584760211,
                                     0.90375487283657796072,
                                     0.90709304503897065476,
                                     0.91037512332308770815,
                                     0.91360090472779454070,
                                     0.91677018977331089519,
                                     0.91988278247354647624,
                                     0.92293849034822053749,
                                     0.92593712443476466673,
                                     0.92887849930000803226,
                                     0.93176243305164436650,
                                     0.93458874734947997666,
                                     0.93735726741646208527,
                                     0.94006782204948681660,
                                     0.94272024362998615852,
                                     0.94531436813429324222,
                                     0.94785003514378529545,
                                     0.95032708785480363787,
                                     0.95274537308835010013,
                                     0.95510474129955926046,
                                     0.95740504658694590541,
                                     0.95964614670142713293,
                                     0.96182790305511852741,
                                     0.96395018072990384725,
                                     0.96601284848577767484,
                                     0.96801577876896048747,
                                     0.96995884771978561429,
                                     0.97184193518035754834,
                                     0.97366492470198108353,
                                     0.97542770355236074223,
                                     0.97713016272256994817,
                                     0.97877219693378937875,
                                     0.98035370464381389606,
                                     0.98187458805332740092,
                                     0.98333475311194486845,
                                     0.98473410952402069241,
                                     0.98607257075422226418,
                                     0.98735005403286740235,
                                     0.98856648036102376636,
                                     0.98972177451536762694,
                                     0.99081586505279814474,
                                     0.99184868431480130744,
                                     0.99282016843155431604,
                                     0.99373025732575541677,
                                     0.99457889471615386129,
                                     0.99536602812073565845,
                                     0.99609160885948425197,
                                     0.99675559205656173677,
                                     0.99735793664159997549,
                                     0.99789860534943692175,
                                     0.99837756471676726763,
                                     0.99879478507184962200,
                                     0.99915024050638476634,
                                     0.99944390879397510577,
                                     0.99967577111277569395,
                                     0.99984581080364012447,
                                     0.99995400420397788399,
                                     1};
  std::array<double, 400> ref_wgt = {
      0.000012531328320802005013, 0.000077250106861907941654,
      0.00013912244578958812644,  0.00020095375171711049206,
      0.00026276818568348812775,  0.00032456526644774923194,
      0.00038634190178245729220,  0.00044809449145780242356,
      0.00050981929831688658691,  0.00057151254028999348129,
      0.00063317041897419080804,  0.00069478913012063488112,
      0.00075636486804730216469,  0.00081789382774317335369,
      0.00087937220600503367392,  0.00094079620213543442307,
      0.0010021620184280251950,   0.0010634658605439460527,
      0.0011247039378296469986,   0.0011858724636018476173,
      0.0012469676554133407949,   0.0013079857353072237442,
      0.0013689229300638932479,   0.0014297754714433583975,
      0.0014905395964244127488,   0.0015512115474416179051,
      0.0016117875726206975359,   0.0016722639260127246538,
      0.0017326368678273497317,   0.0017929026646652309943,
      0.0018530575897497722213,   0.0019130979231582364438,
      0.0019730199520522791557,   0.0020328199709079278373,
      0.0020924942817450230071,   0.0021520391943561279540,
      0.0022114510265349086179,   0.0022707261043039810442,
      0.0023298607621422209380,   0.0023888513432115277364,
      0.0024476941995830340892,   0.0025063856924627505096,
      0.0025649221924166341247,   0.0026233000795950698446,
      0.0026815157439567518087,   0.0027395655854919526288,
      0.0027974460144451677020,   0.0028551534515371216772,
      0.0029126843281861240283,   0.0029700350867287605915,
      0.0030272021806399078582,   0.0030841820747520567741,
      0.0031409712454739327698,   0.0031975661810083987395,
      0.0032539633815696276858,   0.0033101593595995317598,
      0.0033661506399834344434,   0.0034219337602649726458,
      0.0034775052708602155146,   0.0035328617352709867965,
      0.0035879997302973776185,   0.0036429158462494366010,
      0.0036976066871580242566,   0.0037520688709848186736,
      0.0038062990298314595285,   0.0038602938101478175227,
      0.0039140498729393763860,   0.0039675638939737146424,
      0.0040208325639860743872,   0.0040738525888840043770,
      0.0041266206899510647898,   0.0041791336040495810698,
      0.0042313880838224343270,   0.0042833808978938758220,
      0.0043351088310693531240,   0.0043865686845343355917,
      0.0044377572760521268861,   0.0044886714401606522878,
      0.0045393080283682086543,   0.0045896639093481649147,
      0.0046397359691326010644,   0.0046895211113048736905,
      0.0047390162571910961185,   0.0047882183460505213450,
      0.0048371243352648159823,   0.0048857312005262135139,
      0.0049340359360245352261,   0.0049820355546330672520,
      0.0050297270880932822345,   0.0050771075871983941868,
      0.0051241741219757351991,   0.0051709237818679427163,
      0.0052173536759129461807,   0.0052634609329227419118,
      0.0053092427016609451678,   0.0053546961510191084094,
      0.0053998184701917948638,   0.0054446068688503965619,
      0.0054890585773156861013,   0.0055331708467290914638,
      0.0055769409492226832974,   0.0056203661780878641507,
      0.0056634438479427492280,   0.0057061712948982283151,
      0.0057485458767226986065,   0.0057905649730054582479,
      0.0058322259853187504894,   0.0058735263373784484283,
      0.0059144634752033704072,   0.0059550348672732162127,
      0.0059952380046851143108,   0.0060350704013087704362,
      0.0060745295939402079432,   0.0061136131424540904090,
      0.0061523186299546170727,   0.0061906436629249817760,
      0.0062285858713753861650,   0.0062661429089895979999,
      0.0063033124532700455088,   0.0063400922056814388142,
      0.0063764798917929095501,   0.0064124732614186598804,
      0.0064480700887571122200,   0.0064832681725285510555,
      0.0065180653361112483526,   0.0065524594276760641317,
      0.0065864483203195138903,   0.0066200299121952946417,
      0.0066532021266442614365,   0.0066859629123228463309,
      0.0067183102433299118582,   0.0067502421193320311614,
      0.0067817565656871870375,   0.0068128516335668822460,
      0.0068435254000766535282,   0.0068737759683749818877,
      0.0069036014677905917758,   0.0069330000539381319305,
      0.0069619699088322307138,   0.0069905092409999188955,
      0.0070186162855914129303,   0.0070462893044892518786,
      0.0070735265864157812206,   0.0071003264470389769187,
      0.0071266872290766031828,   0.0071526073023986974977,
      0.0071780850641283765759,   0.0072031189387409570008,
      0.0072277073781613844317,   0.0072518488618599653450,
      0.0072755418969463953924,   0.0072987850182620785607,
      0.0073215767884707314244,   0.0073439157981472668888,
      0.0073658006658649519264,   0.0073872300382808339172,
      0.0074082025902194303103,   0.0074287170247546764305,
      0.0074487720732901263648,   0.0074683664956374019655,
      0.0074874990800928851225,   0.0075061686435126485597,
      0.0075243740313856205224,   0.0075421141179049788320,
      0.0075593878060377698924,   0.0075761940275927483426,
      0.0075925317432864331614,   0.0076083999428073761383,
      0.0076237976448786387368,   0.0076387238973184734868,
      0.0076531777770992061529,   0.0076671583904043150380,
      0.0076806648726837038923,   0.0076936963887071650092,
      0.0077062521326160292035,   0.0077183313279729994750,
      0.0077299332278101652797,   0.0077410571146751944358,
      0.0077517023006756998100,   0.0077618681275217780410,
      0.0077715539665667176673,   0.0077807592188458741445,
      0.0077894833151137093462,   0.0077977257158789932597,
      0.0078054859114381656979,   0.0078127634219068559655,
      0.0078195577972495585300,   0.0078258686173074628628,
      0.0078316954918244357282,   0.0078370380604711543154,
      0.0078418959928673887193,   0.0078462689886024323935,
      0.0078501567772536793115,   0.0078535591184033466874,
      0.0078564758016533422221,   0.0078589066466382749549,
      0.0078608515030366089178,   0.0078623102505799589000,
      0.0078632827990605277507,   0.0078637690883366847573,
      0.0078637690883366847573,   0.0078632827990605277507,
      0.0078623102505799589000,   0.0078608515030366089178,
      0.0078589066466382749549,   0.0078564758016533422221,
      0.0078535591184033466874,   0.0078501567772536793115,
      0.0078462689886024323935,   0.0078418959928673887193,
      0.0078370380604711543154,   0.0078316954918244357282,
      0.0078258686173074628628,   0.0078195577972495585300,
      0.0078127634219068559655,   0.0078054859114381656979,
      0.0077977257158789932597,   0.0077894833151137093462,
      0.0077807592188458741445,   0.0077715539665667176673,
      0.0077618681275217780410,   0.0077517023006756998100,
      0.0077410571146751944358,   0.0077299332278101652797,
      0.0077183313279729994750,   0.0077062521326160292035,
      0.0076936963887071650092,   0.0076806648726837038923,
      0.0076671583904043150380,   0.0076531777770992061529,
      0.0076387238973184734868,   0.0076237976448786387368,
      0.0076083999428073761383,   0.0075925317432864331614,
      0.0075761940275927483426,   0.0075593878060377698924,
      0.0075421141179049788320,   0.0075243740313856205224,
      0.0075061686435126485597,   0.0074874990800928851225,
      0.0074683664956374019655,   0.0074487720732901263648,
      0.0074287170247546764305,   0.0074082025902194303103,
      0.0073872300382808339172,   0.0073658006658649519264,
      0.0073439157981472668888,   0.0073215767884707314244,
      0.0072987850182620785607,   0.0072755418969463953924,
      0.0072518488618599653450,   0.0072277073781613844317,
      0.0072031189387409570008,   0.0071780850641283765759,
      0.0071526073023986974977,   0.0071266872290766031828,
      0.0071003264470389769187,   0.0070735265864157812206,
      0.0070462893044892518786,   0.0070186162855914129303,
      0.0069905092409999188955,   0.0069619699088322307138,
      0.0069330000539381319305,   0.0069036014677905917758,
      0.0068737759683749818877,   0.0068435254000766535282,
      0.0068128516335668822460,   0.0067817565656871870375,
      0.0067502421193320311614,   0.0067183102433299118582,
      0.0066859629123228463309,   0.0066532021266442614365,
      0.0066200299121952946417,   0.0065864483203195138903,
      0.0065524594276760641317,   0.0065180653361112483526,
      0.0064832681725285510555,   0.0064480700887571122200,
      0.0064124732614186598804,   0.0063764798917929095501,
      0.0063400922056814388142,   0.0063033124532700455088,
      0.0062661429089895979999,   0.0062285858713753861650,
      0.0061906436629249817760,   0.0061523186299546170727,
      0.0061136131424540904090,   0.0060745295939402079432,
      0.0060350704013087704362,   0.0059952380046851143108,
      0.0059550348672732162127,   0.0059144634752033704072,
      0.0058735263373784484283,   0.0058322259853187504894,
      0.0057905649730054582479,   0.0057485458767226986065,
      0.0057061712948982283151,   0.0056634438479427492280,
      0.0056203661780878641507,   0.0055769409492226832974,
      0.0055331708467290914638,   0.0054890585773156861013,
      0.0054446068688503965619,   0.0053998184701917948638,
      0.0053546961510191084094,   0.0053092427016609451678,
      0.0052634609329227419118,   0.0052173536759129461807,
      0.0051709237818679427163,   0.0051241741219757351991,
      0.0050771075871983941868,   0.0050297270880932822345,
      0.0049820355546330672520,   0.0049340359360245352261,
      0.0048857312005262135139,   0.0048371243352648159823,
      0.0047882183460505213450,   0.0047390162571910961185,
      0.0046895211113048736905,   0.0046397359691326010644,
      0.0045896639093481649147,   0.0045393080283682086543,
      0.0044886714401606522878,   0.0044377572760521268861,
      0.0043865686845343355917,   0.0043351088310693531240,
      0.0042833808978938758220,   0.0042313880838224343270,
      0.0041791336040495810698,   0.0041266206899510647898,
      0.0040738525888840043770,   0.0040208325639860743872,
      0.0039675638939737146424,   0.0039140498729393763860,
      0.0038602938101478175227,   0.0038062990298314595285,
      0.0037520688709848186736,   0.0036976066871580242566,
      0.0036429158462494366010,   0.0035879997302973776185,
      0.0035328617352709867965,   0.0034775052708602155146,
      0.0034219337602649726458,   0.0033661506399834344434,
      0.0033101593595995317598,   0.0032539633815696276858,
      0.0031975661810083987395,   0.0031409712454739327698,
      0.0030841820747520567741,   0.0030272021806399078582,
      0.0029700350867287605915,   0.0029126843281861240283,
      0.0028551534515371216772,   0.0027974460144451677020,
      0.0027395655854919526288,   0.0026815157439567518087,
      0.0026233000795950698446,   0.0025649221924166341247,
      0.0025063856924627505096,   0.0024476941995830340892,
      0.0023888513432115277364,   0.0023298607621422209380,
      0.0022707261043039810442,   0.0022114510265349086179,
      0.0021520391943561279540,   0.0020924942817450230071,
      0.0020328199709079278373,   0.0019730199520522791557,
      0.0019130979231582364438,   0.0018530575897497722213,
      0.0017929026646652309943,   0.0017326368678273497317,
      0.0016722639260127246538,   0.0016117875726206975359,
      0.0015512115474416179051,   0.0014905395964244127488,
      0.0014297754714433583975,   0.0013689229300638932479,
      0.0013079857353072237442,   0.0012469676554133407949,
      0.0011858724636018476173,   0.0011247039378296469986,
      0.0010634658605439460527,   0.0010021620184280251950,
      0.00094079620213543442307,  0.00087937220600503367392,
      0.00081789382774317335369,  0.00075636486804730216469,
      0.00069478913012063488112,  0.00063317041897419080804,
      0.00057151254028999348129,  0.00050981929831688658691,
      0.00044809449145780242356,  0.00038634190178245729220,
      0.00032456526644774923194,  0.00026276818568348812775,
      0.00020095375171711049206,  0.00013912244578958812644,
      0.000077250106861907941654, 0.000012531328320802005013};
  IntegratorXX::GaussLobatto<double, double> quad(400);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 400; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("450 point GaussLobatto", "[1d-quad]") {
  std::array<double, 450> ref_pts = {-1,
                                     -0.99996366770171508846,
                                     -0.99987820475819133090,
                                     -0.99974388756280593039,
                                     -0.99956073306172953301,
                                     -0.99932875203483715448,
                                     -0.99904795633633589891,
                                     -0.99871835987604282299,
                                     -0.99833997883886744005,
                                     -0.99791283174969469273,
                                     -0.99743693949614234354,
                                     -0.99691232533730529198,
                                     -0.99633901490708521867,
                                     -0.99571703621515278222,
                                     -0.99504641964675155412,
                                     -0.99432719796186866657,
                                     -0.99355940629401747286,
                                     -0.99274308214875409078,
                                     -0.99187826540199161900,
                                     -0.99096499829814695627,
                                     -0.99000332544814012349,
                                     -0.98899329382725783699,
                                     -0.98793495277288849759,
                                     -0.98682835398213310134,
                                     -0.98567355150929499094,
                                     -0.98447060176325039643,
                                     -0.98321956350470110720,
                                     -0.98192049784331023031,
                                     -0.98057346823472173980,
                                     -0.97917854047746435676,
                                     -0.97773578270974019041,
                                     -0.97624526540609849730,
                                     -0.97470706137399486634,
                                     -0.97312124575023610424,
                                     -0.97148789599731107421,
                                     -0.96980709189960772608,
                                     -0.96807891555951654764,
                                     -0.96630345139342066124,
                                     -0.96448078612757278807,
                                     -0.96261100879385930137,
                                     -0.96069421072545159160,
                                     -0.95873048555234496816,
                                     -0.95671992919678532544,
                                     -0.95466263986858380439,
                                     -0.95255871806031968455,
                                     -0.95040826654243174603,
                                     -0.94821139035819834513,
                                     -0.94596819681860645212,
                                     -0.94367879549710990442,
                                     -0.94134329822427713355,
                                     -0.93896181908232862894,
                                     -0.93653447439956440698,
                                     -0.93406138274468175876,
                                     -0.93154266492098355505,
                                     -0.92897844396047739237,
                                     -0.92636884511786586894,
                                     -0.92371399586442828484,
                                     -0.92101402588179406573,
                                     -0.91826906705560821459,
                                     -0.91547925346908910139,
                                     -0.91264472139647890568,
                                     -0.90976560929638703225,
                                     -0.90684205780502682522,
                                     -0.90387420972934591126,
                                     -0.90086221004005050745,
                                     -0.89780620586452403495,
                                     -0.89470634647964038419,
                                     -0.89156278330447218309,
                                     -0.88837566989289442420,
                                     -0.88514516192608381257,
                                     -0.88187141720491420036,
                                     -0.87855459564224848008,
                                     -0.87519485925512731283,
                                     -0.87179237215685507317,
                                     -0.86834730054898339739,
                                     -0.86485981271319272650,
                                     -0.86133007900307224093,
                                     -0.85775827183579858807,
                                     -0.85414456568371380956,
                                     -0.85048913706580287939,
                                     -0.84679216453907126938,
                                     -0.84305382868982296311,
                                     -0.83927431212483934439,
                                     -0.83545379946245939118,
                                     -0.83159247732356161070,
                                     -0.82769053432244815618,
                                     -0.82374816105763157061,
                                     -0.81976555010252460753,
                                     -0.81574289599603358356,
                                     -0.81168039523305572238,
                                     -0.80757824625488095401,
                                     -0.80343664943949863861,
                                     -0.79925580709180968797,
                                     -0.79503592343374456305,
                                     -0.79077720459428763013,
                                     -0.78647985859940836287,
                                     -0.78214409536189988227,
                                     -0.77777012667112533061,
                                     -0.77335816618267258056,
                                     -0.76890842940791778445,
                                     -0.76442113370349827386,
                                     -0.75989649826069532345,
                                     -0.75533474409472729780,
                                     -0.75073609403395370421,
                                     -0.74610077270899067890,
                                     -0.74142900654173843815,
                                     -0.73672102373432123043,
                                     -0.73197705425794032983,
                                     -0.72719732984164061518,
                                     -0.72238208396099128366,
                                     -0.71753155182668125175,
                                     -0.71264597037302980070,
                                     -0.70772557824641302761,
                                     -0.70277061579360666761,
                                     -0.69778132505004585638,
                                     -0.69275794972800240667,
                                     -0.68770073520468017620,
                                     -0.68260992851022910849,
                                     -0.67748577831567853210,
                                     -0.67232853492079030768,
                                     -0.66713845024183241624,
                                     -0.66191577779927358576,
                                     -0.65666077270539955731,
                                     -0.65137369165185159554,
                                     -0.64605479289708785225,
                                     -0.64070433625376819558,
                                     -0.63532258307606312090,
                                     -0.62990979624688736352,
                                     -0.62446624016505883659,
                                     -0.61899218073238352164,
                                     -0.61348788534066694248,
                                     -0.60795362285865285704,
                                     -0.60238966361888980505,
                                     -0.59679627940452615311,
                                     -0.59117374343603428226,
                                     -0.58552233035786456639,
                                     -0.57984231622502979358,
                                     -0.57413397848962068547,
                                     -0.56839759598725317356,
                                     -0.56263344892344809430,
                                     -0.55684181885994396829,
                                     -0.55102298870094353229,
                                     -0.54517724267929469572,
                                     -0.53930486634260659670,
                                     -0.53340614653930143593,
                                     -0.52748137140460276955,
                                     -0.52153083034646094563,
                                     -0.51555481403141637154,
                                     -0.50955361437040130299,
                                     -0.50352752450448084810,
                                     -0.49747683879053388307,
                                     -0.49140185278687457895,
                                     -0.48530286323881524178,
                                     -0.47918016806417117129,
                                     -0.47303406633870824634,
                                     -0.46686485828153394779,
                                     -0.46067284524043253254,
                                     -0.45445832967714507490,
                                     -0.44822161515259509457,
                                     -0.44196300631206049263,
                                     -0.43568280887029252005,
                                     -0.42938132959658250561,
                                     -0.42305887629977707248,
                                     -0.41671575781324257568,
                                     -0.41035228397977949470,
                                     -0.40396876563648751822,
                                     -0.39756551459958206018,
                                     -0.39114284364916294901,
                                     -0.38470106651393603379,
                                     -0.37824049785588845387,
                                     -0.37176145325491832040,
                                     -0.36526424919341956059,
                                     -0.35874920304082267771,
                                     -0.35221663303809218185,
                                     -0.34566685828218144896,
                                     -0.33910019871044576717,
                                     -0.33251697508501433201,
                                     -0.32591750897712195387,
                                     -0.31930212275140124289,
                                     -0.31267113955013603885,
                                     -0.30602488327747685494,
                                     -0.29936367858361910662,
                                     -0.29268785084894489836,
                                     -0.28599772616812914291,
                                     -0.27929363133421078944,
                                     -0.27257589382262993861,
                                     -0.26584484177523162441,
                                     -0.25910080398423704396,
                                     -0.25234410987618301846,
                                     -0.24557508949583046958,
                                     -0.23879407349004269743,
                                     -0.23200139309163424762,
                                     -0.22519738010319115631,
                                     -0.21838236688086336350,
                                     -0.21155668631813008651,
                                     -0.20472067182953894632,
                                     -0.19787465733441964135,
                                     -0.19101897724057296407,
                                     -0.18415396642793595724,
                                     -0.17727996023222400767,
                                     -0.17039729442855067653,
                                     -0.16350630521502606634,
                                     -0.15660732919633452585,
                                     -0.14970070336729249491,
                                     -0.14278676509638729256,
                                     -0.13586585210929765237,
                                     -0.12893830247239681004,
                                     -0.12200445457623894906,
                                     -0.11506464711902981108,
                                     -0.10811921909008227838,
                                     -0.10116850975325773666,
                                     -0.094212858630394026866,
                                     -0.087252605484720795695,
                                     -0.080288090304263054753,
                                     -0.073319653285233759153,
                                     -0.066347634815416216726,
                                     -0.059372375457537139585,
                                     -0.052394215932631150213,
                                     -0.045413497103397554673,
                                     -0.038430559957550195913,
                                     -0.031445745591161200472,
                                     -0.024459395191999432207,
                                     -0.017471850022864466897,
                                     -0.010483451404916901818,
                                     -0.0034945407010058145542,
                                     0.0034945407010058145542,
                                     0.010483451404916901818,
                                     0.017471850022864466897,
                                     0.024459395191999432207,
                                     0.031445745591161200472,
                                     0.038430559957550195913,
                                     0.045413497103397554673,
                                     0.052394215932631150213,
                                     0.059372375457537139585,
                                     0.066347634815416216726,
                                     0.073319653285233759153,
                                     0.080288090304263054753,
                                     0.087252605484720795695,
                                     0.094212858630394026866,
                                     0.10116850975325773666,
                                     0.10811921909008227838,
                                     0.11506464711902981108,
                                     0.12200445457623894906,
                                     0.12893830247239681004,
                                     0.13586585210929765237,
                                     0.14278676509638729256,
                                     0.14970070336729249491,
                                     0.15660732919633452585,
                                     0.16350630521502606634,
                                     0.17039729442855067653,
                                     0.17727996023222400767,
                                     0.18415396642793595724,
                                     0.19101897724057296407,
                                     0.19787465733441964135,
                                     0.20472067182953894632,
                                     0.21155668631813008651,
                                     0.21838236688086336350,
                                     0.22519738010319115631,
                                     0.23200139309163424762,
                                     0.23879407349004269743,
                                     0.24557508949583046958,
                                     0.25234410987618301846,
                                     0.25910080398423704396,
                                     0.26584484177523162441,
                                     0.27257589382262993861,
                                     0.27929363133421078944,
                                     0.28599772616812914291,
                                     0.29268785084894489836,
                                     0.29936367858361910662,
                                     0.30602488327747685494,
                                     0.31267113955013603885,
                                     0.31930212275140124289,
                                     0.32591750897712195387,
                                     0.33251697508501433201,
                                     0.33910019871044576717,
                                     0.34566685828218144896,
                                     0.35221663303809218185,
                                     0.35874920304082267771,
                                     0.36526424919341956059,
                                     0.37176145325491832040,
                                     0.37824049785588845387,
                                     0.38470106651393603379,
                                     0.39114284364916294901,
                                     0.39756551459958206018,
                                     0.40396876563648751822,
                                     0.41035228397977949470,
                                     0.41671575781324257568,
                                     0.42305887629977707248,
                                     0.42938132959658250561,
                                     0.43568280887029252005,
                                     0.44196300631206049263,
                                     0.44822161515259509457,
                                     0.45445832967714507490,
                                     0.46067284524043253254,
                                     0.46686485828153394779,
                                     0.47303406633870824634,
                                     0.47918016806417117129,
                                     0.48530286323881524178,
                                     0.49140185278687457895,
                                     0.49747683879053388307,
                                     0.50352752450448084810,
                                     0.50955361437040130299,
                                     0.51555481403141637154,
                                     0.52153083034646094563,
                                     0.52748137140460276955,
                                     0.53340614653930143593,
                                     0.53930486634260659670,
                                     0.54517724267929469572,
                                     0.55102298870094353229,
                                     0.55684181885994396829,
                                     0.56263344892344809430,
                                     0.56839759598725317356,
                                     0.57413397848962068547,
                                     0.57984231622502979358,
                                     0.58552233035786456639,
                                     0.59117374343603428226,
                                     0.59679627940452615311,
                                     0.60238966361888980505,
                                     0.60795362285865285704,
                                     0.61348788534066694248,
                                     0.61899218073238352164,
                                     0.62446624016505883659,
                                     0.62990979624688736352,
                                     0.63532258307606312090,
                                     0.64070433625376819558,
                                     0.64605479289708785225,
                                     0.65137369165185159554,
                                     0.65666077270539955731,
                                     0.66191577779927358576,
                                     0.66713845024183241624,
                                     0.67232853492079030768,
                                     0.67748577831567853210,
                                     0.68260992851022910849,
                                     0.68770073520468017620,
                                     0.69275794972800240667,
                                     0.69778132505004585638,
                                     0.70277061579360666761,
                                     0.70772557824641302761,
                                     0.71264597037302980070,
                                     0.71753155182668125175,
                                     0.72238208396099128366,
                                     0.72719732984164061518,
                                     0.73197705425794032983,
                                     0.73672102373432123043,
                                     0.74142900654173843815,
                                     0.74610077270899067890,
                                     0.75073609403395370421,
                                     0.75533474409472729780,
                                     0.75989649826069532345,
                                     0.76442113370349827386,
                                     0.76890842940791778445,
                                     0.77335816618267258056,
                                     0.77777012667112533061,
                                     0.78214409536189988227,
                                     0.78647985859940836287,
                                     0.79077720459428763013,
                                     0.79503592343374456305,
                                     0.79925580709180968797,
                                     0.80343664943949863861,
                                     0.80757824625488095401,
                                     0.81168039523305572238,
                                     0.81574289599603358356,
                                     0.81976555010252460753,
                                     0.82374816105763157061,
                                     0.82769053432244815618,
                                     0.83159247732356161070,
                                     0.83545379946245939118,
                                     0.83927431212483934439,
                                     0.84305382868982296311,
                                     0.84679216453907126938,
                                     0.85048913706580287939,
                                     0.85414456568371380956,
                                     0.85775827183579858807,
                                     0.86133007900307224093,
                                     0.86485981271319272650,
                                     0.86834730054898339739,
                                     0.87179237215685507317,
                                     0.87519485925512731283,
                                     0.87855459564224848008,
                                     0.88187141720491420036,
                                     0.88514516192608381257,
                                     0.88837566989289442420,
                                     0.89156278330447218309,
                                     0.89470634647964038419,
                                     0.89780620586452403495,
                                     0.90086221004005050745,
                                     0.90387420972934591126,
                                     0.90684205780502682522,
                                     0.90976560929638703225,
                                     0.91264472139647890568,
                                     0.91547925346908910139,
                                     0.91826906705560821459,
                                     0.92101402588179406573,
                                     0.92371399586442828484,
                                     0.92636884511786586894,
                                     0.92897844396047739237,
                                     0.93154266492098355505,
                                     0.93406138274468175876,
                                     0.93653447439956440698,
                                     0.93896181908232862894,
                                     0.94134329822427713355,
                                     0.94367879549710990442,
                                     0.94596819681860645212,
                                     0.94821139035819834513,
                                     0.95040826654243174603,
                                     0.95255871806031968455,
                                     0.95466263986858380439,
                                     0.95671992919678532544,
                                     0.95873048555234496816,
                                     0.96069421072545159160,
                                     0.96261100879385930137,
                                     0.96448078612757278807,
                                     0.96630345139342066124,
                                     0.96807891555951654764,
                                     0.96980709189960772608,
                                     0.97148789599731107421,
                                     0.97312124575023610424,
                                     0.97470706137399486634,
                                     0.97624526540609849730,
                                     0.97773578270974019041,
                                     0.97917854047746435676,
                                     0.98057346823472173980,
                                     0.98192049784331023031,
                                     0.98321956350470110720,
                                     0.98447060176325039643,
                                     0.98567355150929499094,
                                     0.98682835398213310134,
                                     0.98793495277288849759,
                                     0.98899329382725783699,
                                     0.99000332544814012349,
                                     0.99096499829814695627,
                                     0.99187826540199161900,
                                     0.99274308214875409078,
                                     0.99355940629401747286,
                                     0.99432719796186866657,
                                     0.99504641964675155412,
                                     0.99571703621515278222,
                                     0.99633901490708521867,
                                     0.99691232533730529198,
                                     0.99743693949614234354,
                                     0.99791283174969469273,
                                     0.99833997883886744005,
                                     0.99871835987604282299,
                                     0.99904795633633589891,
                                     0.99932875203483715448,
                                     0.99956073306172953301,
                                     0.99974388756280593039,
                                     0.99987820475819133090,
                                     0.99996366770171508846,
                                     1};
  std::array<double, 450> ref_wgt = {
      0.0000098985399653551101213, 0.000061020325513634740004,
      0.00010989449206656131388,   0.00015873767431100936455,
      0.00020756959148875898149,   0.00025639049759954853457,
      0.00030519858391852163837,   0.00035399164007958208925,
      0.00040276734711872759489,   0.00045152335008628430054,
      0.00050025728055195048634,   0.00054896676481872893083,
      0.00059764942733859016811,   0.00064630289230466726631,
      0.00069492478447937711032,   0.00074351272967597328713,
      0.00079206435507221990098,   0.00084057728943809659047,
      0.00088904916331732587548,   0.00093747760918303931259,
      0.00098586026157841301156,   0.0010341947572482683155,
      0.0010824787352650691678,    0.0011307098371513387793,
      0.0011788857069997193289,    0.0012270039915914324480,
      0.0012750623405136193939,    0.0013230584062758690391,
      0.0013709898444261349680,    0.0014188543136661748332,
      0.0014666494759666008804,    0.0015143729966816013469,
      0.0015620225446633728709,    0.0016095957923762907429,
      0.0016570904160108346739,    0.0017045040955972813663,
      0.0017518345151191706756,    0.0017990793626265489393,
      0.0018462363303489907451,    0.0018933031148083987324,
      0.0019402774169315797964,    0.0019871569421625951564,
      0.0020339394005748810800,    0.0020806225069831365498,
      0.0021272039810549737837,    0.0021736815474223272316,
      0.0022200529357926164584,    0.0022663158810596581576,
      0.0023124681234143224146,    0.0023585074084549282463,
      0.0024044314872973733714,    0.0024502381166849931116,
      0.0024959250590981432867,    0.0025414900828635019358,
      0.0025869309622630846779,    0.0026322454776429685140,
      0.0026774314155217188598,    0.0027224865686985146027,
      0.0027674087363609659685,    0.0028121957241926199946,
      0.0028568453444801484047,    0.0029013554162202126940,
      0.0029457237652260012372,    0.0029899482242334332479,
      0.0030340266330070244239,    0.0030779568384454091305,
      0.0031217366946865139857,    0.0031653640632123777234,
      0.0032088368129536122301,    0.0032521528203934996622,
      0.0032953099696717205699,    0.0033383061526877079690,
      0.0033811392692036223188,    0.0034238072269469423833,
      0.0034663079417126669694,    0.0035086393374651225547,
      0.0035507993464393718362,    0.0035927859092422182493,
      0.0036345969749528015278,    0.0036762305012227793924,
      0.0037176844543760904778,    0.0037589568095082936263,
      0.0038000455505854786985,    0.0038409486705427440700,
      0.0038816641713822360064,    0.0039221900642707451281,
      0.0039625243696368551991,    0.0040026651172676394951,
      0.0040426103464049000296,    0.0040823581058409449356,
      0.0041219064540138993275,    0.0041612534591025449864,
      0.0042003971991206842382,    0.0042393357620110234142,
      0.0042780672457385713098,    0.0043165897583835480787,
      0.0043549014182338000255,    0.0043930003538767157822,
      0.0044308847042906393783,    0.0044685526189357757421,
      0.0045060022578445841896,    0.0045432317917116554886,
      0.0045802394019830681059,    0.0046170232809452192746,
      0.0046535816318131265416,    0.0046899126688181954817,
      0.0047260146172954492932,    0.0047618857137702160116,
      0.0047975242060442691093,    0.0048329283532814172722,
      0.0048680964260925391736,    0.0049030267066200590909,
      0.0049377174886218592391,    0.0049721670775546247224,
      0.0050063737906566170329,    0.0050403359570298720530,
      0.0050740519177218185460,    0.0051075200258063131494,
      0.0051407386464640879112,    0.0051737061570626064401,
      0.0052064209472353247700,    0.0052388814189603530649,
      0.0052710859866385143238,    0.0053030330771707962725,
      0.0053347211300351926573,    0.0053661485973629301896,
      0.0053973139440140774159,    0.0054282156476525318215,
      0.0054588521988203815037,    0.0054892221010116377833,
      0.0055193238707453351517,    0.0055491560376379949844,
      0.0055787171444754494790,    0.0056080057472840223123,
      0.0056370204154010625365,    0.0056657597315448282712,
      0.0056942222918837167771,    0.0057224067061048375293,
      0.0057503115974819249407,    0.0057779356029425874189,
      0.0058052773731348894708,    0.0058323355724932636027,
      0.0058591088793037487973,    0.0058855959857685523789,
      0.0059117955980699321157,    0.0059377064364333954364,
      0.0059633272351902126755,    0.0059886567428392412931,
      0.0060136937221080580493,    0.0060384369500133961477,
      0.0060628852179208843942,    0.0060870373316040854556,
      0.0061108921113028303315,    0.0061344483917808461918,
      0.0061577050223826747640,    0.0061806608670898784905,
      0.0062033148045765317098,    0.0062256657282639941523,
      0.0062477125463749640728,    0.0062694541819868083823,
      0.0062908895730841671716,    0.0063120176726108300589,
      0.0063328374485208818257,    0.0063533478838291148447,
      0.0063735479766607058355,    0.0063934367403001545218,
      0.0064130132032394818011,    0.0064322764092256850701,
      0.0064512254173074483901,    0.0064698593018811052090,
      0.0064881771527358513961,    0.0065061780750982063796,
      0.0065238611896757202171,    0.0065412256326999244622,
      0.0065582705559685247299,    0.0065749951268868329007,
      0.0065913985285084369374,    0.0066074799595751063309,
      0.0066232386345559312228,    0.0066386737836856932951,
      0.0066537846530024665518,    0.0066685705043844461557,
      0.0066830306155860035216,    0.0066971642802729659048,
      0.0067109708080571187612,    0.0067244495245299291945,
      0.0067375997712954888420,    0.0067504209060026745908,
      0.0067629123023765255529,    0.0067750733502488347673,
      0.0067869034555879541336,    0.0067984020405278111221,
      0.0068095685433961358430,    0.0068204024187418970952,
      0.0068309031373619460552,    0.0068410701863268663046,
      0.0068509030690060289333,    0.0068604013050918514942,
      0.0068695644306232596250,    0.0068783919980083501912,
      0.0068868835760462548420,    0.0068950387499482029132,
      0.0069028571213577826463,    0.0069103383083703997351,
      0.0069174819455519322490,    0.0069242876839565810221,
      0.0069307551911439146358,    0.0069368841511951081621,
      0.0069426742647283748754,    0.0069481252489135901776,
      0.0069532368374861070233,    0.0069580087807597621697,
      0.0069624408456390726159,    0.0069665328156306216363,
      0.0069702844908536338509,    0.0069736956880497388178,
      0.0069767662405919226684,    0.0069794959984926673502,
      0.0069818848284112770791,    0.0069839326136603916423,
      0.0069856392542116862353,    0.0069870046667007575527,
      0.0069880287844311958962,    0.0069887115573778430990,
      0.0069890529521892361087,    0.0069890529521892361087,
      0.0069887115573778430990,    0.0069880287844311958962,
      0.0069870046667007575527,    0.0069856392542116862353,
      0.0069839326136603916423,    0.0069818848284112770791,
      0.0069794959984926673502,    0.0069767662405919226684,
      0.0069736956880497388178,    0.0069702844908536338509,
      0.0069665328156306216363,    0.0069624408456390726159,
      0.0069580087807597621697,    0.0069532368374861070233,
      0.0069481252489135901776,    0.0069426742647283748754,
      0.0069368841511951081621,    0.0069307551911439146358,
      0.0069242876839565810221,    0.0069174819455519322490,
      0.0069103383083703997351,    0.0069028571213577826463,
      0.0068950387499482029132,    0.0068868835760462548420,
      0.0068783919980083501912,    0.0068695644306232596250,
      0.0068604013050918514942,    0.0068509030690060289333,
      0.0068410701863268663046,    0.0068309031373619460552,
      0.0068204024187418970952,    0.0068095685433961358430,
      0.0067984020405278111221,    0.0067869034555879541336,
      0.0067750733502488347673,    0.0067629123023765255529,
      0.0067504209060026745908,    0.0067375997712954888420,
      0.0067244495245299291945,    0.0067109708080571187612,
      0.0066971642802729659048,    0.0066830306155860035216,
      0.0066685705043844461557,    0.0066537846530024665518,
      0.0066386737836856932951,    0.0066232386345559312228,
      0.0066074799595751063309,    0.0065913985285084369374,
      0.0065749951268868329007,    0.0065582705559685247299,
      0.0065412256326999244622,    0.0065238611896757202171,
      0.0065061780750982063796,    0.0064881771527358513961,
      0.0064698593018811052090,    0.0064512254173074483901,
      0.0064322764092256850701,    0.0064130132032394818011,
      0.0063934367403001545218,    0.0063735479766607058355,
      0.0063533478838291148447,    0.0063328374485208818257,
      0.0063120176726108300589,    0.0062908895730841671716,
      0.0062694541819868083823,    0.0062477125463749640728,
      0.0062256657282639941523,    0.0062033148045765317098,
      0.0061806608670898784905,    0.0061577050223826747640,
      0.0061344483917808461918,    0.0061108921113028303315,
      0.0060870373316040854556,    0.0060628852179208843942,
      0.0060384369500133961477,    0.0060136937221080580493,
      0.0059886567428392412931,    0.0059633272351902126755,
      0.0059377064364333954364,    0.0059117955980699321157,
      0.0058855959857685523789,    0.0058591088793037487973,
      0.0058323355724932636027,    0.0058052773731348894708,
      0.0057779356029425874189,    0.0057503115974819249407,
      0.0057224067061048375293,    0.0056942222918837167771,
      0.0056657597315448282712,    0.0056370204154010625365,
      0.0056080057472840223123,    0.0055787171444754494790,
      0.0055491560376379949844,    0.0055193238707453351517,
      0.0054892221010116377833,    0.0054588521988203815037,
      0.0054282156476525318215,    0.0053973139440140774159,
      0.0053661485973629301896,    0.0053347211300351926573,
      0.0053030330771707962725,    0.0052710859866385143238,
      0.0052388814189603530649,    0.0052064209472353247700,
      0.0051737061570626064401,    0.0051407386464640879112,
      0.0051075200258063131494,    0.0050740519177218185460,
      0.0050403359570298720530,    0.0050063737906566170329,
      0.0049721670775546247224,    0.0049377174886218592391,
      0.0049030267066200590909,    0.0048680964260925391736,
      0.0048329283532814172722,    0.0047975242060442691093,
      0.0047618857137702160116,    0.0047260146172954492932,
      0.0046899126688181954817,    0.0046535816318131265416,
      0.0046170232809452192746,    0.0045802394019830681059,
      0.0045432317917116554886,    0.0045060022578445841896,
      0.0044685526189357757421,    0.0044308847042906393783,
      0.0043930003538767157822,    0.0043549014182338000255,
      0.0043165897583835480787,    0.0042780672457385713098,
      0.0042393357620110234142,    0.0042003971991206842382,
      0.0041612534591025449864,    0.0041219064540138993275,
      0.0040823581058409449356,    0.0040426103464049000296,
      0.0040026651172676394951,    0.0039625243696368551991,
      0.0039221900642707451281,    0.0038816641713822360064,
      0.0038409486705427440700,    0.0038000455505854786985,
      0.0037589568095082936263,    0.0037176844543760904778,
      0.0036762305012227793924,    0.0036345969749528015278,
      0.0035927859092422182493,    0.0035507993464393718362,
      0.0035086393374651225547,    0.0034663079417126669694,
      0.0034238072269469423833,    0.0033811392692036223188,
      0.0033383061526877079690,    0.0032953099696717205699,
      0.0032521528203934996622,    0.0032088368129536122301,
      0.0031653640632123777234,    0.0031217366946865139857,
      0.0030779568384454091305,    0.0030340266330070244239,
      0.0029899482242334332479,    0.0029457237652260012372,
      0.0029013554162202126940,    0.0028568453444801484047,
      0.0028121957241926199946,    0.0027674087363609659685,
      0.0027224865686985146027,    0.0026774314155217188598,
      0.0026322454776429685140,    0.0025869309622630846779,
      0.0025414900828635019358,    0.0024959250590981432867,
      0.0024502381166849931116,    0.0024044314872973733714,
      0.0023585074084549282463,    0.0023124681234143224146,
      0.0022663158810596581576,    0.0022200529357926164584,
      0.0021736815474223272316,    0.0021272039810549737837,
      0.0020806225069831365498,    0.0020339394005748810800,
      0.0019871569421625951564,    0.0019402774169315797964,
      0.0018933031148083987324,    0.0018462363303489907451,
      0.0017990793626265489393,    0.0017518345151191706756,
      0.0017045040955972813663,    0.0016570904160108346739,
      0.0016095957923762907429,    0.0015620225446633728709,
      0.0015143729966816013469,    0.0014666494759666008804,
      0.0014188543136661748332,    0.0013709898444261349680,
      0.0013230584062758690391,    0.0012750623405136193939,
      0.0012270039915914324480,    0.0011788857069997193289,
      0.0011307098371513387793,    0.0010824787352650691678,
      0.0010341947572482683155,    0.00098586026157841301156,
      0.00093747760918303931259,   0.00088904916331732587548,
      0.00084057728943809659047,   0.00079206435507221990098,
      0.00074351272967597328713,   0.00069492478447937711032,
      0.00064630289230466726631,   0.00059764942733859016811,
      0.00054896676481872893083,   0.00050025728055195048634,
      0.00045152335008628430054,   0.00040276734711872759489,
      0.00035399164007958208925,   0.00030519858391852163837,
      0.00025639049759954853457,   0.00020756959148875898149,
      0.00015873767431100936455,   0.00010989449206656131388,
      0.000061020325513634740004,  0.0000098985399653551101213};
  IntegratorXX::GaussLobatto<double, double> quad(450);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 450; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}

TEST_CASE("500 point GaussLobatto", "[1d-quad]") {
  std::array<double, 500> ref_pts = {-1,
                                     -0.99997057735742503536,
                                     -0.99990136744043291536,
                                     -0.99979259343471057626,
                                     -0.99964426805314668346,
                                     -0.99945639864774086614,
                                     -0.99922899307332590383,
                                     -0.99896206048237974511,
                                     -0.99865561150295339792,
                                     -0.99830965829143358393,
                                     -0.99792421455122371476,
                                     -0.99749929554010922460,
                                     -0.99703491807327039060,
                                     -0.99653110052441032172,
                                     -0.99598786282597731468,
                                     -0.99540522646890668625,
                                     -0.99478321450208070272,
                                     -0.99412185153160526991,
                                     -0.99342116371995501039,
                                     -0.99268117878501498055,
                                     -0.99190192599903510707,
                                     -0.99108343618750681842,
                                     -0.99022574172796763313,
                                     -0.98932887654873731114,
                                     -0.98839287612758788750,
                                     -0.98741777749034911963,
                                     -0.98640361920945038592,
                                     -0.98535044140239975817,
                                     -0.98425828573020076514,
                                     -0.98312719539570722918,
                                     -0.98195721514191646686,
                                     -0.98074839125020108331,
                                     -0.97950077153847954773,
                                     -0.97821440535932570882,
                                     -0.97688934359801738880,
                                     -0.97552563867052418125,
                                     -0.97412334452143456851,
                                     -0.97268251662182246810,
                                     -0.97120321196705331395,
                                     -0.96968548907452977551,
                                     -0.96812940798137721655,
                                     -0.96653503024206899560,
                                     -0.96490241892599170941,
                                     -0.96323163861495048250,
                                     -0.96152275540061440614,
                                     -0.95977583688190223209,
                                     -0.95799095216230842764,
                                     -0.95616817184716970050,
                                     -0.95430756804087210364,
                                     -0.95240921434399883256,
                                     -0.95047318585041882908,
                                     -0.94849955914431630812,
                                     -0.94648841229716132597,
                                     -0.94443982486462151064,
                                     -0.94235387788341507726,
                                     -0.94023065386810525351,
                                     -0.93807023680783624243,
                                     -0.93587271216301085209,
                                     -0.93363816686190992394,
                                     -0.93136668929725369385,
                                     -0.92905836932270522211,
                                     -0.92671329824931603093,
                                     -0.92433156884191409019,
                                     -0.92191327531543429460,
                                     -0.91945851333119157736,
                                     -0.91696737999309680807,
                                     -0.91443997384381562460,
                                     -0.91187639486087035085,
                                     -0.90927674445268515492,
                                     -0.90664112545457460393,
                                     -0.90396964212467577443,
                                     -0.90126240013982407925,
                                     -0.89851950659137297408,
                                     -0.89574106998095770904,
                                     -0.89292720021620329300,
                                     -0.89007800860637684035,
                                     -0.88719360785798447230,
                                     -0.88427411207031294684,
                                     -0.88131963673091619385,
                                     -0.87833029871104693379,
                                     -0.87530621626103356078,
                                     -0.87224750900560247296,
                                     -0.86915429793914603517,
                                     -0.86602670542093636112,
                                     -0.86286485517028510440,
                                     -0.85966887226164944991,
                                     -0.85643888311968449908,
                                     -0.85317501551424224490,
                                     -0.84987739855531733432,
                                     -0.84654616268793981813,
                                     -0.84318143968701509029,
                                     -0.83978336265211122087,
                                     -0.83635206600219388873,
                                     -0.83288768547030912234,
                                     -0.82939035809821405892,
                                     -0.82586022223095593445,
                                     -0.82229741751139951891,
                                     -0.81870208487470321321,
                                     -0.81507436654274402646,
                                     -0.81141440601849165387,
                                     -0.80772234808033187816,
                                     -0.80399833877633951868,
                                     -0.80024252541850115508,
                                     -0.79645505657688785387,
                                     -0.79263608207377812851,
                                     -0.78878575297773136543,
                                     -0.78490422159761195048,
                                     -0.78099164147656433209,
                                     -0.77704816738593925970,
                                     -0.77307395531917143741,
                                     -0.76906916248560883532,
                                     -0.76503394730429390252,
                                     -0.76096846939769692766,
                                     -0.75687288958540179519,
                                     -0.75274736987774438690,
                                     -0.74859207346940388041,
                                     -0.74440716473294719816,
                                     -0.74019280921232686232,
                                     -0.73594917361633251274,
                                     -0.73167642581199634692,
                                     -0.72737473481795274311,
                                     -0.72304427079775232898,
                                     -0.71868520505313076034,
                                     -0.71429771001723247643,
                                     -0.70988195924778969954,
                                     -0.70543812742025694887,
                                     -0.70096639032090134038,
                                     -0.69646692483984894568,
                                     -0.69193990896408748523,
                                     -0.68738552177042563259,
                                     -0.68280394341840920823,
                                     -0.67819535514319454301,
                                     -0.67355993924837929354,
                                     -0.66889787909879099260,
                                     -0.66420935911323362027,
                                     -0.65949456475719248243,
                                     -0.65475368253549768534,
                                     -0.64998689998494649649,
                                     -0.64519440566688488355,
                                     -0.64037638915974852480,
                                     -0.63553304105156358632,
                                     -0.63066455293240756228,
                                     -0.62577111738683047683,
                                     -0.62085292798623674722,
                                     -0.61591017928122800964,
                                     -0.61094306679390721045,
                                     -0.60595178701014426756,
                                     -0.60093653737180360762,
                                     -0.59589751626893388656,
                                     -0.59083492303192020258,
                                     -0.58574895792359911181,
                                     -0.58063982213133675868,
                                     -0.57550771775907043432,
                                     -0.57035284781931387789,
                                     -0.56517541622512663692,
                                     -0.55997562778204780449,
                                     -0.55475368817999445229,
                                     -0.54950980398512507999,
                                     -0.54424418263166840278,
                                     -0.53895703241371780041,
                                     -0.53364856247699175219,
                                     -0.52831898281056058399,
                                     -0.52296850423853985444,
                                     -0.51759733841175070897,
                                     -0.51220569779934753147,
                                     -0.50679379568041322501,
                                     -0.50136184613552245373,
                                     -0.49591006403827317999,
                                     -0.49043866504678683151,
                                     -0.48494786559517743488,
                                     -0.47943788288499005281,
                                     -0.47390893487660886388,
                                     -0.46836124028063522459,
                                     -0.46279501854923605477,
                                     -0.45721048986746288867,
                                     -0.45160787514454193502,
                                     -0.44598739600513549067,
                                     -0.44034927478057505346,
                                     -0.43469373450006648111,
                                     -0.42902099888186754407,
                                     -0.42333129232443822129,
                                     -0.41762483989756408890,
                                     -0.41190186733345315317,
                                     -0.40616260101780647965,
                                     -0.40040726798086297194,
                                     -0.39463609588841865417,
                                     -0.38884931303282081258,
                                     -0.38304714832393735234,
                                     -0.37722983128010172690,
                                     -0.37139759201903379806,
                                     -0.36555066124873698586,
                                     -0.35968927025837206844,
                                     -0.35381365090910799284,
                                     -0.34792403562495005867,
                                     -0.34202065738354583743,
                                     -0.33610374970696919123,
                                     -0.33017354665248275543,
                                     -0.32423028280327925067,
                                     -0.31827419325920199037,
                                     -0.31230551362744495106,
                                     -0.30632448001323277311,
                                     -0.30033132901048106077,
                                     -0.29432629769243735085,
                                     -0.28830962360230312031,
                                     -0.28228154474383720367,
                                     -0.27624229957194099204,
                                     -0.27019212698322578613,
                                     -0.26413126630656267633,
                                     -0.25805995729361532379,
                                     -0.25197844010935601692,
                                     -0.24588695532256537850,
                                     -0.23978574389631609917,
                                     -0.23367504717844107379,
                                     -0.22755510689198631769,
                                     -0.22142616512564904051,
                                     -0.21528846432420125579,
                                     -0.20914224727889930520,
                                     -0.20298775711787967681,
                                     -0.19682523729654149720,
                                     -0.19065493158791607792,
                                     -0.18447708407302389739,
                                     -0.17829193913121939935,
                                     -0.17209974143052399019,
                                     -0.16590073591794761730,
                                     -0.15969516780979931132,
                                     -0.15348328258198707574,
                                     -0.14726532596030750738,
                                     -0.14104154391072553189,
                                     -0.13481218262964463898,
                                     -0.12857748853416800192,
                                     -0.12233770825235086687,
                                     -0.11609308861344459748,
                                     -0.10984387663813276064,
                                     -0.10359031952875963979,
                                     -0.097332664659551562059,
                                     -0.091071159566831426372,
                                     -0.084806051939226819308,
                                     -0.078537589607872106260,
                                     -0.072266020536604885378,
                                     -0.065991592812157192127,
                                     -0.059714554634341842464,
                                     -0.053435154306234302837,
                                     -0.047153640224350475388,
                                     -0.040870260868820786897,
                                     -0.034585264793560970156,
                                     -0.028298900616439926594,
                                     -0.022011417009445059077,
                                     -0.015723062688845463928,
                                     -0.0094340864053533712802,
                                     -0.0031447369342842229463,
                                     0.0031447369342842229463,
                                     0.0094340864053533712802,
                                     0.015723062688845463928,
                                     0.022011417009445059077,
                                     0.028298900616439926594,
                                     0.034585264793560970156,
                                     0.040870260868820786897,
                                     0.047153640224350475388,
                                     0.053435154306234302837,
                                     0.059714554634341842464,
                                     0.065991592812157192127,
                                     0.072266020536604885378,
                                     0.078537589607872106260,
                                     0.084806051939226819308,
                                     0.091071159566831426372,
                                     0.097332664659551562059,
                                     0.10359031952875963979,
                                     0.10984387663813276064,
                                     0.11609308861344459748,
                                     0.12233770825235086687,
                                     0.12857748853416800192,
                                     0.13481218262964463898,
                                     0.14104154391072553189,
                                     0.14726532596030750738,
                                     0.15348328258198707574,
                                     0.15969516780979931132,
                                     0.16590073591794761730,
                                     0.17209974143052399019,
                                     0.17829193913121939935,
                                     0.18447708407302389739,
                                     0.19065493158791607792,
                                     0.19682523729654149720,
                                     0.20298775711787967681,
                                     0.20914224727889930520,
                                     0.21528846432420125579,
                                     0.22142616512564904051,
                                     0.22755510689198631769,
                                     0.23367504717844107379,
                                     0.23978574389631609917,
                                     0.24588695532256537850,
                                     0.25197844010935601692,
                                     0.25805995729361532379,
                                     0.26413126630656267633,
                                     0.27019212698322578613,
                                     0.27624229957194099204,
                                     0.28228154474383720367,
                                     0.28830962360230312031,
                                     0.29432629769243735085,
                                     0.30033132901048106077,
                                     0.30632448001323277311,
                                     0.31230551362744495106,
                                     0.31827419325920199037,
                                     0.32423028280327925067,
                                     0.33017354665248275543,
                                     0.33610374970696919123,
                                     0.34202065738354583743,
                                     0.34792403562495005867,
                                     0.35381365090910799284,
                                     0.35968927025837206844,
                                     0.36555066124873698586,
                                     0.37139759201903379806,
                                     0.37722983128010172690,
                                     0.38304714832393735234,
                                     0.38884931303282081258,
                                     0.39463609588841865417,
                                     0.40040726798086297194,
                                     0.40616260101780647965,
                                     0.41190186733345315317,
                                     0.41762483989756408890,
                                     0.42333129232443822129,
                                     0.42902099888186754407,
                                     0.43469373450006648111,
                                     0.44034927478057505346,
                                     0.44598739600513549067,
                                     0.45160787514454193502,
                                     0.45721048986746288867,
                                     0.46279501854923605477,
                                     0.46836124028063522459,
                                     0.47390893487660886388,
                                     0.47943788288499005281,
                                     0.48494786559517743488,
                                     0.49043866504678683151,
                                     0.49591006403827317999,
                                     0.50136184613552245373,
                                     0.50679379568041322501,
                                     0.51220569779934753147,
                                     0.51759733841175070897,
                                     0.52296850423853985444,
                                     0.52831898281056058399,
                                     0.53364856247699175219,
                                     0.53895703241371780041,
                                     0.54424418263166840278,
                                     0.54950980398512507999,
                                     0.55475368817999445229,
                                     0.55997562778204780449,
                                     0.56517541622512663692,
                                     0.57035284781931387789,
                                     0.57550771775907043432,
                                     0.58063982213133675868,
                                     0.58574895792359911181,
                                     0.59083492303192020258,
                                     0.59589751626893388656,
                                     0.60093653737180360762,
                                     0.60595178701014426756,
                                     0.61094306679390721045,
                                     0.61591017928122800964,
                                     0.62085292798623674722,
                                     0.62577111738683047683,
                                     0.63066455293240756228,
                                     0.63553304105156358632,
                                     0.64037638915974852480,
                                     0.64519440566688488355,
                                     0.64998689998494649649,
                                     0.65475368253549768534,
                                     0.65949456475719248243,
                                     0.66420935911323362027,
                                     0.66889787909879099260,
                                     0.67355993924837929354,
                                     0.67819535514319454301,
                                     0.68280394341840920823,
                                     0.68738552177042563259,
                                     0.69193990896408748523,
                                     0.69646692483984894568,
                                     0.70096639032090134038,
                                     0.70543812742025694887,
                                     0.70988195924778969954,
                                     0.71429771001723247643,
                                     0.71868520505313076034,
                                     0.72304427079775232898,
                                     0.72737473481795274311,
                                     0.73167642581199634692,
                                     0.73594917361633251274,
                                     0.74019280921232686232,
                                     0.74440716473294719816,
                                     0.74859207346940388041,
                                     0.75274736987774438690,
                                     0.75687288958540179519,
                                     0.76096846939769692766,
                                     0.76503394730429390252,
                                     0.76906916248560883532,
                                     0.77307395531917143741,
                                     0.77704816738593925970,
                                     0.78099164147656433209,
                                     0.78490422159761195048,
                                     0.78878575297773136543,
                                     0.79263608207377812851,
                                     0.79645505657688785387,
                                     0.80024252541850115508,
                                     0.80399833877633951868,
                                     0.80772234808033187816,
                                     0.81141440601849165387,
                                     0.81507436654274402646,
                                     0.81870208487470321321,
                                     0.82229741751139951891,
                                     0.82586022223095593445,
                                     0.82939035809821405892,
                                     0.83288768547030912234,
                                     0.83635206600219388873,
                                     0.83978336265211122087,
                                     0.84318143968701509029,
                                     0.84654616268793981813,
                                     0.84987739855531733432,
                                     0.85317501551424224490,
                                     0.85643888311968449908,
                                     0.85966887226164944991,
                                     0.86286485517028510440,
                                     0.86602670542093636112,
                                     0.86915429793914603517,
                                     0.87224750900560247296,
                                     0.87530621626103356078,
                                     0.87833029871104693379,
                                     0.88131963673091619385,
                                     0.88427411207031294684,
                                     0.88719360785798447230,
                                     0.89007800860637684035,
                                     0.89292720021620329300,
                                     0.89574106998095770904,
                                     0.89851950659137297408,
                                     0.90126240013982407925,
                                     0.90396964212467577443,
                                     0.90664112545457460393,
                                     0.90927674445268515492,
                                     0.91187639486087035085,
                                     0.91443997384381562460,
                                     0.91696737999309680807,
                                     0.91945851333119157736,
                                     0.92191327531543429460,
                                     0.92433156884191409019,
                                     0.92671329824931603093,
                                     0.92905836932270522211,
                                     0.93136668929725369385,
                                     0.93363816686190992394,
                                     0.93587271216301085209,
                                     0.93807023680783624243,
                                     0.94023065386810525351,
                                     0.94235387788341507726,
                                     0.94443982486462151064,
                                     0.94648841229716132597,
                                     0.94849955914431630812,
                                     0.95047318585041882908,
                                     0.95240921434399883256,
                                     0.95430756804087210364,
                                     0.95616817184716970050,
                                     0.95799095216230842764,
                                     0.95977583688190223209,
                                     0.96152275540061440614,
                                     0.96323163861495048250,
                                     0.96490241892599170941,
                                     0.96653503024206899560,
                                     0.96812940798137721655,
                                     0.96968548907452977551,
                                     0.97120321196705331395,
                                     0.97268251662182246810,
                                     0.97412334452143456851,
                                     0.97552563867052418125,
                                     0.97688934359801738880,
                                     0.97821440535932570882,
                                     0.97950077153847954773,
                                     0.98074839125020108331,
                                     0.98195721514191646686,
                                     0.98312719539570722918,
                                     0.98425828573020076514,
                                     0.98535044140239975817,
                                     0.98640361920945038592,
                                     0.98741777749034911963,
                                     0.98839287612758788750,
                                     0.98932887654873731114,
                                     0.99022574172796763313,
                                     0.99108343618750681842,
                                     0.99190192599903510707,
                                     0.99268117878501498055,
                                     0.99342116371995501039,
                                     0.99412185153160526991,
                                     0.99478321450208070272,
                                     0.99540522646890668625,
                                     0.99598786282597731468,
                                     0.99653110052441032172,
                                     0.99703491807327039060,
                                     0.99749929554010922460,
                                     0.99792421455122371476,
                                     0.99830965829143358393,
                                     0.99865561150295339792,
                                     0.99896206048237974511,
                                     0.99922899307332590383,
                                     0.99945639864774086614,
                                     0.99964426805314668346,
                                     0.99979259343471057626,
                                     0.99990136744043291536,
                                     0.99997057735742503536,
                                     1};
  std::array<double, 500> ref_wgt = {
      0.0000080160320641282565130, 0.000049415571812385761068,
      0.000088995405079598144002,  0.00012855097341793885981,
      0.00016809861320488673876,   0.00020763889738236868740,
      0.00024717072832007276960,   0.00028669268296036617406,
      0.00032620325009798639264,   0.00036570088915039020575,
      0.00040518404835034967514,   0.00044465117136534879088,
      0.00048410070003126941204,   0.00052353107560941947904,
      0.00056294073942482409949,   0.00060232813322388532314,
      0.00064169169939611881205,   0.00068102988112630207023,
      0.00072034112250926000104,   0.00075962386864374261360,
      0.00079887656571416781206,   0.00083809766106508692534,
      0.00087728560327115403052,   0.00091643884220423915767,
      0.00095555582909867851349,   0.00099463501661527749566,
      0.0010336748589044564541,    0.0010726738116687908513,
      0.0011116303322251109542,    0.0011505428795662710067,
      0.0011894099144226619991,    0.0012282298993235184972,
      0.0012670012986580541437,    0.0013057225787364496664,
      0.0013443922078507098076,    0.0013830086563354004119,
      0.0014215703966282732624,    0.0014600759033307836520,
      0.0014985236532685038033,    0.0015369121255514338897,
      0.0015752398016342114122,    0.0016135051653762189484,
      0.0016517067031015897404,    0.0016898429036591101766,
      0.0017279122584820179114,    0.0017659132616476941308,
      0.0018038444099372482904,    0.0018417042028949935147,
      0.0018794911428878107420,    0.0019172037351643996135,
      0.0019548404879144140448,    0.0019923999123274803674,
      0.0020298805226520958904,    0.0020672808362544057028,
      0.0021045993736768555149,    0.0021418346586967183204,
      0.0021789852183844926470,    0.0022160495831621701556,
      0.0022530262868613703409,    0.0022899138667813400812,
      0.0023267108637468157840,    0.0023634158221657458721,
      0.0024000272900868713553,    0.0024365438192571622343,
      0.0024729639651791074848,    0.0025092862871678563725,
      0.0025455093484082088550,    0.0025816317160114528267,
      0.0026176519610720459699,    0.0026535686587241399805,
      0.0026893803881979449377,    0.0027250857328759315972,
      0.0027606832803488693895,    0.0027961716224716979117,
      0.0028315493554192297075,    0.0028668150797416821355,
      0.0029019674004200361326,    0.0029370049269212196857,
      0.0029719262732531138306,    0.0030067300580193790059,
      0.0030414149044740995935,    0.0030759794405762444866,
      0.0031104222990439415328,    0.0031447421174085637061,
      0.0031789375380686248687,    0.0032130072083434829940,
      0.0032469497805268487251,    0.0032807639119400971533,
      0.0033144482649853807106,    0.0033480015071985410722,
      0.0033814223113018179801,    0.0034147093552563529007,
      0.0034478613223144854415,    0.0034808769010718404580,
      0.0035137547855192037904,    0.0035464936750941845794,
      0.0035790922747326621164,    0.0036115492949200151947,
      0.0036438634517421319344,    0.0036760334669361980635,
      0.0037080580679412616473,    0.0037399359879485722642,
      0.0037716659659516926393,    0.0038032467467963807514,
      0.0038346770812302404409,    0.0038659557259521385563,
      0.0038970814436613866818,    0.0039280530031066855029,
      0.0039588691791348298731,    0.0039895287527391726547,
      0.0040200305111078454180,    0.0040503732476717340894,
      0.0040805557621522076534,    0.0041105768606085980175,
      0.0041404353554854291648,    0.0041701300656593937237,
      0.0041996598164860750978,    0.0042290234398464133076,
      0.0042582197741929127060,    0.0042872476645955897391,
      0.0043161059627876589358,    0.0043447935272109553183,
      0.0043733092230610914371,    0.0044016519223323472439,
      0.0044298205038622910269,    0.0044578138533761296435,
      0.0044856308635307862962,    0.0045132704339587041070,
      0.0045407314713113737594,    0.0045680128893025834847,
      0.0045951136087513896824,    0.0046220325576248064745,
      0.0046487686710802125059,    0.0046753208915074733119,
      0.0047016881685707775884,    0.0047278694592501857083,
      0.0047538637278828888414,    0.0047796699462041770454,
      0.0048052870933881147080,    0.0048307141560879217297,
      0.0048559501284760588515,    0.0048809940122840155415,
      0.0049058448168417988650,    0.0049305015591171217786,
      0.0049549632637542892953,    0.0049792289631127809855,
      0.0050032976973055282842,    0.0050271685142368850933,
      0.0050508404696402901753,    0.0050743126271156198488,
      0.0050975840581662295088,    0.0051206538422356825057,
      0.0051435210667441649314,    0.0051661848271245848701,
      0.0051886442268583546879,    0.0052108983775108549440,
      0.0052329463987665785221,    0.0052547874184639535903,
      0.0052764205726298440138,    0.0052978450055137258534,
      0.0053190598696215386005,    0.0053400643257492098071,
      0.0053608575430158517860,    0.0053814386988966290681,
      0.0054018069792552953157,    0.0054219615783763984060,
      0.0054419016989971524094,    0.0054616265523389752034,
      0.0054811353581386904729,    0.0055004273446793928644,
      0.0055195017488209750714,    0.0055383578160303156449,
      0.0055569948004111263341,    0.0055754119647334577762,
      0.0055936085804628623696,    0.0056115839277892131749,
      0.0056293372956551777061,    0.0056468679817843454831,
      0.0056641752927090082344,    0.0056812585437975916515,
      0.0056981170592817376078,    0.0057147501722830357737,
      0.0057311572248394035669,    0.0057473375679311133981,
      0.0057632905615064661794,    0.0057790155745071100817,
      0.0057945119848930035391,    0.0058097791796670215124,
      0.0058248165548992040388,    0.0058396235157506461084,
      0.0058541994764970279228,    0.0058685438605517846045,
      0.0058826561004889144406,    0.0058965356380654247594,
      0.0059101819242434145507,    0.0059235944192117929573,
      0.0059367725924076327784,    0.0059497159225371581395,
      0.0059624238975963654997,    0.0059748960148912771797,
      0.0059871317810578266096,    0.0059991307120813745108,
      0.0060108923333158552383,    0.0060224161795025525272,
      0.0060337017947885039010,    0.0060447487327445330122,
      0.0060555565563829092035,    0.0060661248381746335895,
      0.0060764531600663509769,    0.0060865411134968869527,
      0.0060963882994134094864,    0.0061059943282872144078,
      0.0061153588201291341357,    0.0061244814045045690464,
      0.0061333617205481408905,    0.0061419994169779676746,
      0.0061503941521095594469,    0.0061585455938693344342,
      0.0061664534198077549970,    0.0061741173171120828829,
      0.0061815369826187532736,    0.0061887121228253671358,
      0.0061956424539023014025,    0.0062023277017039365237,
      0.0062087676017795009448,    0.0062149618993835320812,
      0.0062209103494859533772,    0.0062266127167817670496,
      0.0062320687757003621327,    0.0062372783104144374571,
      0.0062422411148485392081,    0.0062469569926872127277,
      0.0062514257573827682357,    0.0062556472321626601647,
      0.0062596212500364798157,    0.0062633476538025610582,
      0.0062668262960541988137,    0.0062700570391854800761,
      0.0062730397553967272386,    0.0062757743266995535121,
      0.0062782606449215302344,    0.0062804986117104658865,
      0.0062824881385382966457,    0.0062842291467045883223,
      0.0062857215673396495413,    0.0062869653414072560457,
      0.0062879604197069860140,    0.0062887067628761662991,
      0.0062892043413914295114,    0.0062894531355698818862,
      0.0062894531355698818862,    0.0062892043413914295114,
      0.0062887067628761662991,    0.0062879604197069860140,
      0.0062869653414072560457,    0.0062857215673396495413,
      0.0062842291467045883223,    0.0062824881385382966457,
      0.0062804986117104658865,    0.0062782606449215302344,
      0.0062757743266995535121,    0.0062730397553967272386,
      0.0062700570391854800761,    0.0062668262960541988137,
      0.0062633476538025610582,    0.0062596212500364798157,
      0.0062556472321626601647,    0.0062514257573827682357,
      0.0062469569926872127277,    0.0062422411148485392081,
      0.0062372783104144374571,    0.0062320687757003621327,
      0.0062266127167817670496,    0.0062209103494859533772,
      0.0062149618993835320812,    0.0062087676017795009448,
      0.0062023277017039365237,    0.0061956424539023014025,
      0.0061887121228253671358,    0.0061815369826187532736,
      0.0061741173171120828829,    0.0061664534198077549970,
      0.0061585455938693344342,    0.0061503941521095594469,
      0.0061419994169779676746,    0.0061333617205481408905,
      0.0061244814045045690464,    0.0061153588201291341357,
      0.0061059943282872144078,    0.0060963882994134094864,
      0.0060865411134968869527,    0.0060764531600663509769,
      0.0060661248381746335895,    0.0060555565563829092035,
      0.0060447487327445330122,    0.0060337017947885039010,
      0.0060224161795025525272,    0.0060108923333158552383,
      0.0059991307120813745108,    0.0059871317810578266096,
      0.0059748960148912771797,    0.0059624238975963654997,
      0.0059497159225371581395,    0.0059367725924076327784,
      0.0059235944192117929573,    0.0059101819242434145507,
      0.0058965356380654247594,    0.0058826561004889144406,
      0.0058685438605517846045,    0.0058541994764970279228,
      0.0058396235157506461084,    0.0058248165548992040388,
      0.0058097791796670215124,    0.0057945119848930035391,
      0.0057790155745071100817,    0.0057632905615064661794,
      0.0057473375679311133981,    0.0057311572248394035669,
      0.0057147501722830357737,    0.0056981170592817376078,
      0.0056812585437975916515,    0.0056641752927090082344,
      0.0056468679817843454831,    0.0056293372956551777061,
      0.0056115839277892131749,    0.0055936085804628623696,
      0.0055754119647334577762,    0.0055569948004111263341,
      0.0055383578160303156449,    0.0055195017488209750714,
      0.0055004273446793928644,    0.0054811353581386904729,
      0.0054616265523389752034,    0.0054419016989971524094,
      0.0054219615783763984060,    0.0054018069792552953157,
      0.0053814386988966290681,    0.0053608575430158517860,
      0.0053400643257492098071,    0.0053190598696215386005,
      0.0052978450055137258534,    0.0052764205726298440138,
      0.0052547874184639535903,    0.0052329463987665785221,
      0.0052108983775108549440,    0.0051886442268583546879,
      0.0051661848271245848701,    0.0051435210667441649314,
      0.0051206538422356825057,    0.0050975840581662295088,
      0.0050743126271156198488,    0.0050508404696402901753,
      0.0050271685142368850933,    0.0050032976973055282842,
      0.0049792289631127809855,    0.0049549632637542892953,
      0.0049305015591171217786,    0.0049058448168417988650,
      0.0048809940122840155415,    0.0048559501284760588515,
      0.0048307141560879217297,    0.0048052870933881147080,
      0.0047796699462041770454,    0.0047538637278828888414,
      0.0047278694592501857083,    0.0047016881685707775884,
      0.0046753208915074733119,    0.0046487686710802125059,
      0.0046220325576248064745,    0.0045951136087513896824,
      0.0045680128893025834847,    0.0045407314713113737594,
      0.0045132704339587041070,    0.0044856308635307862962,
      0.0044578138533761296435,    0.0044298205038622910269,
      0.0044016519223323472439,    0.0043733092230610914371,
      0.0043447935272109553183,    0.0043161059627876589358,
      0.0042872476645955897391,    0.0042582197741929127060,
      0.0042290234398464133076,    0.0041996598164860750978,
      0.0041701300656593937237,    0.0041404353554854291648,
      0.0041105768606085980175,    0.0040805557621522076534,
      0.0040503732476717340894,    0.0040200305111078454180,
      0.0039895287527391726547,    0.0039588691791348298731,
      0.0039280530031066855029,    0.0038970814436613866818,
      0.0038659557259521385563,    0.0038346770812302404409,
      0.0038032467467963807514,    0.0037716659659516926393,
      0.0037399359879485722642,    0.0037080580679412616473,
      0.0036760334669361980635,    0.0036438634517421319344,
      0.0036115492949200151947,    0.0035790922747326621164,
      0.0035464936750941845794,    0.0035137547855192037904,
      0.0034808769010718404580,    0.0034478613223144854415,
      0.0034147093552563529007,    0.0033814223113018179801,
      0.0033480015071985410722,    0.0033144482649853807106,
      0.0032807639119400971533,    0.0032469497805268487251,
      0.0032130072083434829940,    0.0031789375380686248687,
      0.0031447421174085637061,    0.0031104222990439415328,
      0.0030759794405762444866,    0.0030414149044740995935,
      0.0030067300580193790059,    0.0029719262732531138306,
      0.0029370049269212196857,    0.0029019674004200361326,
      0.0028668150797416821355,    0.0028315493554192297075,
      0.0027961716224716979117,    0.0027606832803488693895,
      0.0027250857328759315972,    0.0026893803881979449377,
      0.0026535686587241399805,    0.0026176519610720459699,
      0.0025816317160114528267,    0.0025455093484082088550,
      0.0025092862871678563725,    0.0024729639651791074848,
      0.0024365438192571622343,    0.0024000272900868713553,
      0.0023634158221657458721,    0.0023267108637468157840,
      0.0022899138667813400812,    0.0022530262868613703409,
      0.0022160495831621701556,    0.0021789852183844926470,
      0.0021418346586967183204,    0.0021045993736768555149,
      0.0020672808362544057028,    0.0020298805226520958904,
      0.0019923999123274803674,    0.0019548404879144140448,
      0.0019172037351643996135,    0.0018794911428878107420,
      0.0018417042028949935147,    0.0018038444099372482904,
      0.0017659132616476941308,    0.0017279122584820179114,
      0.0016898429036591101766,    0.0016517067031015897404,
      0.0016135051653762189484,    0.0015752398016342114122,
      0.0015369121255514338897,    0.0014985236532685038033,
      0.0014600759033307836520,    0.0014215703966282732624,
      0.0013830086563354004119,    0.0013443922078507098076,
      0.0013057225787364496664,    0.0012670012986580541437,
      0.0012282298993235184972,    0.0011894099144226619991,
      0.0011505428795662710067,    0.0011116303322251109542,
      0.0010726738116687908513,    0.0010336748589044564541,
      0.00099463501661527749566,   0.00095555582909867851349,
      0.00091643884220423915767,   0.00087728560327115403052,
      0.00083809766106508692534,   0.00079887656571416781206,
      0.00075962386864374261360,   0.00072034112250926000104,
      0.00068102988112630207023,   0.00064169169939611881205,
      0.00060232813322388532314,   0.00056294073942482409949,
      0.00052353107560941947904,   0.00048410070003126941204,
      0.00044465117136534879088,   0.00040518404835034967514,
      0.00036570088915039020575,   0.00032620325009798639264,
      0.00028669268296036617406,   0.00024717072832007276960,
      0.00020763889738236868740,   0.00016809861320488673876,
      0.00012855097341793885981,   0.000088995405079598144002,
      0.000049415571812385761068,  0.0000080160320641282565130};
  IntegratorXX::GaussLobatto<double, double> quad(500);
  const auto& pts = quad.points();
  const auto& wgt = quad.weights();
  for(auto i = 0ul; i < 500; i++) {
    REQUIRE_THAT(pts[i], Catch::Matchers::WithinAbs(ref_pts[i], x_tolerance));
    REQUIRE_THAT(wgt[i], Catch::Matchers::WithinAbs(ref_wgt[i], w_tolerance));
  }
}
